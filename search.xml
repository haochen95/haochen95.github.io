<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>数据结构与算法知识点</title>
      <link href="/2019/03/03/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/2019/03/03/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<p><img src="https://www.cnblogs.com/images/cnblogs_com/haochen273/1389248/o_20180320090743532461.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> 数据结构与算法 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Android开发路线图</title>
      <link href="/2019/03/03/Android%E5%BC%80%E5%8F%91%E8%B7%AF%E7%BA%BF%E5%9B%BE/"/>
      <url>/2019/03/03/Android%E5%BC%80%E5%8F%91%E8%B7%AF%E7%BA%BF%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<p><img src="http://images.cnblogs.com/cnblogs_com/haochen273/1389248/o_47685-20161017144827185-112405259.jpg" alt></p>]]></content>
      
      
      <categories>
          
          <category> Android Development </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>加密测试</title>
      <link href="/2019/03/02/%E5%8A%A0%E5%AF%86%E6%B5%8B%E8%AF%95/"/>
      <url>/2019/03/02/%E5%8A%A0%E5%AF%86%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="密码为“你好”的拼音" />    <label for="pass">密码为“你好”的拼音</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">U2FsdGVkX19pb8qhwD0dsHk8GhWZgoYHReYoAIdJYB81Nc589eaMAHD6ndiULhTEfTz6537CHm29IH0BlvpAdK3E64nl4ZHw33P0SghkCl0kOjLebyAQB2b+LPM1+1Lu95UmSVzTIp7vxxSa4doOe/9oyUQj7ZZNSDyI83AW7sEWui7Mj4eoBsoaCrB9Wdvv6EEHxHXg2Wpm0WPYSZGMAkI6Peb1L0ms5pwfQGo8jrULYMGhY6cGn6c/5UyoMS1hpbl1dOqZ8tmlRgPfrKfsEkrBn+snKMfzKtIxHOB6+grwzduRXZxqldRQ2wJGlhFO/QQHHgiNcTNQGiBMGUImEg==</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>正则表达式语法以及re模块的使用</title>
      <link href="/2019/03/02/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%AD%E6%B3%95%E4%BB%A5%E5%8F%8Are%E6%A8%A1%E5%9D%97%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/2019/03/02/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%AD%E6%B3%95%E4%BB%A5%E5%8F%8Are%E6%A8%A1%E5%9D%97%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="1-正则表达式简介"><a href="#1-正则表达式简介" class="headerlink" title="1.正则表达式简介"></a>1.正则表达式简介</h1><p>正则表达式（或 RE）是一种小型的、高度专业化的编程语言，（在Python中）它内嵌在Python中，并通过 re 模块实现。使用这个小型语言，你可以为想要匹配的相应字符串集指定规则；该字符串集可能包含英文语句、email地址、TeX命令或任何你想搞定的东西。然后你可以问诸如“这个字符串匹配该模式吗？”或“在这个字符串中是否有部分匹配该模式呢？”。你也可以使用 RE以各种方式来修改或分割字符串。  </p><h1 id="2-正则表达式的语法简介"><a href="#2-正则表达式的语法简介" class="headerlink" title="2.正则表达式的语法简介"></a>2.正则表达式的语法简介</h1><p><img src="https://images.cnblogs.com/cnblogs_com/huxi/Windows-Live-Writer/Python_10A67/pyre_ebb9ce1c-e5e8-4219-a8ae-7ee620d5f9f1.png" alt>  </p><h1 id="3-re模块的介绍"><a href="#3-re模块的介绍" class="headerlink" title="3.re模块的介绍"></a>3.re模块的介绍</h1><h2 id="3-1-re模块的核心函数和方法"><a href="#3-1-re模块的核心函数和方法" class="headerlink" title="3.1.re模块的核心函数和方法"></a>3.1.re模块的核心函数和方法</h2><p>通过 pattern object 的方法（除 findall 外）进行匹配得到的返回结果都是 match object。每一个 match object 都包含了匹配到的相关信息，比如，起始位置、匹配到的子串。那么，我们如何从 match object 中提取这些信息呢？  </p><table><thead><tr><th>函数</th><th>描述</th></tr></thead><tbody><tr><td>re.compile(pattern,flags=0)</td><td>将一个字符串通过指定的匹配模式flag编译成 pattern object，用于匹配或搜索</td></tr><tr><td>pattern.match(string[, pos[, endpos]])</td><td>匹配从 pos 到 endpos 的字符子串的开头。匹配成功返回一个 match object，不匹配返回 None</td></tr><tr><td>pattern.search(string[, pos[, endpos]])</td><td>扫描整个字符串，并返回它找到的第一个匹配（Match object）</td></tr><tr><td>pattern.findall(string[, pos[, endpos]])</td><td>找到所有匹配的子串，并返回一个 list</td></tr><tr><td>pattern.finditer(string[, pos[, endpos]])</td><td>找到所有匹配的子串，并返回由这些匹配结果（match object）组成的迭代器</td></tr><tr><td>pattern.split(rules,string,max=0)</td><td>根据正则表达式的rules，将字符串string分割成列表并返回</td></tr><tr><td>pattern.sub(rules,repl,string,count=0)</td><td>根据正则表达式rules匹配的结果将它替换为repl的形式，除非定义count，否则替换所有</td></tr><tr><td>pattern.purge()</td><td>清除所有的正则表达式</td></tr><tr><td>match.group([group1, …])</td><td>返回 match object 中的字符串。 每一个 ( ) 都是一个分组，分组编号从1开始</td></tr><tr><td>match.groups(default=none)</td><td>返回由所有分组匹配到的字符串组成的 tuple。</td></tr><tr><td>match.groupdict(default=None)</td><td>返回一个包含所有匹配的命名子组的字典，子组名称为键</td></tr><tr><td>match.start([group])</td><td>没有参数时，返回匹配到的字符串的起始位置,<br>指定参数（整数）时，返回该分组匹配到的字符串的起始位置。。</td></tr><tr><td>match.end([group])</td><td>没有参数时，返回匹配到的字符串的结束位置。<br>    指定参数（整数）时，返回该分组匹配到的字符串的结束位置。</td></tr><tr><td>match.span</td><td>返回一个二元 tuple 表示匹配到的字符串的范围，即 (start, end)。</td></tr><tr><td>re.I</td><td>不区分大小写的匹配</td></tr><tr><td>re.L</td><td>使用预定字符类\w\W\b\B\s\Sq取决于当前区域设定</td></tr><tr><td>re.M</td><td>多行模式</td></tr><tr><td>re.S</td><td>使得句号匹配除换行符外的所有单个字符</td></tr><tr><td><code>\</code></td><td>转义符号</td></tr></tbody></table><h1 id="4-Python中的范例"><a href="#4-Python中的范例" class="headerlink" title="4. Python中的范例"></a>4. Python中的范例</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># regex.match(string[, pos[, endpos]])</span></span><br><span class="line"><span class="comment"># 匹配从 pos 到 endpos 的字符子串的开头。匹配成功返回一个 match object，不匹配返回 None。</span></span><br><span class="line">print(<span class="string">"\n-------match的用法--------\n"</span>)</span><br><span class="line"></span><br><span class="line">p1 = re.compile(<span class="string">r'ar&#123;1&#125;'</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"当不指定位置时,match只从开头匹配:匹配成功  "</span>,p1.match(<span class="string">"army"</span>))</span><br><span class="line">print(<span class="string">"当不指定位置时,match只从开头匹配:匹配失败  "</span>,p1.match(<span class="string">"akarmy"</span>))</span><br><span class="line">print(<span class="string">"match从指定位置的开头匹配:匹配成功  "</span>,p1.match(<span class="string">"akarmy"</span>,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># regex.search(string[, pos[, endpos]])</span></span><br><span class="line"><span class="comment"># 扫描整个字符串，并返回它找到的第一个匹配（Match object）。</span></span><br><span class="line">print(<span class="string">"\n-------search的用法--------\n"</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"search用法：匹配成功  "</span>,p1.search(<span class="string">"akarmy"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># regex.findall(string[, pos[, endpos]])</span></span><br><span class="line"><span class="comment"># 找到所有匹配的子串，并返回一个 list 。</span></span><br><span class="line">print(<span class="string">"\n-------findall的用法--------\n"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p2 = re.compile(<span class="string">r"\d+"</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"从字符串中找到所有数字"</span>,p2.findall(<span class="string">"abc1def2rst3xyz"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># regex.finditer(string[, pos[, endpos]])</span></span><br><span class="line"><span class="comment"># 找到所有匹配的子串，并返回由这些匹配结果（match object）组成的迭代器 。</span></span><br><span class="line">print(<span class="string">"\n-------finditer的用法--------\n"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p2.findall(<span class="string">"abc1def6rst25xyz"</span>):</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># re.split(pattern, string, maxsplit=0, flags=0) 模块级函数</span></span><br><span class="line">print(<span class="string">"\n-------split的用法--------\n"</span>)</span><br><span class="line">p2_1 = re.compile(<span class="string">r"[A-Z]+"</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"根据大写字母分割字符串"</span>,p2_1.split(<span class="string">"abcDefgHijkLmnoPqrs"</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># re.sub(pattern, repl, string, count=0, flags=0)：</span></span><br><span class="line"><span class="comment"># 替换函数</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">"\n-------sub的用法--------\n"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(m)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> m.group().upper()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pattern = re.compile(<span class="string">r"like"</span>, re.I)</span><br><span class="line">s1 = pattern.sub(<span class="string">r"love"</span>, <span class="string">"I like you, do you like me?"</span>)</span><br><span class="line">s2 = pattern.sub(fun, <span class="string">"I like you, do you like me?"</span>)</span><br><span class="line">print(<span class="string">"love替换为like"</span>,s1)</span><br><span class="line">print(<span class="string">"替换函数的使用"</span>,s2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># match.group([group1, ...])</span></span><br><span class="line"><span class="comment"># 返回 match object 中的字符串。每一个 ( ) 都是一个分组，分组编号从1开始</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">"\n-------match.group的用法--------\n"</span>)</span><br><span class="line"></span><br><span class="line">p3 = re.compile(<span class="string">r"(\w+) (\w+)"</span>)</span><br><span class="line">m = p3.match(<span class="string">"Kobe Bryant, Lakers"</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"match object"</span>, m)</span><br><span class="line">print(<span class="string">"完整匹配"</span>,m.group())</span><br><span class="line">print(<span class="string">"match first group"</span>, m.group(<span class="number">1</span>))</span><br><span class="line">print(<span class="string">"match second group"</span>, m.group(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># match.groups()</span></span><br><span class="line"><span class="comment"># 返回由所有分组匹配到的字符串组成的 tuple</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">"\n-------match.group的用法--------\n"</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"match all the groups"</span>,m.groups())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># match.start([group])</span></span><br><span class="line"><span class="comment"># 没有参数时，返回匹配到的字符串的起始位置。指定参数（整数）时，返回该分组匹配到的字符串的起始位置。</span></span><br><span class="line">print(<span class="string">"\n-------match.start的用法--------\n"</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"返回第一个匹配开始的index值"</span>,m.start())</span><br><span class="line">print(<span class="string">"返回第二组匹配开始的index值"</span>,m.start(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># match.span([group])</span></span><br><span class="line"><span class="comment"># 返回一个二元 tuple 表示匹配到的字符串的范围，即 (start, end)</span></span><br><span class="line">print(<span class="string">"\n-------match.span的用法--------\n"</span>)</span><br><span class="line">print(<span class="string">"返回第一个匹配的index范围值"</span>,m.span())</span><br><span class="line">print(<span class="string">"返回第二个匹配的index范围值"</span>,m.span(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># flags匹配模式的使用</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = re.compile(<span class="string">r"like"</span>,re.I)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"忽略大小写的匹配"</span>,a.findall(<span class="string">"I like you, do you LIKE me,or LiKes?"</span>))</span><br></pre></td></tr></table></figure><p>其输出结果如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">-------match的用法--------</span><br><span class="line"></span><br><span class="line">当不指定位置时,match只从开头匹配:匹配成功   &lt;re.Match object; span=(0, 2), match=&apos;ar&apos;&gt;</span><br><span class="line">当不指定位置时,match只从开头匹配:匹配失败   None</span><br><span class="line">match从指定位置的开头匹配:匹配成功   &lt;re.Match object; span=(2, 4), match=&apos;ar&apos;&gt;</span><br><span class="line"></span><br><span class="line">-------search的用法--------</span><br><span class="line"></span><br><span class="line">search用法：匹配成功   &lt;re.Match object; span=(2, 4), match=&apos;ar&apos;&gt;</span><br><span class="line"></span><br><span class="line">-------findall的用法--------</span><br><span class="line"></span><br><span class="line">从字符串中找到所有数字 [&apos;1&apos;, &apos;2&apos;, &apos;3&apos;]</span><br><span class="line"></span><br><span class="line">-------finditer的用法--------</span><br><span class="line"></span><br><span class="line">1</span><br><span class="line">6</span><br><span class="line">25</span><br><span class="line"></span><br><span class="line">-------split的用法--------</span><br><span class="line"></span><br><span class="line">根据大写字母分割字符串 [&apos;abc&apos;, &apos;efg&apos;, &apos;ijk&apos;, &apos;mno&apos;, &apos;qrs&apos;]</span><br><span class="line"></span><br><span class="line">-------sub的用法--------</span><br><span class="line"></span><br><span class="line">love替换为like I love you, do you love me?</span><br><span class="line">替换函数的使用 I LIKE you, do you LIKE me?</span><br><span class="line"></span><br><span class="line">-------match.group的用法--------</span><br><span class="line"></span><br><span class="line">match object &lt;re.Match object; span=(0, 11), match=&apos;Kobe Bryant&apos;&gt;</span><br><span class="line">完整匹配 Kobe Bryant</span><br><span class="line">match first group Kobe</span><br><span class="line">match second group Bryant</span><br><span class="line"></span><br><span class="line">-------match.group的用法--------</span><br><span class="line"></span><br><span class="line">match all the groups (&apos;Kobe&apos;, &apos;Bryant&apos;)</span><br><span class="line"></span><br><span class="line">-------match.start的用法--------</span><br><span class="line"></span><br><span class="line">返回第一个匹配开始的index值 0</span><br><span class="line">返回第二组匹配开始的index值 5</span><br><span class="line"></span><br><span class="line">-------match.span的用法--------</span><br><span class="line"></span><br><span class="line">返回第一个匹配的index范围值 (0, 11)</span><br><span class="line">返回第二个匹配的index范围值 (5, 11)</span><br><span class="line">忽略大小写的匹配 [&apos;like&apos;, &apos;LIKE&apos;, &apos;LiKe&apos;]</span><br></pre></td></tr></table></figure><p>参考资料如下：  </p><ul><li><a href="https://blog.csdn.net/lisonglisonglisong/article/details/39697137" target="_blank" rel="noopener">https://blog.csdn.net/lisonglisonglisong/article/details/39697137</a>  </li><li><a href="https://www.cnblogs.com/haochen273/p/10256418.html#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8F%8Are%E6%A8%A1%E5%9D%97%E7%9A%84%E4%BD%BF%E7%94%A8" target="_blank" rel="noopener">https://www.cnblogs.com/haochen273/p/10256418.html#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8F%8Are%E6%A8%A1%E5%9D%97%E7%9A%84%E4%BD%BF%E7%94%A8</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Python核心编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 正则表达式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP和UDP套接字介绍及Socket模块的使用</title>
      <link href="/2019/03/02/TCP%E5%92%8CUDP%E5%A5%97%E6%8E%A5%E5%AD%97%E4%BB%8B%E7%BB%8D%E5%8F%8ASocket%E6%A8%A1%E5%9D%97%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/2019/03/02/TCP%E5%92%8CUDP%E5%A5%97%E6%8E%A5%E5%AD%97%E4%BB%8B%E7%BB%8D%E5%8F%8ASocket%E6%A8%A1%E5%9D%97%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="1-客户端-服务端架构"><a href="#1-客户端-服务端架构" class="headerlink" title="1.客户端/服务端架构"></a>1.客户端/服务端架构</h1><div align="center"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c9/Client-server-model.svg/375px-Client-server-model.svg.png"></div><ul><li>服务端的作用: 等待客户端的请求，并相应他们提供服务，然后等待更多请求  </li><li>客户端的作用： 发送请给给服务端以获取相关信息  </li></ul><p>注意：  </p><ol><li>客户端和服务器交互之前，需要进行一些必要的设置： 设置通信端点(比如，你要上网，必须要网线插口才可以)  </li><li>客户端需要做的就是创建一个它的单一通信端点，然后建立一个到服务器的连接，然后，客户端就可以发送请求，一旦请求诶服务器处理，且客户端收到了请求的结果，此次通信就结束了  </li></ol><h1 id="2-套接字"><a href="#2-套接字" class="headerlink" title="2. 套接字"></a>2. 套接字</h1><h1 id="3-Python中的网络编程socket"><a href="#3-Python中的网络编程socket" class="headerlink" title="3. Python中的网络编程socket"></a>3. Python中的网络编程socket</h1><h2 id="3-1-socket-模块函数"><a href="#3-1-socket-模块函数" class="headerlink" title="3.1. socket()模块函数"></a>3.1. socket()模块函数</h2><p>创建套接字的语法如下：  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socket.socket(socket_family, socket_type, protocol=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><ul><li><code>socket_family</code>： 是<code>AF_UNIX</code>(基于文件的套接字)和<code>AF_INET</code>(基于网络的套接字)  </li><li><code>socket_type</code>: <code>SOCK_STREAM</code>(面向连接的套接字，也称为<code>TCP/TP</code>套接字) + <code>SOCK_DGRAM</code>(无连接套接字，也称为<code>UDP/TP</code>套接字)  </li><li><code>protocol</code>：一般为0，不用设置这个  </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> socket <span class="keyword">import</span> *</span><br><span class="line">tcpSock = socket(socket.AF_INET,socket.SOCK_STREAM)   <span class="comment"># 创建TCP/TP套接字</span></span><br><span class="line">udpSock = socket(socket.AF_INET,socket.SOCK_DGRAM)    <span class="comment"># 创建UDP/IP套接字</span></span><br></pre></td></tr></table></figure><h2 id="3-2-套接字对象的方法"><a href="#3-2-套接字对象的方法" class="headerlink" title="3.2. 套接字对象的方法"></a>3.2. 套接字对象的方法</h2><table><thead><tr><th>名称</th><th>说明</th><th>类别</th></tr></thead><tbody><tr><td>s.bind()</td><td>将地址(主机名-端口号对)绑定到套接字上</td><td>服务器套接字方法</td></tr><tr><td>s.listen()</td><td>设置并启动TCP监听器</td><td></td></tr><tr><td>s.accept()</td><td>被动接受TCP客户端连接，一直等待直到连接到达(阻塞)</td><td></td></tr><tr><td>s.connect()</td><td>主动发起TCP服务器连接</td><td>客户端套接字方法</td></tr><tr><td>s.connect_ex()</td><td>connect的扩展，会以错误码的形式返回问题</td><td></td></tr><tr><td>s.recv()</td><td>接收TCP信息</td><td>普通的套接字方法</td></tr><tr><td>s.recv_into()</td><td>接收TCP信息到指定发缓存区</td><td></td></tr><tr><td>s.send()</td><td>发送TCP信息</td><td></td></tr><tr><td>s.sendall()</td><td>完整地发送TCP信息</td><td></td></tr><tr><td>s.recvfrom()</td><td>接收UDP信息</td><td></td></tr><tr><td>s.recvfrom_into()</td><td>接收UDP信息到指定的缓冲区</td><td></td></tr><tr><td>s.sendto()</td><td>发送UDP信息</td><td></td></tr><tr><td>s.getpeername()</td><td>连接到套接字TCP的远程地址</td><td></td></tr><tr><td>s.getsockname()</td><td>当前套接字的地址</td><td></td></tr><tr><td>s.getsockopt()</td><td>返回给定套接字选项的值</td><td></td></tr><tr><td>s.setsockopt()</td><td>设置给定套接字选项的值</td><td></td></tr><tr><td>s.shutdown()</td><td>关闭连接</td><td></td></tr><tr><td>s.close()</td><td>关闭套接字</td><td></td></tr><tr><td>s.detach()</td><td>在未关闭文件描述符的情况下关闭套接字，返回文件描述符</td><td></td></tr><tr><td>s.ioctl()</td><td>控制套接字的模式</td><td></td></tr><tr><td>s.setblocking()</td><td>设置套接字的阻塞或者非阻塞模式</td><td>面向阻塞的套接字方法</td></tr><tr><td>s.settimeout()</td><td>设置阻塞套接字的操作的超时时间</td><td></td></tr><tr><td>s.gettimeout()</td><td>获取阻塞套接字操作的超时时间</td><td></td></tr><tr><td>s.fileno()</td><td>套接字的文件描述符</td><td>面向文件的套接字方法</td></tr><tr><td>s.makefile()</td><td>创建与套接字关联的文件对象</td><td></td></tr><tr><td>s.family</td><td>套接字家族</td><td>数据类型</td></tr><tr><td>s.type</td><td>套接字类型</td><td></td></tr><tr><td>s.proto</td><td>套接字协议</td></tr></tbody></table><h2 id="3-3-创建TCP服务器"><a href="#3-3-创建TCP服务器" class="headerlink" title="3.3. 创建TCP服务器"></a>3.3. 创建TCP服务器</h2><p>这里我给出了创建TCP服务器的一般流程</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ss = socket()              <span class="comment"># 创建服务器套接字</span></span><br><span class="line">ss.bind()                  <span class="comment"># 套接字与地址绑定</span></span><br><span class="line">ss.listen()                <span class="comment"># 监听连接</span></span><br><span class="line">inf_loop:                  <span class="comment"># 服务器无线循环中</span></span><br><span class="line">  cs = ss.accept()         <span class="comment"># 接收客户端连接</span></span><br><span class="line">  comm_loop:               <span class="comment"># 通信循环</span></span><br><span class="line">    cs.recv/cs.send()      <span class="comment"># 对话：接收或者发送</span></span><br><span class="line">  cs.close()               <span class="comment"># 关闭客户端套接字</span></span><br><span class="line">ss.close()                 <span class="comment"># 关闭服务端套接字(可选)</span></span><br></pre></td></tr></table></figure><ul><li>所有套接字都需要通过socket.socket()来创建来占用一个端口bind()并等待客户端的请求  </li><li>因为TCP是面向连接的通信，在执行请求前，需要设置一些监听设备listen()，一旦完成，就开始服务器的无线循环inf_loop</li><li>一旦服务器接收accpet()了一个连接，就会返回一个独立的客户端套接字cs，用它来与即将到来的信息进行交换(类似于主线员将这个客户切换给一个专用的客服代表，这样主线员就可以空出来继续接收连接)</li><li>通信开始，执行相关操作cs.recv或者cs.send()  </li><li>完成通信，关闭客户端套接字(切断客服代表的电话)cs.close()</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> socket <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> ctime</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">''</span></span><br><span class="line">PORT = <span class="number">21567</span></span><br><span class="line">BUFSIZ = <span class="number">1024</span></span><br><span class="line">ADDR = (HOST,PORT)</span><br><span class="line"></span><br><span class="line">tcpSerSock = socket(AF_INET,SOCK_STREAM)</span><br><span class="line">tcpSerSock.bind(ADDR)</span><br><span class="line">tcpSerSock.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    print(<span class="string">"等待连接中...."</span>)</span><br><span class="line">    tcpCliSock, addr = tcpSerSock.accept()</span><br><span class="line">    print(<span class="string">"获取了一个的连接: "</span>,addr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        data = tcpCliSock.recv(BUFSIZ)</span><br><span class="line">        SendText = <span class="string">'Thanks for your connections---'</span> + data.decode()</span><br><span class="line"></span><br><span class="line">        print(type(data))</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        tcpCliSock.send(SendText.encode())</span><br><span class="line"></span><br><span class="line">    tcpCliSock.close()</span><br><span class="line">tcpSerSock.close()</span><br></pre></td></tr></table></figure><h2 id="3-4-创建TCP客户端"><a href="#3-4-创建TCP客户端" class="headerlink" title="3.4. 创建TCP客户端"></a>3.4. 创建TCP客户端</h2><p>这里我们给出创建TCP客户端的模板  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cs = socket()          <span class="comment"># 创建客户端套接字</span></span><br><span class="line">cs.connect()           <span class="comment"># 尝试连接服务器</span></span><br><span class="line">comm_loop:             <span class="comment"># 通信循环</span></span><br><span class="line">  cs.send()/cs.recv()  <span class="comment"># 对话发送，接收</span></span><br><span class="line">cs.close()             <span class="comment"># 关闭客户端套接字</span></span><br></pre></td></tr></table></figure><p>标准的TCP实例如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> socket <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">'localhost'</span></span><br><span class="line">PORT = <span class="number">1565</span></span><br><span class="line">BUFSIZ = <span class="number">1024</span></span><br><span class="line">ADDR = (HOST,PORT)</span><br><span class="line"></span><br><span class="line">tcpCliSock = socket(AF_INET,SOCK_STREAM)</span><br><span class="line">tcpCliSock.bind(ADDR)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    data = input(<span class="string">'&gt;'</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    tcpCliSock.send(data.encode())</span><br><span class="line">    data = tcpCliSock.recv(BUFSIZ)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> data:       <span class="comment"># 服务器端终止且对recv()方法的调用失败</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    print(data.decode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line">tcpCliSock.close()</span><br></pre></td></tr></table></figure><h2 id="3-5-运行TCP服务-客户端"><a href="#3-5-运行TCP服务-客户端" class="headerlink" title="3.5. 运行TCP服务-客户端"></a>3.5. 运行TCP服务-客户端</h2><ul><li>首先运行TCP服务端  </li></ul><div align="center"><img src="https://www.cnblogs.com/images/cnblogs_com/haochen273/1389248/o_1.PNG"></div><ul><li>然后运行TCP客户端，并且输入<code>Python</code>  </li></ul><div align="center"><img src="https://www.cnblogs.com/images/cnblogs_com/haochen273/1389248/o_2.PNG"></div><h2 id="3-6-创建UDP服务器"><a href="#3-6-创建UDP服务器" class="headerlink" title="3.6. 创建UDP服务器"></a>3.6. 创建UDP服务器</h2><p>UDP服务器不像TCP服务器那么多设置，因为UDP服务器不是面向连接的，除了等待传入的连接外，几乎不需要做其他任何工作  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ss = socket()</span><br><span class="line">ss.bind()</span><br><span class="line">inf_loop:</span><br><span class="line">  cs = css.recvfrom()/ss.sendto()</span><br></pre></td></tr></table></figure><p><strong>特点：服务器只接受小象，并可能回复数据</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> socket <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">''</span></span><br><span class="line">PORT = <span class="number">21567</span></span><br><span class="line">BUFSIZ = <span class="number">1024</span></span><br><span class="line">ADDR = (HOST,PORT)</span><br><span class="line"></span><br><span class="line">udpServer = socket(AF_INET,SOCK_DGRAM)</span><br><span class="line">udpServer.bind(ADDR)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    print(<span class="string">"等待连接...."</span>)</span><br><span class="line">    data,addr = udpServer.recvfrom(BUFSIZ)</span><br><span class="line">    print(<span class="string">"获取了一个的连接: "</span>, addr)</span><br><span class="line"></span><br><span class="line">    SendText = <span class="string">'Thanks for your connections---'</span> + data.decode()</span><br><span class="line"></span><br><span class="line">    udpServer.sendto(SendText.encode(),addr)</span><br><span class="line"></span><br><span class="line">udpServer.close()</span><br></pre></td></tr></table></figure><h2 id="3-7-创建UDP客户端"><a href="#3-7-创建UDP客户端" class="headerlink" title="3.7. 创建UDP客户端"></a>3.7. 创建UDP客户端</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> socket <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">'localhost'</span></span><br><span class="line">PORT = <span class="number">21567</span></span><br><span class="line">BUFSIZ = <span class="number">1024</span></span><br><span class="line">ADDR = (HOST,PORT)</span><br><span class="line"></span><br><span class="line">udpCliSock = socket(AF_INET,SOCK_DGRAM)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    into = input(<span class="string">"&gt;"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> into:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    udpCliSock.sendto(into.encode(),ADDR)</span><br><span class="line"></span><br><span class="line">    data,ADDR = udpCliSock.recvfrom(BUFSIZ)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    print(data.decode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line">udpCliSock.close()</span><br></pre></td></tr></table></figure><p>运行服务端，以及客户端  </p><div align="center"><img src="https://www.cnblogs.com/images/cnblogs_com/haochen273/1389248/o_3.PNG"></div><div align="center"><img src="https://www.cnblogs.com/images/cnblogs_com/haochen273/1389248/o_4.PNG"></div><p>参考文献  </p><ul><li><a href="https://www.cnblogs.com/liu-yao/p/5283379.html" target="_blank" rel="noopener">https://www.cnblogs.com/liu-yao/p/5283379.html</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Python网络编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Socket </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python中SocketServer的使用</title>
      <link href="/2019/03/02/Python%E4%B8%ADSocketServer%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/2019/03/02/Python%E4%B8%ADSocketServer%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<ol><li>SocketServer模块介绍  </li></ol><p>SockerServer是创建网络客户端和服务器所必须的代码，这个模块有为你创建的各种各样的类  </p><table><thead><tr><th>类</th><th>描述</th></tr></thead><tbody><tr><td><code>BaseServer</code></td><td>包含服务器的核心功能</td></tr><tr><td><code>TCPServer/UDPServer</code></td><td>基于网络的TCP/UDP服务器</td></tr><tr><td><code>UnixStreamServer/UnixDatagramServer</code></td><td>基于文件的基础同步TCP/UDP服务器</td></tr><tr><td><code>ForkingMixIn/ThreadingMixIn</code></td><td>核心派出或者线程功能</td></tr><tr><td><code>ForkingTCPServer/ForkingUDPServer</code></td><td>ForkingMixIn和TCPServer/UDPServer的组合</td></tr><tr><td><code>ThreadingTCPServer/ThreadingUDPserver</code></td><td>ThreadingMixIn和TCPServer/UDPServer的组合</td></tr><tr><td><code>BaseRequestHandler</code></td><td>包含处理服务请求的核心功能</td></tr><tr><td><code>StreamRequestHandler/DatagramRequestHandler</code></td><td>实现TCP/UDP服务器的服务处理器</td></tr></tbody></table><h1 id="2-创建SocketServer-TCP服务器"><a href="#2-创建SocketServer-TCP服务器" class="headerlink" title="2. 创建SocketServer TCP服务器"></a>2. 创建SocketServer TCP服务器</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> socketserver <span class="keyword">import</span> (TCPServer <span class="keyword">as</span> TCP, StreamRequestHandler <span class="keyword">as</span> SRH)</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">''</span></span><br><span class="line">PORT = <span class="number">21567</span></span><br><span class="line">ADDR = (HOST,PORT)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyRequestHandler</span><span class="params">(SRH)</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 重写SRH中的handle方法</span></span><br><span class="line">    <span class="comment"># 当接收一个来自客户端的信息时，他就会调用handle()方法</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"获取了一个的连接: "</span>, self.client_address)</span><br><span class="line">        <span class="comment"># SRH将输入和输出套接字看成类似文件的对象，我们可以通过readline()来获取客户端信息，并通过write()将字符串发送给客户端</span></span><br><span class="line">        </span><br><span class="line">        SendText = <span class="string">'Thanks for your connections---'</span> + self.rfile.readline()</span><br><span class="line">        self.wfile.write(SendText)</span><br><span class="line"></span><br><span class="line">tcpServ = TCP(ADDR,MyRequestHandler)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"等待连接....."</span>)</span><br><span class="line"><span class="comment"># 无线循环下去</span></span><br><span class="line">tcpServ.serve_forever()</span><br></pre></td></tr></table></figure><h1 id="3-创建SocketServer-TCP客户端"><a href="#3-创建SocketServer-TCP客户端" class="headerlink" title="3. 创建SocketServer TCP客户端"></a>3. 创建SocketServer TCP客户端</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> socket <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">'localhost'</span></span><br><span class="line">PORT = <span class="number">21567</span></span><br><span class="line">BUFSIZ = <span class="number">1024</span></span><br><span class="line">ADDR = (HOST,PORT)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># socketserver的默认行为：接收连接、获取请求、关闭连接</span></span><br><span class="line">    <span class="comment"># 我们不能再整个应用执行过程中一直保持连接，每次向服务器发送消息时，都需要创建一个新的套接字</span></span><br><span class="line">    tcpClient = socket(AF_INET, SOCK_STREAM)</span><br><span class="line">    tcpClient.connect(ADDR)</span><br><span class="line">    into = input(<span class="string">"&gt;"</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> into:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    tcpClient.send(into.encode())</span><br><span class="line"></span><br><span class="line">    data = tcpClient.recv(BUFSIZ)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    print(data.strip())</span><br><span class="line">    tcpClient.close()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Python网络编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Socket </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pyecharts的API配置内容</title>
      <link href="/2019/03/02/pyecharts%E7%9A%84API%E9%85%8D%E7%BD%AE%E5%86%85%E5%AE%B9/"/>
      <url>/2019/03/02/pyecharts%E7%9A%84API%E9%85%8D%E7%BD%AE%E5%86%85%E5%AE%B9/</url>
      
        <content type="html"><![CDATA[<h1 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h1><p>安装pyecharts  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pyecharts</span><br></pre></td></tr></table></figure><h1 id="图表配置"><a href="#图表配置" class="headerlink" title="图表配置"></a>图表配置</h1><h2 id="图形初始化选项"><a href="#图形初始化选项" class="headerlink" title="图形初始化选项"></a>图形初始化选项</h2><table><thead><tr><th>接收参数</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>title(str)</td><td>“”</td><td>主标题</td></tr><tr><td>subtitle(str)</td><td>“”</td><td>副标题</td></tr><tr><td>width(int)</td><td>800px</td><td>画布宽度</td></tr><tr><td>height(int)</td><td>400px</td><td>画布高度</td></tr><tr><td>title_pos(str/int)</td><td>left</td><td>标题距离左侧距离</td></tr><tr><td>title_top(str/int)</td><td>top</td><td>标题距离顶部距离</td></tr><tr><td>title_color(str)</td><td><code>#000</code></td><td>主标题颜色</td></tr><tr><td>subtitle_color(str)</td><td><code>#aaa</code></td><td>副标题颜色</td></tr><tr><td>title_text_size(int)</td><td>18</td><td>主标题字体大小</td></tr><tr><td>subtitle_text_size (int)</td><td>12</td><td>副标题字体大小</td></tr><tr><td>background_color(str)</td><td>‘#fff’</td><td>画布背景颜色</td></tr><tr><td>page_title (str)</td><td>‘Echarts’</td><td>指定生成的 html 文件中 <code>&lt;title&gt;</code> 标签的值</td></tr><tr><td>renderer(str)</td><td>‘canvas’</td><td>指定使用渲染方式</td></tr><tr><td>extra_html_text_label(list)</td><td></td><td></td></tr><tr><td>is_animation(bool)</td><td>True</td><td>是否开启动画</td></tr></tbody></table><h2 id="通用配置项：add-中设置"><a href="#通用配置项：add-中设置" class="headerlink" title="通用配置项：add()中设置"></a>通用配置项：add()中设置</h2><h3 id="xyAxis：轴相关设置"><a href="#xyAxis：轴相关设置" class="headerlink" title="xyAxis：轴相关设置"></a>xyAxis：轴相关设置</h3><table><thead><tr><th>设置选项</th><th>格式</th><th>说明</th></tr></thead><tbody><tr><td>is_convert</td><td>bool</td><td>是否交换 x 轴与 y 轴</td></tr><tr><td>is_xaxislabel_align</td><td>bool</td><td>x 轴刻度线和标签是否对齐</td></tr><tr><td>is_xaxis_inverse</td><td>bool</td><td>是否反向 x 坐标轴。</td></tr><tr><td>is_xaxis_boundarygap</td><td>bool</td><td>x 轴两边留白策略，适用于类目轴。</td></tr><tr><td>is_xaxis_show</td><td>bool</td><td>是否显示 x 轴</td></tr><tr><td>is_splitline_show</td><td>bool</td><td>是否显示 y 轴网格线。</td></tr><tr><td>x_axis</td><td>list</td><td>x 轴数据项</td></tr><tr><td>xaxis_interval</td><td>int</td><td>x 轴刻度标签的显示间隔，在类目轴中有效。</td></tr><tr><td>xaxis_margin</td><td>int</td><td>x 轴刻度标签与轴线之间的距离</td></tr><tr><td>xaxis_name</td><td>string</td><td>x 轴名称</td></tr><tr><td>xaxis_name_size</td><td>int</td><td>x 轴名称体大小</td></tr><tr><td>xaxis_name_gap</td><td>in</td><td>x 轴名称与轴线之间的距离。</td></tr><tr><td>xaxis_name_pos</td><td>str</td><td>x 轴名称位置，有’start’，’middle’，’end’可选</td></tr><tr><td>xaxis_min</td><td>int/float</td><td>x 坐标轴刻度最小值，默认为自适应。</td></tr><tr><td>xaxis_max</td><td>int/float</td><td>x 坐标轴刻度最大值，默认为自适应。</td></tr><tr><td>xaxis_pos</td><td>str</td><td>x 坐标轴位置，有’top’,’bottom’可选</td></tr><tr><td>xaxis_label_textsize</td><td>int</td><td>x 坐标轴标签字体大小。</td></tr><tr><td>xaxis_label_textcolor</td><td>str</td><td>x 坐标轴标签字体颜色。</td></tr><tr><td>xaxis_type</td><td>str</td><td>x 坐标轴类型（value,category,log）</td></tr><tr><td>xaxis_rotate</td><td>int</td><td>x 轴刻度标签旋转的角度</td></tr><tr><td>xaxis_formatter</td><td>str</td><td>x 轴标签格式器（回调函数）</td></tr><tr><td>xaxis_line_color</td><td>str</td><td>x 坐标轴线线的颜色。</td></tr><tr><td>xaxis_line_width</td><td>int</td><td>x 坐标轴线线的宽度。</td></tr></tbody></table><h3 id="datazoom：缩放设置"><a href="#datazoom：缩放设置" class="headerlink" title="datazoom：缩放设置"></a>datazoom：缩放设置</h3><p>一般不用，详情请看<code>http://pyecharts.org/#/zh-cn/charts_configure</code></p><h3 id="legend-图例组件"><a href="#legend-图例组件" class="headerlink" title="legend:图例组件"></a>legend:图例组件</h3><table><thead><tr><th>设置选项</th><th>格式</th><th>说明</th></tr></thead><tbody><tr><td>is_legend_show</td><td>bool</td><td>是否显示顶端图例</td></tr><tr><td>legend_orient</td><td>str</td><td>图例列表的布局朝向</td></tr><tr><td>legend_pos</td><td>str</td><td>图例组件离容器左侧的距离’left’, ‘center’, ‘right’</td></tr><tr><td>legend_top</td><td>str</td><td>图例组件离容器上侧的距离</td></tr><tr><td>legend_selectedmode</td><td>str/bool</td><td>图例选择的模式，控制是否可以通过点击图例改变系列的显示状态</td></tr><tr><td>legend_text_size</td><td>int</td><td>图例名称字体大小</td></tr><tr><td>legend_text_color</td><td>str</td><td>图例名称字体颜色</td></tr></tbody></table><h3 id="label-文本标签"><a href="#label-文本标签" class="headerlink" title="label:文本标签"></a>label:文本标签</h3><table><thead><tr><th>设置选项</th><th>格式</th><th>说明</th></tr></thead><tbody><tr><td>is_label_show</td><td></td><td>是否正常显示标签</td></tr><tr><td>is_label_emphasis</td><td></td><td>是否高亮显示标签</td></tr><tr><td>label_pos</td><td></td><td>标签的位置’top’, ‘left’, ‘right’, ‘bottom’, ‘inside’,’outside’</td></tr><tr><td>label_emphasis_pos</td><td></td><td>高亮标签的位置’top’, ‘left’, ‘right’, ‘bottom’, ‘inside’,’outside’</td></tr><tr><td>label_text_color</td><td></td><td>标签字体颜色</td></tr><tr><td>label_emphasis_textcolor</td><td></td><td>高亮标签字体颜色</td></tr><tr><td>label_text_size</td><td></td><td>标签字体大小</td></tr><tr><td>label_emphasis_textsize</td><td></td><td>高亮标签字体大小</td></tr><tr><td>is_random</td><td></td><td>是否随机排列颜色列表</td></tr><tr><td>label_color</td><td></td><td>自定义标签颜色</td></tr><tr><td>label_formatter</td><td></td></tr></tbody></table><h3 id="toolbox"><a href="#toolbox" class="headerlink" title="toolbox"></a>toolbox</h3><table><thead><tr><th>设置选项</th><th>格式</th><th>说明</th></tr></thead><tbody><tr><td>is_toolbox_show</td><td>bool</td><td>是否显示右侧实用工具箱</td></tr><tr><td>is_more_utils</td><td>bool</td><td>指定是否提供更多的实用工具按钮</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> Python可视化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pyecharts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL基础语法</title>
      <link href="/2019/03/02/MySQL%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/"/>
      <url>/2019/03/02/MySQL%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="基本MySQL语法"><a href="#基本MySQL语法" class="headerlink" title="基本MySQL语法"></a>基本MySQL语法</h1><h2 id="从CMD中调用mysql"><a href="#从CMD中调用mysql" class="headerlink" title="从CMD中调用mysql"></a>从CMD中调用mysql</h2><p>运行以下代码<code>mysql -u root -p</code>连接服务器并且输入密码  </p><h2 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h2><table><thead><tr><th>语法</th><th>用法说明</th></tr></thead><tbody><tr><td>create database 数据库名字 charset=utf8;</td><td>创建数据库</td></tr><tr><td>drop database 数据库名字;</td><td>删除数据库</td></tr><tr><td>use 数据库名字;</td><td>使用这个数据库</td></tr><tr><td>show databases;</td><td>查看当前的所有数据库</td></tr><tr><td>select database();</td><td>查看当前正在用的是哪个数据库</td></tr></tbody></table><h2 id="创建数据库下面的表"><a href="#创建数据库下面的表" class="headerlink" title="创建数据库下面的表"></a>创建数据库下面的表</h2><table><thead><tr><th>语法</th><th>用法说明</th></tr></thead><tbody><tr><td>show tables;</td><td>查看所有的表</td></tr><tr><td>create table 表名(列和其类型);</td><td>创建表</td></tr><tr><td>desc 表名;</td><td>查看表的结构</td></tr><tr><td>`alter table 表名 add</td><td>change</td><td>drop 列名 类型；`</td><td>修改表(增加，修改，删除列)</td></tr><tr><td>drop table 表名;</td><td>删除表</td></tr><tr><td>rename table 原表名 to 新表名;</td><td>更改表的名字</td></tr><tr><td>show create table 表名;</td><td>查看表的创建语句</td></tr></tbody></table><h2 id="表格中的数据操作"><a href="#表格中的数据操作" class="headerlink" title="表格中的数据操作"></a>表格中的数据操作</h2><table><thead><tr><th>语法</th><th>用法说明</th></tr></thead><tbody><tr><td>select * from  表名;</td><td>查询数据</td></tr><tr><td>insert into 表名 values(…);</td><td>添加数据（顺序要与表格一致）:全列插入</td></tr><tr><td>insert into 表名(列1，..，) values(…);</td><td>添加数据（顺序要与表格一致）:指定列插入</td></tr><tr><td>insert into 表名 values(),()…;</td><td>添加数据：一次性插入多条数据</td></tr><tr><td>update 表名 set 列1=值1,… where 条件;</td><td>修改数据</td></tr><tr><td>delete from 表名 where 条件;</td><td>删除数据</td></tr></tbody></table><h2 id="例子演示"><a href="#例子演示" class="headerlink" title="例子演示"></a>例子演示</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">create table students(</span><br><span class="line">  id int auto_increment primary key not null,</span><br><span class="line">  name varchar(10) not null,</span><br><span class="line">  gender bit default 1,</span><br><span class="line">  birthday datetime</span><br><span class="line">  )  </span><br><span class="line"></span><br><span class="line">alter table students add isDelete bit default 0;</span><br><span class="line"></span><br><span class="line">desc students;  </span><br><span class="line"></span><br><span class="line">show create table students;  </span><br><span class="line"></span><br><span class="line">insert into students values(0, &apos;hao&apos;,1,&apos;1991-1-1&apos;,0);</span><br><span class="line">insert into students(name) values(&apos;a1&apos;),(&apos;a2&apos;),(&apos;a3&apos;);</span><br><span class="line"></span><br><span class="line">update students set birthday=&apos;1990-2-5&apos; where id=2;</span><br><span class="line">select * from students;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">+----------+-------------+------+-----+---------+----------------+</span><br><span class="line">| Field    | Type        | Null | Key | Default | Extra          |</span><br><span class="line">+----------+-------------+------+-----+---------+----------------+</span><br><span class="line">| id       | int(11)     | NO   | PRI | NULL    | auto_increment |</span><br><span class="line">| name     | varchar(10) | NO   |     | NULL    |                |</span><br><span class="line">| gender   | bit(1)      | YES  |     | b&apos;1&apos;    |                |</span><br><span class="line">| birthday | datetime    | YES  |     | NULL    |                |</span><br><span class="line">| isDelete | bit(1)      | YES  |     | b&apos;0&apos;    |                |</span><br><span class="line">+----------+-------------+------+-----+---------+----------------+  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">| students | CREATE TABLE `students` (</span><br><span class="line">  `id` int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `name` varchar(10) NOT NULL,</span><br><span class="line">  `gender` bit(1) DEFAULT b&apos;1&apos;,</span><br><span class="line">  `birthday` datetime DEFAULT NULL,</span><br><span class="line">  `isDelete` bit(1) DEFAULT b&apos;0&apos;,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8 |  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">+----+------+--------+---------------------+----------+</span><br><span class="line">| id | name | gender | birthday            | isDelete |</span><br><span class="line">+----+------+--------+---------------------+----------+</span><br><span class="line">|  1 | hao  |       | 1991-01-01 00:00:00 |          |</span><br><span class="line">|  2 | hao  |       | 1991-01-01 00:00:00 |          |</span><br><span class="line">|  3 | kjkj |       | NULL                |          |</span><br></pre></td></tr></table></figure><h1 id="MySQL查询语句"><a href="#MySQL查询语句" class="headerlink" title="MySQL查询语句"></a>MySQL查询语句</h1><p>查询的基本语法是  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * from students; # 全部查询</span><br><span class="line">select id,name from students;   # 根据条件选择</span><br><span class="line">select distinct gender from students;  # 消除重复行</span><br><span class="line">select distinct id, gender from students;  # 消除重复行(id, gender全部相同时才会消除)</span><br></pre></td></tr></table></figure><h2 id="条件where"><a href="#条件where" class="headerlink" title="条件where"></a>条件where</h2><p>对行数据进行筛选，满足要求的出现在结果集中，不满足的直接舍弃不要  </p><p><strong>先查看condition，在执行select</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from 表名 wehre conditions;</span><br></pre></td></tr></table></figure><h3 id="condition的写法"><a href="#condition的写法" class="headerlink" title="condition的写法"></a>condition的写法</h3><ul><li><strong>比较运算符</strong>： <code>=, &gt;, &lt;, &gt;=,&lt;=, !=</code>  </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where id&gt;3;</span><br></pre></td></tr></table></figure><ul><li><strong>逻辑运算符</strong>： <code>and, or, not</code>  </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where id&gt;3 and gender=0;</span><br></pre></td></tr></table></figure><ul><li><strong>模糊查询</strong>：   <ul><li>关键字： like  </li><li>%表示任意多个字符</li><li>_表示任意一个字符<br>例子：<em>查询姓黄的学生</em></li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where name like &apos;黄%&apos;;</span><br></pre></td></tr></table></figure><p>例子：<em>查询黄（两个字）的学生</em></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where name like &apos;黄_&apos;;</span><br></pre></td></tr></table></figure><p>例子：<em>查询名字中间有财的的学生</em>  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where name like &apos;%财%&apos;;</span><br></pre></td></tr></table></figure><ul><li><strong>范围查询</strong>  </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from students where id in (1,3,8);</span><br><span class="line">select * from students where id between 3 and 8;</span><br></pre></td></tr></table></figure><ul><li><strong>空判断</strong>  </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from students where birthday is null;</span><br><span class="line">select * from students where birthday is not null;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL的基本语法及在python中的实现</title>
      <link href="/2019/03/02/MySQL%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E5%8F%8A%E5%9C%A8python%E4%B8%AD%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
      <url>/2019/03/02/MySQL%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E5%8F%8A%E5%9C%A8python%E4%B8%AD%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<p>本文的主要目的是：  </p><ol><li>通过一个例子全方位了解mysql的基础以及深度使用语法   <blockquote><p> 建立一个students表格,查询等操作<br>和scores,subject关联，聚合操作</p></blockquote></li><li>python和mysql的交互操作 <blockquote><p>和students表格交互</p></blockquote></li><li>更高效的python-mysql语法  <blockquote><p>代码封装<br>用户登录系统</p></blockquote></li></ol><p>使用到的包为：  </p><blockquote><p>mysql, pymysql, hashlib  </p></blockquote><h1 id="1-MySQL语法"><a href="#1-MySQL语法" class="headerlink" title="1. MySQL语法"></a>1. MySQL语法</h1><h2 id="1-1-创建students数据库"><a href="#1-1-创建students数据库" class="headerlink" title="1.1. 创建students数据库"></a>1.1. 创建students数据库</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root  -p  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看有多少数据库</span></span><br><span class="line">show databases;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建数据库</span></span><br><span class="line">create database practice charset=<span class="string">'utf8'</span>;   </span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除数据库</span></span><br><span class="line"><span class="comment"># drop database practice</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用数据库</span></span><br><span class="line">use practice;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建table</span></span><br><span class="line">create table students(</span><br><span class="line">    id int primary key auto_increment <span class="keyword">not</span> null,</span><br><span class="line">    name varchar(<span class="number">10</span>),</span><br><span class="line">    birthday datetime,</span><br><span class="line">    gender bit default <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据库下所有的table</span></span><br><span class="line">show tables;</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 修改table</span></span><br><span class="line">alter table students add isDelete bit default <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除表格</span></span><br><span class="line"><span class="comment"># drop table practice</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看table的结构</span></span><br><span class="line">desc table;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看创建table的语句</span></span><br><span class="line">show create table students;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| python3            |</span><br><span class="line">| sakila             |</span><br><span class="line">| sys                |</span><br><span class="line">| world              |</span><br><span class="line">+--------------------+</span><br><span class="line"></span><br><span class="line">+----------+-------------+------+-----+---------+----------------+</span><br><span class="line">| Field    | Type        | Null | Key | Default | Extra          |</span><br><span class="line">+----------+-------------+------+-----+---------+----------------+</span><br><span class="line">| id       | int(11)     | NO   | PRI | NULL    | auto_increment |</span><br><span class="line">| name     | varchar(10) | YES  |     | NULL    |                |</span><br><span class="line">| birthday | datetime    | YES  |     | NULL    |                |</span><br><span class="line">| gender   | bit(1)      | YES  |     | b&apos;1&apos;    |                |</span><br><span class="line">| isDelete | bit(1)      | YES  |     | b&apos;0&apos;    |                |</span><br><span class="line">+----------+-------------+------+-----+---------+----------------+</span><br><span class="line"></span><br><span class="line">+--------------------+</span><br><span class="line">| Tables_in_practice |</span><br><span class="line">+--------------------+</span><br><span class="line">| students           |</span><br><span class="line">+--------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"> students | CREATE TABLE `students` (</span><br><span class="line">  `id` int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `name` varchar(10) DEFAULT NULL,</span><br><span class="line">  `birthday` datetime DEFAULT NULL,</span><br><span class="line">  `gender` bit(1) DEFAULT b&apos;1&apos;,</span><br><span class="line">  `isDelete` bit(1) DEFAULT b&apos;0&apos;,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci</span><br></pre></td></tr></table></figure><h2 id="1-2-MySQL数据操作"><a href="#1-2-MySQL数据操作" class="headerlink" title="1.2. MySQL数据操作"></a>1.2. MySQL数据操作</h2><h3 id="增加数据"><a href="#增加数据" class="headerlink" title="增加数据"></a>增加数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法 1： 直接插入</span></span><br><span class="line">insert into students values(<span class="number">1</span>,<span class="string">'hao'</span>,<span class="string">'1995-10-10'</span>,<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">insert into students values(<span class="number">2</span>,<span class="string">'li'</span>,<span class="string">'2001-9-8'</span>,<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">insert into students values(<span class="number">3</span>,<span class="string">'wang'</span>,<span class="string">'2015-2-15'</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法2： 选择列 + 多数据同时插入</span></span><br><span class="line">insert into students(name) values(<span class="string">'meng'</span>),(<span class="string">'bei'</span>);</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> students;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+----+------+---------------------+--------+----------+</span><br><span class="line">| id | name | birthday            | gender | isDelete |</span><br><span class="line">+----+------+---------------------+--------+----------+</span><br><span class="line">|  1 | hao  | 1995-10-10 00:00:00 |       |          |</span><br><span class="line">|  2 | li   | 2001-09-08 00:00:00 |       |          |</span><br><span class="line">|  3 | wang | 2015-02-15 00:00:00 |        |          |</span><br><span class="line">|  4 | meng | NULL                |       |          |</span><br><span class="line">|  5 | bei  | NULL                |       |          |</span><br><span class="line">+----+------+---------------------+--------+----------+</span><br></pre></td></tr></table></figure><h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">delete from students where name = &quot;meng&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">+----+------+---------------------+--------+----------+</span><br><span class="line">| id | name | birthday            | gender | isDelete |</span><br><span class="line">+----+------+---------------------+--------+----------+</span><br><span class="line">|  1 | hao  | 1995-10-10 00:00:00 |       |          |</span><br><span class="line">|  2 | li   | 2001-09-08 00:00:00 |       |          |</span><br><span class="line">|  3 | wang | 2015-02-15 00:00:00 |        |          |</span><br><span class="line">|  5 | bei  | NULL                |       |          |</span><br><span class="line">+----+------+---------------------+--------+----------+</span><br></pre></td></tr></table></figure><h3 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h3><p>这部分单独拿出来讲  </p><h2 id="1-3-MySQL查询操作"><a href="#1-3-MySQL查询操作" class="headerlink" title="1.3. MySQL查询操作"></a>1.3. MySQL查询操作</h2><h3 id="1-条件查询where"><a href="#1-条件查询where" class="headerlink" title="1.条件查询where"></a>1.条件查询where</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * <span class="keyword">from</span> 表名 wehre conditions;</span><br></pre></td></tr></table></figure><p><strong><font color="red">condition的写法</font></strong></p><ul><li><strong>比较运算符</strong>： <code>=, &gt;, &lt;, &gt;=,&lt;=, !=</code></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where id&gt;3;</span><br></pre></td></tr></table></figure><ul><li><strong>逻辑运算符</strong>： <code>and, or, not</code></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where id&gt;3 and gender=0;</span><br></pre></td></tr></table></figure><ul><li><strong>模糊查询</strong>：<ul><li>关键字： like</li><li>%表示任意多个字符</li><li>_表示任意一个字符<br>例子：<em>查询姓黄的学生</em></li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where name like &apos;黄%&apos;;</span><br></pre></td></tr></table></figure><p>例子：<em>查询黄（两个字）的学生</em></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where name like &apos;黄_&apos;;</span><br></pre></td></tr></table></figure><p>例子：<em>查询名字中间有财的的学生</em></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where name like &apos;%财%&apos;;</span><br></pre></td></tr></table></figure><ul><li><strong>范围查询</strong></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from students where id in (1,3,8);</span><br><span class="line">select * from students where id between 3 and 8;</span><br></pre></td></tr></table></figure><ul><li><strong>空判断</strong></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from students where birthday is null;</span><br><span class="line">select * from students where birthday is not null;</span><br></pre></td></tr></table></figure><h3 id="2-聚合"><a href="#2-聚合" class="headerlink" title="2. 聚合"></a>2. 聚合</h3><p><strong>为了快速得到统计数据，提供了5个聚合函数</strong>  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select count(*) <span class="keyword">from</span> students;                 <span class="comment"># 统计有多少行</span></span><br><span class="line">select max(id) <span class="keyword">from</span> students where gender=<span class="number">0</span>;   <span class="comment"># 求最大值</span></span><br><span class="line">select min(id) <span class="keyword">from</span> students where gender=<span class="number">0</span>;   <span class="comment"># 求最大值</span></span><br><span class="line">select sum(id) <span class="keyword">from</span> students where gender=<span class="number">0</span>;   <span class="comment"># 求和</span></span><br><span class="line">select avg(id) <span class="keyword">from</span> students where gender=<span class="number">0</span>;   <span class="comment"># 求最大值</span></span><br></pre></td></tr></table></figure><h3 id="3-分组groupby"><a href="#3-分组groupby" class="headerlink" title="3.分组groupby"></a>3.分组groupby</h3><ul><li>按照字段分组，表示此字段相同的数据会被放到一个组中（为了更好的统计数据）</li><li>分组后，只能查询相同的数据列，有差异的数据列无法显示在结果列中 </li><li>语法是  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 列1，列2，聚合... from 表名 group by 列1， 列2，列3...</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select gender ,count(*) <span class="keyword">from</span> stundets group by gender;  <span class="comment"># 查询男女生总数  </span></span><br><span class="line"></span><br><span class="line">+--------+----------+</span><br><span class="line">| gender | count(*) |</span><br><span class="line">+--------+----------+</span><br><span class="line">|       |        <span class="number">3</span> |</span><br><span class="line">|        |        <span class="number">1</span> |</span><br><span class="line">+--------+----------+</span><br></pre></td></tr></table></figure><h4 id="分组后筛选"><a href="#分组后筛选" class="headerlink" title="分组后筛选"></a>分组后筛选</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 列1，列2，聚合... from 表名 group by 列1， 列2，列3... having 列1...聚合....</span><br></pre></td></tr></table></figure><p>分组病筛选例子  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select gender ,count(*) from stundets group by gender having gender=0;</span><br><span class="line">select gender ,count(*) as rs from stundets group by gender having rs&gt;2;  # rs为一个count()的标记名</span><br></pre></td></tr></table></figure><ul><li>where是对from后面指定的表进行数据筛选，属于原始数据的筛选</li><li>having是对group by的结果进行筛选</li></ul><h3 id="4-排序"><a href="#4-排序" class="headerlink" title="4.排序"></a>4.排序</h3><ul><li>asec升序排， desc降序排  </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from 表名 order by 列1 asc |desc, 列2 asc |desc,...</span><br></pre></td></tr></table></figure><p>排序例子<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where isdelete=0 and gender=1 order by id desc;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+----+------+---------------------+--------+----------+</span><br><span class="line">| id | name | birthday            | gender | isDelete |</span><br><span class="line">+----+------+---------------------+--------+----------+</span><br><span class="line">|  5 | bei  | NULL                |       |          |</span><br><span class="line">|  2 | li   | 2001-09-08 00:00:00 |       |          |</span><br><span class="line">|  1 | hao  | 1995-10-10 00:00:00 |       |          |</span><br><span class="line">+----+------+---------------------+--------+----------+</span><br></pre></td></tr></table></figure><h3 id="5-分页-limit"><a href="#5-分页-limit" class="headerlink" title="5. 分页 limit"></a>5. 分页 limit</h3><ul><li>当数据量过大时，分页查看数据  </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from 表名 limit start, count  # 从start开始，获取count条数据</span><br></pre></td></tr></table></figure><p>已知：每个显示m条数据，当前是第n页(n=1,…)  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where isdelete=0 limit (n-1)*m, m</span><br></pre></td></tr></table></figure><h3 id="6-总结"><a href="#6-总结" class="headerlink" title="6. 总结"></a>6. 总结</h3><p>完整的查询语句  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select * <span class="keyword">from</span> table</span><br><span class="line">where ...</span><br><span class="line">group by ... having....</span><br><span class="line">orderby ....</span><br><span class="line">limit start, count</span><br></pre></td></tr></table></figure><h2 id="1-2-MySQL关系操作"><a href="#1-2-MySQL关系操作" class="headerlink" title="1.2. MySQL关系操作"></a>1.2. MySQL关系操作</h2><h3 id="1-关系分析"><a href="#1-关系分析" class="headerlink" title="1. 关系分析"></a>1. 关系分析</h3><p><strong>分析</strong>  </p><p><img src="https://www.cnblogs.com/images/cnblogs_com/haochen273/1389248/o_1.png" alt></p><ul><li>分析： 一个成绩对应有多个科目，在成绩中创建外键引用</li></ul><p>创建表的语句  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table scores(</span><br><span class="line">   -&gt; id int primary key auto_increment not null,</span><br><span class="line">   -&gt; stuid int,</span><br><span class="line">   -&gt; subid int,</span><br><span class="line">   -&gt; score decimal(4,1));</span><br></pre></td></tr></table></figure><h3 id="2-使用外键保证关系数据的有效性"><a href="#2-使用外键保证关系数据的有效性" class="headerlink" title="2. 使用外键保证关系数据的有效性"></a>2. 使用外键保证关系数据的有效性</h3><ul><li>必须是学生表中id列存在的数据，可以通过外键约束进行数据的有效性验证  </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 添加外键约束 </span><br><span class="line"></span><br><span class="line">alter table scores add constraint stu_sco foreign key(stuid) references student (id);</span><br><span class="line"></span><br><span class="line"># 或者直接在创建的时候添加约束  </span><br><span class="line"> create table scores(</span><br><span class="line">    id int primary key auto_increment not null,</span><br><span class="line">    stuid int,</span><br><span class="line">    subid int,</span><br><span class="line">    score decimal(4,1),</span><br><span class="line">    foreign key(stuid) references students (id),</span><br><span class="line">    foreign key(subid) references subjects (id));</span><br></pre></td></tr></table></figure><p><strong>只有stuid在students的id中才有效，同理subid</strong>   </p><h3 id="3-连接join"><a href="#3-连接join" class="headerlink" title="3. 连接join"></a>3. 连接join</h3><p>当我们查看scores表的时候呈现的结果是这样的  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from scores;</span><br><span class="line">+----+-------+-------+-------+</span><br><span class="line">| id | stuid | subid | score |</span><br><span class="line">+----+-------+-------+-------+</span><br><span class="line">|  1 |     1 |     1 | 100.0 |</span><br><span class="line">|  2 |     2 |     2 |  98.0 |</span><br><span class="line">|  3 |     2 |     1 |  96.0 |</span><br><span class="line">|  4 |     1 |     2 |  86.0 |</span><br><span class="line">+----+-------+-------+-------+</span><br></pre></td></tr></table></figure><p>但是这个表一点都不直观，我哪里知道stuid的1和2代表的谁啊？如果能够显示出人名就好啦，目标效果为  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    张山            数学            100</span><br><span class="line">students.name  subjects.title  scores.score</span><br></pre></td></tr></table></figure><p><strong>方法</strong>  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select students.name,subjects.title,scores.score </span><br><span class="line">from scores </span><br><span class="line">inner join students on stuid = students.id</span><br><span class="line">inner join subjects on scores.subid = subjects.id;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+------+---------+-------+</span><br><span class="line">| name | title   | score |</span><br><span class="line">+------+---------+-------+</span><br><span class="line">| hao  | math    | 100.0 |</span><br><span class="line">| hao  | math    |  96.0 |</span><br><span class="line">| hao  | english |  98.0 |</span><br><span class="line">| hao  | english |  86.0 |</span><br></pre></td></tr></table></figure><p><strong>结果来源于多张表的时候，使用连接查询</strong></p><h4 id="连接查询的种类"><a href="#连接查询的种类" class="headerlink" title="连接查询的种类"></a>连接查询的种类</h4><ul><li>inner join： 内连接，要求连接的表都匹配的才会出现  </li><li>left join：  左连接， 对应数据都有 + 左边表信息也会显示出现，内容为NULL</li><li>right join： 右连接，上同</li></ul><h3 id="4-自关联"><a href="#4-自关联" class="headerlink" title="4. 自关联"></a>4. 自关联</h3><p>设计一个省的表结构provinces  </p><ul><li>id</li><li>ptitle<br>设计一个市信息的表结构citys</li><li>id</li><li>ctitle</li><li>proid（城市所属的省-id）</li></ul><p><strong>问题</strong>： 每次新建一张表的开销大，而且储存的内容很少—： 有没有可能将这两个表统一成一张表呢？</p><p><strong>答案：自关联：</strong> 表中的某一列，关联了这个表的另外一列</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table areas(</span><br><span class="line">  id int primary key,</span><br><span class="line">  atitle varchar(20),</span><br><span class="line">  pid int,</span><br><span class="line">  foreign key(pid) references areas(id)</span><br><span class="line">  );</span><br></pre></td></tr></table></figure><p>导入外部sql文件  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source area.sql;</span><br></pre></td></tr></table></figure><p>查询一共有多少省  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(*) from areas where pid is null</span><br></pre></td></tr></table></figure><p>查询省的名称为“山西省”的所有城市  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select city.* from areas as city</span><br><span class="line">inner join areas as province on city.pid=province.aid</span><br><span class="line">where province.atitle=&quot;山西省&quot;;</span><br></pre></td></tr></table></figure><p>查询市的名称为“广东市”的所有区县  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select dis.* from aras as dis</span><br><span class="line">inner join areas as city on city.aid = dis.prd</span><br><span class="line">where city.atitle = &quot;广州市&quot;;</span><br></pre></td></tr></table></figure><h3 id="5-视图"><a href="#5-视图" class="headerlink" title="5. 视图"></a>5. 视图</h3><ul><li>对于复杂的查询，多次使用时，维护很麻烦 </li><li>解决：定义视图——来代表复杂的查询  </li><li>视图本身是对查询的一个封装</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 创建view</span><br><span class="line">create view myview as</span><br><span class="line"></span><br><span class="line">select * from scores</span><br><span class="line">inner join students on scores.stuid = students.id</span><br><span class="line">inner join subjects.on scores.subid = subjects.id;</span><br><span class="line"></span><br><span class="line"># 使用视图</span><br><span class="line">select * from myview;</span><br></pre></td></tr></table></figure><h3 id="6-事务-git版本回退功能"><a href="#6-事务-git版本回退功能" class="headerlink" title="6. 事务:git版本回退功能"></a>6. 事务:git版本回退功能</h3><ul><li>当一个业务逻辑需要多个sql完成时，如果其中某条sql语句出错，希望整个操作都退回  </li><li>使用事务可以完成退回的功能，保证业务逻辑的正确性  </li><li><p>事务的四大特征（ACID）:</p><ul><li>原子性(Atomicity): 事务的全部操作在数据库中时不可分割的，要么全部完成，要么不执行</li><li>一致性(Consisitency)： 几个并行执行的事务，其执行结果必须与按照某一顺序串行执行的结果一致</li><li>隔离线(Isolation)： 事务的执行不受其他事务的干扰，事务执行的中间结果对其他事务必须是透明的</li><li>持久性(Durability)： 对于任意已经提交的事务，系统必须保证该事务对数据库的改变不被丢弃  </li></ul></li><li><p>要求：表的类型必须是innodb或者bdb类型才能使用事务  </p></li><li>使用情况：当数据被更改时，insert, alter等</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 查看表的创建语句</span><br><span class="line">show create table students;</span><br><span class="line"># 修改表的类型</span><br><span class="line">alter table 表名 engine=innodb;</span><br><span class="line"># 事务语句</span><br><span class="line"></span><br><span class="line">开启begin；</span><br><span class="line">提交commit；</span><br><span class="line">回滚rollback；</span><br></pre></td></tr></table></figure><p>例子：  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">begin;  # 开启数据</span><br><span class="line">update students set name = &apos;option&apos; where id=1;  # 修改数据</span><br><span class="line">commit;  # 提交修改</span><br><span class="line"></span><br><span class="line">rollback;  # 修改被放弃了</span><br></pre></td></tr></table></figure><h1 id="2-Python和MySQL的交互"><a href="#2-Python和MySQL的交互" class="headerlink" title="2. Python和MySQL的交互"></a>2. Python和MySQL的交互</h1><p>安装mysql for python </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install PyMySQL</span><br></pre></td></tr></table></figure><h2 id="2-1-基本用法"><a href="#2-1-基本用法" class="headerlink" title="2.1 基本用法"></a>2.1 基本用法</h2><h3 id="1-Connector对象"><a href="#1-Connector对象" class="headerlink" title="1. Connector对象"></a>1. Connector对象</h3><ul><li>用于建立与数据库的连接  </li><li>创建对象：调用connect()方法  </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conn = connect(host主机, port端口, db数据库名称, user用户, password密码, charset)</span><br></pre></td></tr></table></figure><ul><li>对象的方法有  <ul><li>close()关闭</li><li>commit()提交事务</li><li>rollback()撤销操作</li><li>cursor()返回Cursor对象，用于执行sql语句并且获得结果  </li></ul></li></ul><h3 id="2-Cursor对象"><a href="#2-Cursor对象" class="headerlink" title="2. Cursor对象"></a>2. Cursor对象</h3><ul><li>执行sql语句  </li><li>创建对象： 调用Connection对象的cursor()方法  </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curxor1 = conn.cursor()</span><br></pre></td></tr></table></figure><ul><li><p><strong>对象方法</strong>  </p><ul><li>close()： 关闭</li><li>execute(operation [, paramters])： 执行语句，返回受影响的行数</li><li>fetchone()： 执行查询语句时，获取查询结果集的第一行数据，返回一个元组</li><li>next()： 执行查询语句时，获取当前行的下一行</li><li>fetchall()： 执行查询时，获取结果期的所有行，一行构成一个元组</li><li>scroll(value, [mode]) 将行指针移动到某个位置<ul><li>mode：移动的方式</li><li>mode：默认为relative，表示基于当前行移动到value，value为正则向下移动</li><li>mode的值Wieabsolute，表示基于第一条数据的位置(0)  </li></ul></li></ul></li><li><p><strong>对象的属性</strong>  </p><ul><li>rowcount：只读属性，表示最近一次exectute()返回的行数  </li><li>connection: 获取当前的连接对象</li></ul></li></ul><h2 id="2-2-增改删查"><a href="#2-2-增改删查" class="headerlink" title="2.2 增改删查"></a>2.2 增改删查</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> pymysql <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># 通过connect连接mysql数据库</span></span><br><span class="line">    conn = connect(host=<span class="string">'localhost'</span>,port=<span class="number">3306</span>,database=<span class="string">'python3'</span>,</span><br><span class="line">                   user=<span class="string">'root'</span>,password=<span class="string">'720678'</span>,charset=<span class="string">'utf8'</span>)</span><br><span class="line">    <span class="comment"># 获得Cursor对象</span></span><br><span class="line">    cursor1 = conn.cursor()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 增加数据</span></span><br><span class="line">    cursor1.execute(<span class="string">'insert into students(name) values("飞机")'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 更新数据</span></span><br><span class="line">    cursor1.execute(<span class="string">'update students set name="大炮" where name = "a1"'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 删除数据</span></span><br><span class="line">    cursor1.execute(<span class="string">'delete from students where id = 10'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 提交之前的操作，如果之前已经之执行过多次的execute，那么就都进行提交</span></span><br><span class="line">    conn.commit()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关闭Cursor对象</span></span><br><span class="line">    cursor1.close()</span><br><span class="line">    <span class="comment"># 关闭Connection对象</span></span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"MySQL operation works. Congrad..."</span>)</span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"Wrong!!!!"</span>)</span><br></pre></td></tr></table></figure><p><strong>下面来看看怎么查看数据</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">    conn = connect(host=<span class="string">'localhost'</span>,port=<span class="number">3306</span>,database=<span class="string">'python3'</span>,</span><br><span class="line">                   user=<span class="string">'root'</span>,password=<span class="string">'720678'</span>,charset=<span class="string">'utf8'</span>)</span><br><span class="line"></span><br><span class="line">    cursor1 = conn.cursor()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 查询数据</span></span><br><span class="line">    count = cursor1.execute(<span class="string">'select id, name from students where id&gt;=5'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打印受影响的行数</span></span><br><span class="line">    print(<span class="string">"查询到%d条数据:"</span> % count)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(count):</span><br><span class="line">        <span class="comment"># 获取查询的结果</span></span><br><span class="line">        result = cursor1.fetchone()</span><br><span class="line">        <span class="comment"># 打印查询的结果</span></span><br><span class="line">        print(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    conn.commit()</span><br><span class="line">    cursor1.close()</span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"MySQL operation works. Congrad..."</span>)</span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"Wrong!!!!"</span>)</span><br></pre></td></tr></table></figure><h2 id="2-3-参数化"><a href="#2-3-参数化" class="headerlink" title="2.3. 参数化"></a>2.3. 参数化</h2><ul><li>执行数据库中的内置函数，通过调用参数来查询  </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sname = input(<span class="string">"请输入学生姓名："</span>)</span><br><span class="line">params = [sname]</span><br><span class="line"></span><br><span class="line">count = cursor1.execute(<span class="string">'insert into students(name) values(%s)'</span>, params)</span><br></pre></td></tr></table></figure><h2 id="2-4-封装"><a href="#2-4-封装" class="headerlink" title="2.4. 封装"></a>2.4. 封装</h2><p>上述代码一看 就有重复性，我们可以将它封装到一个类中，实际应用中我们只关注他的sql语句的书写  </p><h2 id="4-4-封装"><a href="#4-4-封装" class="headerlink" title="(4.4) 封装"></a>(4.4) 封装</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySQLHelper</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,host,port,db,user,passwd,charset = <span class="string">'utf8'</span>)</span>:</span></span><br><span class="line">        self.host = host</span><br><span class="line">        self.port = port</span><br><span class="line">        self.database = db</span><br><span class="line">        self.user = user</span><br><span class="line">        self.password = passwd</span><br><span class="line">        self.charset = charset</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">connect</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.conn = pymysql.connect(host = self.host, port = self.port, user = self.user,</span><br><span class="line">                                    password = self.password, database = self.database, charset = self.charset)</span><br><span class="line">        self.cursor = self.conn.cursor()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.cursor.close()</span><br><span class="line">        self.conn.close()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cud</span><span class="params">(self, sql, params)</span>:</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.connect()</span><br><span class="line"></span><br><span class="line">            self.cursor.execute(sql, params)</span><br><span class="line">            self.conn.commit()</span><br><span class="line"></span><br><span class="line">            self.close()</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            print(<span class="string">"Wrong"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">all</span><span class="params">(self, sql, params)</span>:</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.connect()</span><br><span class="line">            self.cursor.execute(sql, params)</span><br><span class="line">            res = self.cursor.fetchall()</span><br><span class="line"></span><br><span class="line">            self.close()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            print(<span class="string">"Wrong"</span>)</span><br></pre></td></tr></table></figure><p>使用：  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> MySQL.MySQLHelper <span class="keyword">import</span> MySQLHelper</span><br><span class="line"></span><br><span class="line">name = input(<span class="string">"请输入学生姓名"</span>)</span><br><span class="line">nub = input(<span class="string">"请输入学生编号"</span>)</span><br><span class="line"></span><br><span class="line">sql = <span class="string">'update students set name = %s where id = %s'</span></span><br><span class="line">params = [name, nub]</span><br><span class="line"></span><br><span class="line">sqlhelper = MySQLHelper(<span class="string">'localhost'</span>, <span class="number">3306</span>, <span class="string">'python3'</span>, <span class="string">'root'</span>, <span class="string">'720678'</span>)</span><br><span class="line"></span><br><span class="line">sqlhelper.cud(sql,params)</span><br></pre></td></tr></table></figure><h1 id="3-实例：实现用户登录功能"><a href="#3-实例：实现用户登录功能" class="headerlink" title="3. 实例：实现用户登录功能"></a>3. 实例：实现用户登录功能</h1><ul><li>接收用户输入： 用户名 + 密码  </li><li>根据用户名，查询密码  <ul><li>未查到： <em>用户名错误</em>  </li><li>查到： 匹配密码  <ul><li>匹配失败： <em>错误</em>  </li><li>匹配成功： <em>登录成功</em></li></ul></li></ul></li></ul><h3 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h3><ol><li>表的结构： id, uname, upwd, isdelete   </li><li>需要对密码加密：  <ul><li>md5加密：密码包含32个字符  </li><li>sha1加密： 密码包含40个字符 </li></ul></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">create table users(</span><br><span class="line">  id int primary key auto_increment,</span><br><span class="line">  name varchar(10), </span><br><span class="line">  password char(40)</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">insert into users values(1,&apos;hao&apos;,&apos;1d2b703d7a1f59d7d04c1850a2e308810b49b851&apos;);  # 密码是123</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+----+------+------------------------------------------+</span><br><span class="line">| id | name | password                                 |</span><br><span class="line">+----+------+------------------------------------------+</span><br><span class="line">|  1 | hao  | 40bd001563085fc35165329ea1ff5c5ecbdbbeef |</span><br><span class="line">+----+------+------------------------------------------+</span><br></pre></td></tr></table></figure><h3 id="写登录模块"><a href="#写登录模块" class="headerlink" title="写登录模块"></a>写登录模块</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> MySQL.MySQLHelper <span class="keyword">import</span> MySQLHelper</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"></span><br><span class="line">name = input(<span class="string">"请输入用户名： "</span>)</span><br><span class="line">pwd = input(<span class="string">"请输入密码： "</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对密码加密</span></span><br><span class="line">s1 = sha1()</span><br><span class="line">s1.update(pwd.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">pwd2 = s1.hexdigest()</span><br><span class="line"></span><br><span class="line">sql = <span class="string">'select password from users where name = %s'</span></span><br><span class="line">helper = MySQLHelper(<span class="string">'localhost'</span>, <span class="number">3306</span>, <span class="string">'python3'</span>, <span class="string">'root'</span>, <span class="string">'720678'</span>)</span><br><span class="line">result = helper.all(sql, [name])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(result) == <span class="number">0</span>:</span><br><span class="line">    print(<span class="string">"用户名出错"</span>)</span><br><span class="line"><span class="keyword">elif</span> result[<span class="number">0</span>][<span class="number">0</span>] == pwd2:</span><br><span class="line">    print(<span class="string">"登录成功"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"密码错误"</span>)</span><br></pre></td></tr></table></figure><p>测试  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">请输入用户名： hao</span><br><span class="line">请输入密码： <span class="number">123</span></span><br><span class="line">登录成功</span><br></pre></td></tr></table></figure><h1 id="4-MySQL常用语法"><a href="#4-MySQL常用语法" class="headerlink" title="4. MySQL常用语法"></a>4. MySQL常用语法</h1><h2 id="4-1-创建数据库"><a href="#4-1-创建数据库" class="headerlink" title="4.1.创建数据库"></a>4.1.创建数据库</h2><table><thead><tr><th style="text-align:left">语法</th><th style="text-align:left">用法说明</th></tr></thead><tbody><tr><td style="text-align:left">create database 数据库名字 charset=utf8;</td><td style="text-align:left">创建数据库</td></tr><tr><td style="text-align:left">drop database 数据库名字;</td><td style="text-align:left">删除数据库</td></tr><tr><td style="text-align:left">use 数据库名字;</td><td style="text-align:left">使用这个数据库</td></tr><tr><td style="text-align:left">show databases;</td><td style="text-align:left">查看当前的所有数据库</td></tr><tr><td style="text-align:left">select database();</td><td style="text-align:left">查看当前正在用的是哪个数据库</td></tr></tbody></table><h2 id="4-2-创建数据库下面的表"><a href="#4-2-创建数据库下面的表" class="headerlink" title="4.2.创建数据库下面的表"></a>4.2.创建数据库下面的表</h2><table><thead><tr><th style="text-align:left">语法</th><th style="text-align:left">用法说明</th></tr></thead><tbody><tr><td style="text-align:left">show tables;</td><td style="text-align:left">查看所有的表</td></tr><tr><td style="text-align:left">create table 表名(列和其类型);</td><td style="text-align:left">创建表</td></tr><tr><td style="text-align:left">desc 表名;</td><td style="text-align:left">查看表的结构</td></tr><tr><td style="text-align:left">`alter table 表名 add</td><td style="text-align:left">change</td><td>drop 列名 类型；`</td><td>修改表(增加，修改，删除列)</td></tr><tr><td style="text-align:left">drop table 表名;</td><td style="text-align:left">删除表</td></tr><tr><td style="text-align:left">rename table 原表名 to 新表名;</td><td style="text-align:left">更改表的名字</td></tr><tr><td style="text-align:left">show create table 表名;</td><td style="text-align:left">查看表的创建语句</td></tr></tbody></table><h2 id="4-3-表格中的数据操作"><a href="#4-3-表格中的数据操作" class="headerlink" title="4.3.表格中的数据操作"></a>4.3.表格中的数据操作</h2><table><thead><tr><th style="text-align:left">语法</th><th style="text-align:left">用法说明</th></tr></thead><tbody><tr><td style="text-align:left">select * from  表名;</td><td style="text-align:left">查询数据</td></tr><tr><td style="text-align:left">insert into 表名 values(…);</td><td style="text-align:left">添加数据（顺序要与表格一致）:全列插入</td></tr><tr><td style="text-align:left">insert into 表名(列1，..，) values(…);</td><td style="text-align:left">添加数据（顺序要与表格一致）:指定列插入</td></tr><tr><td style="text-align:left">insert into 表名 values(),()…;</td><td style="text-align:left">添加数据：一次性插入多条数据</td></tr><tr><td style="text-align:left">update 表名 set 列1=值1,… where 条件;</td><td style="text-align:left">修改数据</td></tr><tr><td style="text-align:left">delete from 表名 where 条件;</td><td style="text-align:left">删除数据</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MongoDB语法大全</title>
      <link href="/2019/03/02/MongoDB%E8%AF%AD%E6%B3%95%E5%A4%A7%E5%85%A8/"/>
      <url>/2019/03/02/MongoDB%E8%AF%AD%E6%B3%95%E5%A4%A7%E5%85%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="1-MongoDB简介"><a href="#1-MongoDB简介" class="headerlink" title="1.MongoDB简介"></a>1.MongoDB简介</h1><h2 id="1-1-MongoDB特点"><a href="#1-1-MongoDB特点" class="headerlink" title="1.1.MongoDB特点"></a>1.1.MongoDB特点</h2><ul><li>模式自由：可以将不同格式的文档存在同一个数据库中</li><li>面向集合的储存： 适合储存JSON风格文件的形式</li><li>完整的索引支持：对任何书写可索引</li><li>复制和高可用性： 支持服务器之间的数据复制，支持主-从模式及服务器之间的相互复制</li><li>自动分片： 支持云级别的伸缩性：自动分片功能支持水平的数据库集群，可动态添加额外的机器</li><li>丰富的查询： 支持丰富的查询表达方式</li><li>快速就地更新：查询优化器会分析查询表达式，并生成一个搞笑的额查询计划</li><li>搞笑的传统储存方法，支持二进制数据及大型对象，比如图片</li></ul><h2 id="1-2-MongoDB与MySQL的区别"><a href="#1-2-MongoDB与MySQL的区别" class="headerlink" title="1.2.MongoDB与MySQL的区别"></a>1.2.MongoDB与MySQL的区别</h2><table><thead><tr><th>MySQL术语</th><th>MongoDB术语</th><th>说明</th></tr></thead><tbody><tr><td>database</td><td>database</td><td>数据库</td></tr><tr><td>table</td><td>collection</td><td>数据库表/集合</td></tr><tr><td>row</td><td>document</td><td>数据记录行/文档</td></tr><tr><td>column</td><td>field</td><td>数据字段/域</td></tr><tr><td>index</td><td>index</td><td>索引</td></tr><tr><td>table joins</td><td></td><td>表连接，MongoDB不支持</td></tr><tr><td>primary key</td><td>primary key</td><td>主见</td></tr></tbody></table><h2 id="1-3-MongoDB三元素"><a href="#1-3-MongoDB三元素" class="headerlink" title="1.3.MongoDB三元素"></a>1.3.MongoDB三元素</h2><ul><li>数据库</li></ul><p>一个集合的物理容器，一个数据库中科院包含多个文档</p><ul><li>文档： 就是SQL的行</li></ul><p>一个对象，由键值对组成，是json的扩展</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&apos;name&apos;:&apos;guojing&apos;, &apos;gender&apos;:&apos;男&apos;&#125;</span><br></pre></td></tr></table></figure><ul><li>集合：就是SQL中的表</li></ul><p>类似SQL中的表，储存多个文档，结构不固定：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&apos;name&apos;:&apos;guojing&apos;, &apos;gender&apos;:&apos;男&apos;&#125;</span><br><span class="line">&#123;&apos;name&apos;:&apos;hua&apos;, &apos;age&apos;:20&#125;</span><br><span class="line">&#123;&apos;name&apos;:&apos;shxhx&apos;, &apos;hero&apos;:&apos;1998&apos;&#125;</span><br></pre></td></tr></table></figure><h2 id="1-4-window中启动mongodb的服务"><a href="#1-4-window中启动mongodb的服务" class="headerlink" title="1.4. window中启动mongodb的服务"></a>1.4. window中启动mongodb的服务</h2><ol><li>首先在官网下载安装好数据库</li><li>将MongoDB添加到 环境变量<ul><li>找到MongoDB的bin文件夹：<code>C:\Program Files\MongoDB\Server\4.0\bin</code></li><li>打开<code>计算机-属性-高级系统设置-环境变量-系统变量-path-编辑-粘贴上面的bin地址</code></li></ul></li><li>在CMD中输入<code>mongo</code>就可以进入服务了</li></ol><h1 id="2-数据库的语法"><a href="#2-数据库的语法" class="headerlink" title="2. 数据库的语法"></a>2. 数据库的语法</h1><h2 id="2-1-数据库语法"><a href="#2-1-数据库语法" class="headerlink" title="2.1. 数据库语法"></a>2.1. 数据库语法</h2><table><thead><tr><th>代码</th><th>说明</th></tr></thead><tbody><tr><td>db</td><td>查看当前数据库</td></tr><tr><td>show dbs</td><td>查看所有数据库</td></tr><tr><td>use 数据库名字</td><td>使用数据库(没有的话自动创建)</td></tr><tr><td>db.dropDatabase()</td><td>删除当前数据库</td></tr></tbody></table><h2 id="2-1-集合语法"><a href="#2-1-集合语法" class="headerlink" title="2.1. 集合语法"></a>2.1. 集合语法</h2><table><thead><tr><th>代码</th><th>说明</th></tr></thead><tbody><tr><td>db.createCollection(集合名字，其他选项)</td><td>创建集合</td></tr><tr><td>show collections</td><td>查看当前数据库的集合</td></tr><tr><td>db.集合名字.drop()</td><td>删除一个集合</td></tr></tbody></table><h2 id="2-2-支持的数据类型"><a href="#2-2-支持的数据类型" class="headerlink" title="2.2. 支持的数据类型"></a>2.2. 支持的数据类型</h2><table><thead><tr><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>ObjectID</td><td>文档ID：保证文档的唯一性</td></tr><tr><td>String</td><td>字符串</td></tr><tr><td>Boolean</td><td>布尔</td></tr><tr><td>Integer</td><td>整数</td></tr><tr><td>Double</td><td>浮点</td></tr><tr><td>Arrays</td><td>数组和列表</td></tr><tr><td>Object</td><td>嵌入式文档</td></tr><tr><td>NULL</td><td>存NULL值</td></tr><tr><td>Timestamp</td><td>时间戳</td></tr><tr><td>Date</td><td>存当前时间</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># capped是否设置集合大小的上限</span></span><br><span class="line">db.createCollection(<span class="string">"sub"</span>, &#123;capped: true, size :<span class="number">10</span>&#125;)  <span class="comment"># capped：true 如果db的容量大于10的话，就会覆盖</span></span><br></pre></td></tr></table></figure><h1 id="3-数据库的实际操作"><a href="#3-数据库的实际操作" class="headerlink" title="3. 数据库的实际操作"></a>3. 数据库的实际操作</h1><h2 id="3-1-增修删"><a href="#3-1-增修删" class="headerlink" title="3.1. 增修删"></a>3.1. 增修删</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 插入</span></span><br><span class="line"></span><br><span class="line">db.集合名称.insert(document)</span><br><span class="line"></span><br><span class="line">db.mask.insert(&#123;<span class="string">'name'</span>:<span class="string">'g'</span>, gender:<span class="number">1</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改</span></span><br><span class="line">db.集合名称.update(</span><br><span class="line">  &lt;query&gt;,   <span class="comment"># 查询条件，类型where</span></span><br><span class="line">  &lt;update&gt;, <span class="comment"># 更新操作费，类型set</span></span><br><span class="line">  &#123;multi:&lt;boolean&gt;&#125;  <span class="comment"># false：只更新找到的第一条记录,true:修改多行</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">db.mask.update(&#123;name:<span class="string">'hr'</span>&#125;,&#123;name: <span class="string">'ceo'</span>&#125;)          <span class="comment"># 这个会修改整个文档结构，最后用set，只修改值</span></span><br><span class="line">db.mask.update(&#123;&#125;,&#123;$set:&#123;gender:<span class="number">0</span>&#125;&#125;,&#123;multi:true&#125;)  <span class="comment"># 修改多个数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除</span></span><br><span class="line">db.集合名称.remove(</span><br><span class="line">  &lt;query&gt;,</span><br><span class="line">  &#123;</span><br><span class="line">    justOne:&lt;Boolean&gt;   <span class="comment"># TRUE：只删除一条，false：删除多条</span></span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">db.mask.remove(&#123;gender:<span class="number">0</span>&#125;,&#123;justOne:true&#125;)   <span class="comment"># 只删除匹配的第一条</span></span><br><span class="line">db.mask.remove(&#123;&#125;)    <span class="comment"># 删除所有</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 简单查询</span></span><br><span class="line">db.mask.find()</span><br><span class="line"><span class="comment"># &#123; "_id" : ObjectId("5c6e7e90394099d27b230266"), "name" : "g", "gender" : 1 &#125;</span></span><br></pre></td></tr></table></figure><h2 id="3-2-查询操作"><a href="#3-2-查询操作" class="headerlink" title="3.2. 查询操作"></a>3.2. 查询操作</h2><h3 id="1-基本查询"><a href="#1-基本查询" class="headerlink" title="1.基本查询"></a>1.基本查询</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基础查询</span></span><br><span class="line">db.集合名称.find(&#123;条件文档&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询只返回一个数据</span></span><br><span class="line">db.集合名称.findOne():</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询结果格式化</span></span><br><span class="line">db.集合名称.find(&#123;条件文档&#125;).pretty()</span><br></pre></td></tr></table></figure><h4 id="1）-比较运算符"><a href="#1）-比较运算符" class="headerlink" title="1） 比较运算符"></a>1） 比较运算符</h4><ul><li>等于，直接用属性 + <code>:</code></li><li>小于：$lt</li><li>小于等于:$lte</li><li>大于: $gt</li><li>大于等于: $gte</li><li>不等于: ne</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.mask.find(&#123;count:&#123;$gt:<span class="number">5</span>&#125;&#125;)  <span class="comment"># count大于5的结果</span></span><br></pre></td></tr></table></figure><h4 id="2）逻辑运算符"><a href="#2）逻辑运算符" class="headerlink" title="2）逻辑运算符"></a>2）逻辑运算符</h4><ul><li>and： 不需要写什么，逗号就是了</li><li>or：使用$or</li><li>and和or结合使用</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.mask.find(&#123;age:&#123;$gte:<span class="number">18</span>&#125;, gender:<span class="number">1</span>&#125;)</span><br><span class="line">db.mask.find(&#123;$<span class="keyword">or</span>:[&#123;age:&#123;$gte:<span class="number">18</span>&#125;,gender:<span class="number">1</span>&#125;]&#125;)</span><br><span class="line">db.mask.find(&#123;$<span class="keyword">or</span>:[&#123;age:&#123;$gte:<span class="number">18</span>&#125;,gender:<span class="number">1</span>&#125;],name:<span class="string">'gj'</span>&#125;)</span><br></pre></td></tr></table></figure><h4 id="3）范围运算符"><a href="#3）范围运算符" class="headerlink" title="3）范围运算符"></a>3）范围运算符</h4><ul><li>使用<code>$in,$nin</code>判断是否在某个范围内</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.mask.find(&#123;age:&#123;$<span class="keyword">in</span>:[<span class="number">18</span>,<span class="number">28</span>]&#125;&#125;)  <span class="comment"># 年龄为18和28的学生</span></span><br></pre></td></tr></table></figure><h4 id="4）支持正则表达式"><a href="#4）支持正则表达式" class="headerlink" title="4）支持正则表达式"></a>4）支持正则表达式</h4><ul><li>使用//或者$regex编写正则表达式</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.mask.find(&#123;name:&#123;$regex:<span class="string">'^黄'</span>&#125;&#125;)  <span class="comment"># 查询姓黄的学生</span></span><br></pre></td></tr></table></figure><h3 id="2-自定义函数查询"><a href="#2-自定义函数查询" class="headerlink" title="2. 自定义函数查询"></a>2. 自定义函数查询</h3><ul><li>使用$where定义函数查询</li><li>函数跟JS函数定义是一样的</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.mask.find($where:function()&#123;<span class="keyword">return</span> this.age&gt;<span class="number">20</span>&#125;)</span><br></pre></td></tr></table></figure><h3 id="3-查询的扩展功能"><a href="#3-查询的扩展功能" class="headerlink" title="3.查询的扩展功能"></a>3.查询的扩展功能</h3><h4 id="1）Limit-Skip"><a href="#1）Limit-Skip" class="headerlink" title="1）Limit + Skip"></a>1）Limit + Skip</h4><ul><li>limit：用于读取指定数量的文档，表示获取几条数据</li><li>skip: 跳过指定数量的文档，从第几条开始看</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.mask.find().limit(<span class="number">2</span>)   <span class="comment"># 只查询两条信息</span></span><br><span class="line">db.mask.find().skip(<span class="number">2</span>)    <span class="comment"># 查询从第三条开始的信息</span></span><br></pre></td></tr></table></figure><h4 id="2）投影"><a href="#2）投影" class="headerlink" title="2）投影"></a>2）投影</h4><ul><li>在查询返回的结果中，只选择必要的字段，而不是选择一个文档的整个字段—-投影</li><li>在find的第二个参数中去写</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.集合名称.find(&#123;&#125;,&#123;字段名称:<span class="number">1</span>,...&#125;)  <span class="comment"># 需要显示的字段，设置为1</span></span><br><span class="line"></span><br><span class="line">db.mask.find(&#123;&#125;,&#123;_id:<span class="number">0</span>, name:<span class="number">1</span>,gender:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure><h4 id="3）排序"><a href="#3）排序" class="headerlink" title="3）排序"></a>3）排序</h4><ul><li>sort方法</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.mask.find().sort(&#123;age:<span class="number">-1</span>&#125;)  <span class="comment"># 1为升序，-1为降序</span></span><br></pre></td></tr></table></figure><h4 id="3）统计个数"><a href="#3）统计个数" class="headerlink" title="3）统计个数"></a>3）统计个数</h4><ul><li>count()方法</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.集合名称.count(&#123;条件&#125;)</span><br><span class="line"></span><br><span class="line">db.mask.count(&#123;age:&#123;gt:<span class="number">20</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><h4 id="3）消除重复"><a href="#3）消除重复" class="headerlink" title="3）消除重复"></a>3）消除重复</h4><ul><li>distinct() 去重复</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.集合名称.distinct(<span class="string">'去重字段'</span>，&#123;条件&#125;)</span><br><span class="line"></span><br><span class="line">db.mask.distinct(gender,&#123;age:&#123;$gt:<span class="number">20</span>&#125;&#125;)  <span class="comment"># age大于20的进行消除重复</span></span><br></pre></td></tr></table></figure><h1 id="4-MongoDB的高级操作"><a href="#4-MongoDB的高级操作" class="headerlink" title="4.MongoDB的高级操作"></a>4.MongoDB的高级操作</h1><p>主要讲解这个数据库的高级操作，包括聚合、主从复制、分片、备份和恢复、MR、与python的交互</p><h2 id="4-1-聚合aggregate"><a href="#4-1-聚合aggregate" class="headerlink" title="4.1. 聚合aggregate"></a>4.1. 聚合aggregate</h2><ul><li>用于计算数据，类型sum()和avg（）</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.集合名称.aggregate([&#123;管道:&#123;表达式&#125;&#125;])</span><br></pre></td></tr></table></figure><ol><li><strong>管道的含义：</strong> 将前一次操作的输出结果作为下一个命令的输入</li></ol><ul><li>常用管道有：<ul><li>$group:将集合中的文档分组，用于统计结果</li><li>$match:过滤数据，只输出符合条件的文档</li><li>$project:修改输入文档的结果</li><li>$sort:将输入文档排序后输出</li><li>$limit:限制聚合管道返回的文档数</li><li>$skip:跳过指定数量的文档</li><li>$unwind:将数组类型的字段进行拆分</li></ul></li></ul><ol start="2"><li><strong>表达式：</strong> 处理输入文档并输出</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">表达式：<span class="string">'$列名'</span></span><br></pre></td></tr></table></figure><ul><li><p>常用表达式为：</p><ul><li>$sum: 计算总数</li><li>$avg:</li><li>$min:</li><li>$max:</li><li>$push:在结果文档中插入值到另外一个数组中</li><li>$first:根据资源文档的排序获取第一个文档数据</li><li>$last:根据资源文档的排序获取最后一个文档数据<h3 id="4-1-1-group"><a href="#4-1-1-group" class="headerlink" title="4.1.1. $group"></a>4.1.1. $group</h3></li></ul></li><li><p>将集合中的文档分组，用于统计结果  </p></li><li>_id表示分组的依据，使用某个字段的格式为’$字段’  </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 统计男生，女生的总人数</span></span><br><span class="line">db.mask.aggregate([</span><br><span class="line">   &#123;$group:&#123;_id:<span class="string">'$gender'</span>,counter:&#123;$sum:<span class="number">1</span>&#125;&#125;&#125;</span><br><span class="line">   &#123;$group:&#123;_id:<span class="string">'$gender'</span>,counter:&#123;$avg:<span class="string">'age'</span>&#125;&#125;&#125;  <span class="comment"># gender分组，对age求和</span></span><br><span class="line">   &#123;$group:&#123;_id:<span class="string">'$gender'</span>,counter:&#123;$frist:<span class="string">'age'</span>&#125;&#125;&#125;  <span class="comment"># 拿到第一个值</span></span><br><span class="line">   <span class="comment"># push--透视数据</span></span><br><span class="line">   &#123;$group:&#123;_id:<span class="string">'$gender'</span>,counter:&#123;$push:<span class="string">'age'</span>&#125;&#125;&#125;   <span class="comment"># 将基于gender的分组结果放到数组中</span></span><br><span class="line">    &#123;$group:&#123;_id:<span class="string">'$gender'</span>,counter:&#123;$push:<span class="string">'$$ROOT'</span>&#125;&#125;&#125;  <span class="comment"># 查看文档所有内容(gender分组情况下)</span></span><br><span class="line">   ])</span><br></pre></td></tr></table></figure><p><strong>Group by null</strong> 将这个集合数据分成一组  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.mask.aggregate(</span><br><span class="line">  &#123;$group:&#123;_id:null,counter:&#123;$sum:<span class="number">1</span>&#125;&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="4-1-2-match"><a href="#4-1-2-match" class="headerlink" title="4.1.2. $match"></a>4.1.2. $match</h3><ul><li>用于过滤数据  </li></ul><h3 id="4-1-3-project"><a href="#4-1-3-project" class="headerlink" title="4.1.3.$project"></a>4.1.3.$project</h3><ul><li>将结果集中的一部分拿出来显示</li></ul><h3 id="4-1-4-sort"><a href="#4-1-4-sort" class="headerlink" title="4.1.4. $sort"></a>4.1.4. $sort</h3><ul><li>用于排序</li></ul><h3 id="4-1-5-limit-skip"><a href="#4-1-5-limit-skip" class="headerlink" title="4.1.5. $limit+skip"></a>4.1.5. $limit+skip</h3><h3 id="4-1-6-unwind"><a href="#4-1-6-unwind" class="headerlink" title="4.1.6. $unwind"></a>4.1.6. $unwind</h3><ul><li>将文档中的某个数组类型字段拆分成多条，每条包含数组中的一个值  </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.集合名称.aggregate([&#123;$unwind:<span class="string">'$字段名称'</span>&#125;])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">db.mask.aggregate([]</span><br><span class="line">  <span class="comment"># 管道1：过滤数据</span></span><br><span class="line">  &#123;$match:&#123;age:&#123;$gt:<span class="number">20</span>&#125;&#125;&#125;,  <span class="comment"># 查询大于20的信息</span></span><br><span class="line">  <span class="comment"># 管道2：分组数据</span></span><br><span class="line">  &#123;$group:&#123;_id:<span class="string">'$gender'</span>,counter:&#123;$sum:<span class="number">1</span>&#125;&#125;&#125;,</span><br><span class="line">  <span class="comment"># 管道3：设置显示哪些数据</span></span><br><span class="line">  &#123;$project:&#123;_id:<span class="number">0</span>,name:<span class="number">1</span>,age:<span class="number">1</span>&#125;&#125;,</span><br><span class="line">  <span class="comment"># 管道4：数据排序</span></span><br><span class="line">  &#123;$sort:&#123;_id:<span class="number">1</span>&#125;&#125;,</span><br><span class="line">  <span class="comment"># 管道5： 跳过多少数据</span></span><br><span class="line">  &#123;$skip:<span class="number">1</span>&#125;,</span><br><span class="line">  &#123;$limit:<span class="number">1</span>&#125;,</span><br><span class="line">])</span><br></pre></td></tr></table></figure><h2 id="4-2-索引"><a href="#4-2-索引" class="headerlink" title="4.2. 索引"></a>4.2. 索引</h2><ul><li>在大量数据中快速查找  </li></ul><p><strong>步骤一：创造大量数据</strong>  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">100000</span>,i++)&#123;</span><br><span class="line">  db.mask.insert(name:<span class="string">'test'</span> + i, age:i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>步骤二：数据查找性能分析</strong>  </p><ul><li>查找姓名为<code>test10000</code>的文档,并通过explain()来进行性能分析  </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.mask.find(&#123;name:<span class="string">'test10000'</span>&#125;).explain(<span class="string">'executionStats'</span>)  <span class="comment"># 整体查询时间，96毫秒</span></span><br></pre></td></tr></table></figure><p><strong>步骤三：创建索引</strong>  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.集合.ensureIndex(&#123;属性:<span class="number">1</span>&#125;)  <span class="comment"># 1表示升序  </span></span><br><span class="line"></span><br><span class="line">db.mask.ensureIndex(&#123;<span class="string">"name"</span>:<span class="number">1</span>&#125;)</span><br><span class="line">db.mask.find(&#123;name:<span class="string">'test10000'</span>&#125;).explain(<span class="string">'executionStats'</span>)  <span class="comment"># 2毫秒</span></span><br></pre></td></tr></table></figure><p><strong>索引命令</strong> </p><ul><li>建立单一索引  </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.mask.ensureIndex(&#123;<span class="string">"name"</span>:<span class="number">1</span>&#125;,&#123;<span class="string">"unique"</span>: true&#125;)</span><br></pre></td></tr></table></figure><ul><li>建立多个索引   </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.mask.ensureIndex(&#123;<span class="string">"name"</span>:<span class="number">1</span>，<span class="string">"age"</span>:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure><ul><li><p>查看所有索引  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.mask.getIndexes()</span><br><span class="line"></span><br><span class="line">db.mask.dropIndexes(‘索引名称’)  <span class="comment"># 删除</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="4-3-安全-超级管理员和普通用户创建"><a href="#4-3-安全-超级管理员和普通用户创建" class="headerlink" title="4.3. 安全:超级管理员和普通用户创建"></a>4.3. 安全:超级管理员和普通用户创建</h2><ol><li><strong>创建超级管理员</strong>  </li></ol><p>为了更安全的访问MongoDB，需要访问者提供用户名和密码，所以我们需要在mongodb中创建用户，mongoDB采用了角色-用户-数据库的安全管理方式，每个用户被分配了一个角色，不同角色有不同的管理权限，常用角色为如下：  </p><ul><li>root: 只在admin数据库中可用，超级管理员</li><li>read：读</li><li>readwrite：读写</li></ul><p>下面我们来创建超级管理员：  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use admin</span><br><span class="line">ad.createUser(&#123;</span><br><span class="line">  user:<span class="string">'admin'</span>,</span><br><span class="line">  pwd:<span class="string">'123'</span></span><br><span class="line">  roles:[&#123;role:<span class="string">'root'</span>,db:<span class="string">'admin'</span>&#125;]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="2"><li><strong>修改配置文件，启用身份验证</strong>  </li></ol><p>修改配置文件<code>C:\Program Files\MongoDB\Server\4.0\bin\mongod.cfg</code>  </p><p>查找<code>security</code>字段并重写为：  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">security:</span><br><span class="line">    authorization: enabled</span><br></pre></td></tr></table></figure><ol start="3"><li><strong>重启服务</strong>  </li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongo restart # 重启服务</span><br></pre></td></tr></table></figure><ol start="4"><li><strong>使用超级管理员登录</strong>  </li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongo -u admin -p <span class="number">123</span> --authenticationDatabase admin</span><br></pre></td></tr></table></figure><p>里面有以下列表  </p><ul><li>system.Users:通过db.system.Users.find()查看所有的user信息</li><li>system.version</li></ul><ol start="5"><li><strong>为普通用户创建一个数据库</strong>  </li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use test1</span><br></pre></td></tr></table></figure><ol start="6"><li><strong>创建普通用户</strong>  </li></ol><p>从超级管理员那里创建一个普通用户账户(无法访问超级数据库)  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">db.createUser(&#123;</span><br><span class="line">  user:<span class="string">'t1'</span>,</span><br><span class="line">  pwd:<span class="string">'123'</span>,</span><br><span class="line">  roles:[&#123;role:<span class="string">'readWrite'</span>, db:<span class="string">'test1'</span>&#125;]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="7"><li><strong>使用普通用户登录</strong></li></ol><p>为普通用户授权test1的数据库权限</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongo -u t1 -p <span class="number">123</span> -authenticationDatabase test1</span><br></pre></td></tr></table></figure><h2 id="4-4-数据备份和恢复"><a href="#4-4-数据备份和恢复" class="headerlink" title="4.4. 数据备份和恢复"></a>4.4. 数据备份和恢复</h2><h3 id="4-1-MongoDB复制"><a href="#4-1-MongoDB复制" class="headerlink" title="4.1. MongoDB复制"></a>4.1. MongoDB复制</h3><p><strong>复制的工作原理</strong>  </p><ul><li>复制至少需要两个节点A，B…  </li><li>A是主节点，负责处理客户端请求  </li><li>其余的是从节点，负责复制主节点上的数据 </li><li>节点的常见搭配方式是：一主一从、一主多从  </li><li>主节点记录在其上的操作，从节点定期轮询主机诶单获取这些操作，然后对自己的数据副本执行这些操作，从而保证从节点的数据与主节点一致  </li><li>主节点与丛节点进行数据交互保障数据的一致性  </li></ul><p><strong>复制的特点</strong>  </p><ul><li>N个节点的集群  </li><li>任何节点可作为主节点  </li><li>所有写入操作都在主节点  </li><li>自动故障转移  </li><li>自动恢复  </li></ul>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MongoDb </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MongoDB和Python的交互</title>
      <link href="/2019/03/02/MongoDB%E5%92%8CPython%E7%9A%84%E4%BA%A4%E4%BA%92/"/>
      <url>/2019/03/02/MongoDB%E5%92%8CPython%E7%9A%84%E4%BA%A4%E4%BA%92/</url>
      
        <content type="html"><![CDATA[<p>安装pymongo包  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pymongo</span><br></pre></td></tr></table></figure><h1 id="1-MongoDB和Python交互"><a href="#1-MongoDB和Python交互" class="headerlink" title="1.MongoDB和Python交互"></a>1.MongoDB和Python交互</h1><h2 id="1-1-连接mongoDB服务器-MongoClient"><a href="#1-1-连接mongoDB服务器-MongoClient" class="headerlink" title="1.1. 连接mongoDB服务器-MongoClient"></a>1.1. 连接mongoDB服务器-MongoClient</h2><ul><li>建立连接并创建客户端  </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 无安全验证 </span></span><br><span class="line">client = MongoClient(<span class="string">'mongodb://localhost:27017/database_name'</span>)</span><br><span class="line"><span class="comment"># 有安全验证</span></span><br><span class="line">client = MongoClient(<span class="string">'mongodb://user:pwd@localhost:27017/databse_name'</span>)</span><br></pre></td></tr></table></figure><ul><li>获取数据库-database  </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db = client.py</span><br></pre></td></tr></table></figure><ul><li>数据库的方法-类Collection  </li></ul><p>主要方法有：  </p><ul><li>insert_one</li><li>insert_many</li><li>update_one</li><li>update_many</li><li>delete_one</li><li>delete_many</li><li>find_one</li><li>find  </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取集合stu</span></span><br><span class="line">stu = db.stu</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加文档，返回文档id</span></span><br><span class="line">s1 = &#123;<span class="string">'name'</span>:<span class="string">'张三'</span>,<span class="string">'gender'</span>:<span class="literal">True</span>&#125;</span><br><span class="line">s1_id = stu.insert_one(s1).insert_id</span><br><span class="line">print(s1_id)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改文档</span></span><br><span class="line">stu.update_one(&#123;<span class="string">'name'</span>:<span class="string">'张三'</span>&#125;,&#123;<span class="string">'$set'</span>:&#123;<span class="string">'name'</span>:<span class="string">'张三的爸爸'</span>&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除文档 </span></span><br><span class="line">stu.delete_one(&#123;<span class="string">'name'</span>:<span class="string">'张三的爸爸'</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找一个文档，将文档转换为一个元组返回  </span></span><br><span class="line">s2 = stu.find_one(&#123;<span class="string">'name'</span>:<span class="string">'李四'</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询多个文档，返回一个Cursor类型对象，用于遍历返回元组形式的文档</span></span><br><span class="line">cursor = stu.find(&#123;<span class="string">'hometown'</span>:<span class="string">'重庆'</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 排序，返回Cursor类型对象 </span></span><br><span class="line">cursor = stu.find().sort(<span class="string">'age'</span>,DESCENDING)</span><br><span class="line">cursor = stu.find().sort([(<span class="string">'age'</span>,DESCENDING),<span class="string">'name'</span>,ASCENDING])</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MongoDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java的基础语法</title>
      <link href="/2019/03/02/Java%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/"/>
      <url>/2019/03/02/Java%E7%9A%84%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="1-基本概念"><a href="#1-基本概念" class="headerlink" title="1. 基本概念"></a>1. 基本概念</h1><h2 id="1-1-环境变量"><a href="#1-1-环境变量" class="headerlink" title="1.1. 环境变量"></a>1.1. 环境变量</h2><p>环境变量通常是指在操作系统(win10,win7)中，用来指定操作系统运行时需要的一些参数(比如一个国家需要人民，货币，货物…)，一般为一些<strong>键值对</strong></p><p><img src="https://img2018.cnblogs.com/blog/1575244/201901/1575244-20190114132755959-53807503.png" alt></p><h3 id="Path环境变量的作用-gt-寻找命令"><a href="#Path环境变量的作用-gt-寻找命令" class="headerlink" title="Path环境变量的作用-&gt;寻找命令"></a>Path环境变量的作用-&gt;寻找命令</h3><p>Path环境变量是操作系统外部命令搜索路径</p><p><img src="https://img2018.cnblogs.com/blog/1575244/201901/1575244-20190114132801853-1760222595.png" alt></p><h3 id="classpath变量的作用-gt-寻找类文件"><a href="#classpath变量的作用-gt-寻找类文件" class="headerlink" title="classpath变量的作用-&gt;寻找类文件"></a>classpath变量的作用-&gt;寻找类文件</h3><p><img src="https://img2018.cnblogs.com/blog/1575244/201901/1575244-20190114132807739-795377267.png" alt></p><h2 id="1-2-JDK里面有什么？"><a href="#1-2-JDK里面有什么？" class="headerlink" title="1.2. JDK里面有什么？"></a>1.2. JDK里面有什么？</h2><p><img src="https://img2018.cnblogs.com/blog/1575244/201901/1575244-20190114132813270-1731200656.png" alt></p><h2 id="1-3-什么是JRE？"><a href="#1-3-什么是JRE？" class="headerlink" title="1.3. 什么是JRE？"></a>1.3. 什么是JRE？</h2><p>JRE是JAVA运行的环境，包括以下几个部分：</p><ul><li>Java虚拟机： 它是由一个软件虚拟出来的计算机</li><li>Java平台核心类文件</li><li>其他支持文件</li></ul><p><img src="https://img2018.cnblogs.com/blog/1575244/201901/1575244-20190114132820156-1504528087.png" alt></p><h1 id="2-Java的基本语法"><a href="#2-Java的基本语法" class="headerlink" title="2.Java的基本语法"></a>2.Java的基本语法</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  这是一个注释</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassName</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    object.method(parameters)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>技巧：在IDEA中输入psvm会直接创建main函数</strong></p><h2 id="2-1-Java的数据类型"><a href="#2-1-Java的数据类型" class="headerlink" title="2.1 Java的数据类型"></a>2.1 Java的数据类型</h2><p>java是一种强类型语言，这就意味着必须为每个变量声明一种类型  </p><ol><li>整型: int, short, long, byte  </li><li>浮点型: float, double</li><li>char类型: 用单引号</li><li>boolean类型</li></ol><h2 id="2-2-变量"><a href="#2-2-变量" class="headerlink" title="2.2. 变量"></a>2.2. 变量</h2><h3 id="2-2-1-变量的声明方法"><a href="#2-2-1-变量的声明方法" class="headerlink" title="2.2.1. 变量的声明方法"></a>2.2.1. 变量的声明方法</h3><p>声明变量的语法如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="keyword">var</span>=<span class="number">10</span>;</span><br></pre></td></tr></table></figure></p><h3 id="2-2-2-常量final"><a href="#2-2-2-常量final" class="headerlink" title="2.2.2. 常量final"></a>2.2.2. 常量final</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 类常量用static final定义</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">double</span> PRESEM = <span class="number">2.54</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">      <span class="comment">//基本常量用final定义</span></span><br><span class="line">      <span class="keyword">final</span> <span class="keyword">int</span> jbg = <span class="number">12</span>;</span><br><span class="line">      System.out.println(<span class="string">"Hello World!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-3-运算符"><a href="#2-3-运算符" class="headerlink" title="2.3. 运算符"></a>2.3. 运算符</h2><ul><li>数学运算符，<code>+,-,*,/</code></li><li>数学函数与常量: <code>Math.sqrt(),Math.pow(),Math.sin(),Math.tan(),Math.exp().Math.log(),Math.PI</code></li><li>强制类型转换  </li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> x =<span class="number">9.98</span>;</span><br><span class="line"><span class="keyword">int</span> nx = (<span class="keyword">int</span>) x;</span><br></pre></td></tr></table></figure><h2 id="2-4-字符串"><a href="#2-4-字符串" class="headerlink" title="2.4. 字符串"></a>2.4. 字符串</h2><p><strong>字符串是不可变字符串，无法直接修改</strong><br>但是我们可以修改字符串变量，让他引用另外一个字符串，达到修改的效果</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String greet = <span class="string">"Hello"</span>;</span><br><span class="line"><span class="comment">// 子串</span></span><br><span class="line">String s  = greet.substring(<span class="number">0</span>,<span class="number">3</span>);</span><br><span class="line"><span class="comment">// 拼接</span></span><br><span class="line">String msg = greet + <span class="string">"friends"</span>;</span><br><span class="line"><span class="comment">// 判断是否相等</span></span><br><span class="line">greet.equals(<span class="string">"help"</span>);</span><br><span class="line"><span class="comment">//判断空串和Null串</span></span><br><span class="line"><span class="keyword">if</span>(greet!= <span class="keyword">null</span> &amp;&amp; greet.lend()!=<span class="number">0</span>);</span><br></pre></td></tr></table></figure><h3 id="2-4-1-字符串构造器"><a href="#2-4-1-字符串构造器" class="headerlink" title="2.4.1. 字符串构造器"></a>2.4.1. 字符串构造器</h3><p>有时候我们需要一段一段的构造一个字符串，那么我们就可以通过一个字符串构建器来创造<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//构造字符串构建器</span></span><br><span class="line">StringBuilder builder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"><span class="comment">//添加字符串</span></span><br><span class="line">builder.append(ch);</span><br><span class="line">builder.append(ch2);</span><br><span class="line"><span class="comment">//转换成真正的字符串</span></span><br><span class="line">String finalString = builder.toString();</span><br></pre></td></tr></table></figure></p><h2 id="2-5-输入输出"><a href="#2-5-输入输出" class="headerlink" title="2.5. 输入输出"></a>2.5. 输入输出</h2><h3 id="2-5-1-键盘输入"><a href="#2-5-1-键盘输入" class="headerlink" title="2.5.1. 键盘输入"></a>2.5.1. 键盘输入</h3><p>读取输入流<code>System.in</code>需要以下两个步骤  </p><ol><li>创建<code>Scanner</code>对象，并关联<code>System.in</code></li><li>通过<code>Scanner</code>对象的<code>nextLine(),next(),nextInt()</code>方法读取数据  </li><li>最后通过<code>hasNext(),hasNextInt(),hasNextDouble()</code>判断是否读取完</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner in = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"What is your name?"</span>);</span><br><span class="line">        String name = in.nextLine();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"What is your age?"</span>);</span><br><span class="line">        <span class="keyword">int</span> age = in.nextInt();</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">"Hello, "</span> + name + <span class="string">". you age is "</span> + age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-5-2-格式化输出"><a href="#2-5-2-格式化输出" class="headerlink" title="2.5.2. 格式化输出"></a>2.5.2. 格式化输出</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.printf(<span class="string">"hello, %s, you age is %d"</span>, name,age)</span><br></pre></td></tr></table></figure><h3 id="2-5-3-文件输入和输出"><a href="#2-5-3-文件输入和输出" class="headerlink" title="2.5.3. 文件输入和输出"></a>2.5.3. 文件输入和输出</h3><p><strong>文件读取</strong></p><p>要想对文件进行读取，有以下几个步骤  </p><ol><li>用File对象构造一个Scanner对象</li><li>通过<code>Scanner</code>对象的<code>nextLine(),next(),nextInt()</code>方法读取数据</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Scanner in = <span class="keyword">new</span> Scanner(Path.get(<span class="string">"C:\\mydirectory\\myfile.txt"</span>), <span class="string">"UTF-8"</span>);</span><br><span class="line">String msg = in.nextLine();</span><br></pre></td></tr></table></figure><p><strong>文件写入</strong>  </p><p>PrinterWriter out = new PrinterWriter(“myfile.txt”, “UTF-8”)</p><h2 id="2-6-循环控制流程"><a href="#2-6-循环控制流程" class="headerlink" title="2.6. 循环控制流程"></a>2.6. 循环控制流程</h2><p><img src="https://img2018.cnblogs.com/blog/1575244/201901/1575244-20190114132902071-832476832.png" alt></p><h2 id="2-7-数组"><a href="#2-7-数组" class="headerlink" title="2.7. 数组"></a>2.7. 数组</h2><ul><li>数组是一种数据结构，用来储存同一类型值得集合，通过一个整型下标就可以访问数组中的每个值，如果a是一个整型数组，a[i]就是数组中下标为i的整数  </li><li><font color="red">数组是用来储存同一数据类型的集合</font></li></ul><p><strong>一旦创建，不可改变大小</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 创建数组，指定数组长度(不可更改),创建后，所有元素初始化为0，布尔为false， 对象数组为null</span></span><br><span class="line">        <span class="keyword">int</span>[] a = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">        <span class="comment">// 给数组赋值</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;a.length; i++)&#123;</span><br><span class="line">            a[i] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// foreach循环</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> element: a)&#123;</span><br><span class="line">            System.out.println(element);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 数组初始化(无需指定长度) </span></span><br><span class="line">        <span class="keyword">int</span>[] b = &#123;<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">12</span>&#125;;</span><br><span class="line">        <span class="comment">// 数组拷贝(指向内存同一个区域)</span></span><br><span class="line">        <span class="keyword">int</span>[] c = b;</span><br><span class="line">        <span class="keyword">int</span>[] c_hard_copy = Arrays.copyOf(b, b.length);</span><br><span class="line">        <span class="comment">// 数组排序</span></span><br><span class="line">        Arrays.sort(b);</span><br><span class="line">        <span class="comment">// 命令行参数 在main方法中的String[] args就是一个字符串数组，接收一系列命令行参数</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Django的基本用法教程-Part-I</title>
      <link href="/2019/03/02/Django%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95%E6%95%99%E7%A8%8B-Part-I/"/>
      <url>/2019/03/02/Django%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95%E6%95%99%E7%A8%8B-Part-I/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Django基础"><a href="#1-Django基础" class="headerlink" title="1. Django基础"></a>1. Django基础</h1><h2 id="1-1-Django简介"><a href="#1-1-Django简介" class="headerlink" title="1.1. Django简介"></a>1.1. Django简介</h2><h2 id="1-2-Django安装"><a href="#1-2-Django安装" class="headerlink" title="1.2. Django安装"></a>1.2. Django安装</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pip install Django</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> django</span><br><span class="line">print(django.get_version())  <span class="comment"># 2.1.7</span></span><br></pre></td></tr></table></figure><h2 id="1-3-创建Django项目"><a href="#1-3-创建Django项目" class="headerlink" title="1.3. 创建Django项目"></a>1.3. 创建Django项目</h2><p>在你希望创建django项目的文件夹下输入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">django-admin startproject mysite</span><br></pre></td></tr></table></figure></p><p>mysite项目下面有如下的文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysite/</span><br><span class="line">    manage.py            # 管理 Django 项目的命令行工具</span><br><span class="line">    mysite/</span><br><span class="line">        __init__.py      # 一个空文件，告诉 Python 这个目录应该被认为是一个 Python 包</span><br><span class="line">        settings.py      # Django 项目的配置文件</span><br><span class="line">        urls.py          # Django 项目的 URL 声明</span><br><span class="line">        wsgi.py          # 项目的运行在 WSGI 兼容的Web服务器上的入口</span><br></pre></td></tr></table></figure></p><p>在mysite文件夹内运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver  # 启动了一个自带的简易服务器</span><br></pre></td></tr></table></figure></p><p>现在，服务器正在运行，浏览器访问 <a href="https://127.0.0.1:8000/" target="_blank" rel="noopener">https://127.0.0.1:8000/</a>。你将会看到一个“祝贺”页面，随着一只火箭发射，服务器已经运行了。  </p><h2 id="1-4-创建一个应用"><a href="#1-4-创建一个应用" class="headerlink" title="1.4. 创建一个应用"></a>1.4. 创建一个应用</h2><p>你的应用可以存放在任何 Python path 中定义的路径。在这个教程中，我们将在你的 manage.py 同级目录下创建投票应用。这样它就可以作为顶级模块导入，而不是 mysite 的子模块。  </p><p>创建应用：  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp polls</span><br></pre></td></tr></table></figure><p>这将会创建一个 polls 目录，它的目录结构大致如下：  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">polls/</span><br><span class="line">    __init__.py</span><br><span class="line">    admin.py</span><br><span class="line">    apps.py</span><br><span class="line">    migrations/</span><br><span class="line">        __init__.py</span><br><span class="line">    models.py</span><br><span class="line">    tests.py</span><br><span class="line">    views.py</span><br></pre></td></tr></table></figure><h2 id="1-5-创建第一个视图"><a href="#1-5-创建第一个视图" class="headerlink" title="1.5. 创建第一个视图"></a>1.5. 创建第一个视图</h2><p>让我们开始编写第一个视图吧。打开 polls/views.py，把下面这些 Python 代码输入进去：  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">"Hello, world. You're at the polls index."</span>)</span><br></pre></td></tr></table></figure><p>这是 Django 中最简单的视图。如果想看见效果，我们需要将一个 URL 映射到它——这就是我们需要 URLconf 的原因了。<br>为了创建 URLconf，请在 polls 目录里新建一个 urls.py 文件。你的应用目录现在看起来应该是这样  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">polls/</span><br><span class="line">    __init__.py</span><br><span class="line">    admin.py</span><br><span class="line">    apps.py</span><br><span class="line">    migrations/</span><br><span class="line">        __init__.py</span><br><span class="line">    models.py</span><br><span class="line">    tests.py</span><br><span class="line">    urls.py</span><br><span class="line">    views.py</span><br></pre></td></tr></table></figure><p>在 polls/urls.py 中，输入如下代码：  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">''</span>, views.index, name=<span class="string">'index'</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>下一步是要在根 URLconf 文件中指定我们创建的 <code>polls.urls</code> 模块。在 <code>mysite/urls.py</code> 文件的 <code>urlpatterns</code> 列表里插入一个 <code>include()</code>， 如下：  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> include, path</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'polls/'</span>, include(<span class="string">'polls.urls'</span>)),</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>函数 <code>include()</code> 允许引用其它 <code>URLconfs</code>。每当 <code>Django</code> 遇到 <code>:func：~django.urls.include</code> 时，它会截断与此项匹配的 <code>URL</code> 的部分，并将剩余的字符串发送到<code>URLconf</code> 以供进一步处理   </p><p><strong>你现在把 index 视图添加进了 URLconf。可以验证是否正常工作</strong>  </p><p>用你的浏览器访问 <a href="http://localhost:8000/polls/" target="_blank" rel="noopener">http://localhost:8000/polls/</a>来检查</p><h3 id="函数path的使用"><a href="#函数path的使用" class="headerlink" title="函数path的使用"></a>函数path的使用</h3><p>函数 <code>path()</code> 具有四个参数，两个必须参数：<code>route</code>和 <code>view</code>，两个可选参数：<code>kwargs</code> 和 <code>name</code>。现在，是时候来研究这些参数的含义了。  </p><ul><li>route: route 是一个匹配 URL 的准则（类似正则表达式）。当 Django 响应一个请求时，它会从 urlpatterns 的第一项开始，按顺序依次匹配列表中的项，直到找到匹配的项  </li><li>view:当 Django 找到了一个匹配的准则，就会调用这个特定的视图函数，并传入一个 HttpRequest 对象作为第一个参数，被“捕获”的参数以关键字参数的形式传入。稍后，我们会给出一个例子。  </li><li>kwargs: 任意个关键字参数可以作为一个字典传递给目标视图函数。</li><li>name: 为你的 URL 取名能使你在 Django 的任意地方唯一地引用它</li></ul><h1 id="2-Django的数据库部分"><a href="#2-Django的数据库部分" class="headerlink" title="2. Django的数据库部分"></a>2. Django的数据库部分</h1><h2 id="2-1-数据库配置"><a href="#2-1-数据库配置" class="headerlink" title="2.1. 数据库配置"></a>2.1. 数据库配置</h2><p>现在，打开 mysite/settings.py 。这是个包含了 Django 项目设置的 Python 模块。通常默认SQLite数据库  </p><p>在数据库中创建表<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure></p><ul><li>这个 migrate 命令检查 INSTALLED_APPS 设置，为其中的每个应用创建需要的数据表，至于具体会创建什么，这取决于你的 mysite/settings.py 设置文件和每个应用的数据库迁移文件  </li><li>这个命令所执行的每个迁移操作都会在终端中显示出来  </li></ul><h2 id="2-2-创建模型"><a href="#2-2-创建模型" class="headerlink" title="2.2. 创建模型"></a>2.2. 创建模型</h2><p>定义模型 - 也就是数据库结构设计和附加的其它元数据。  </p><ul><li>在这个简单的投票应用中，需要创建两个模型：问题 Question 和选项 Choice。Question 模型包括问题描述和发布时间。Choice 模型有两个字段，选项描述和当前得票数。每个选项属于一个问题。  </li></ul><p>polls/models.py 文件 中编写如下代码  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your models here.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 每个模型被表示为 django.db.models.Model 类的子类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Question</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    <span class="comment"># 每个模型有一些类变量，它们都表示模型里的一个数据库字段。</span></span><br><span class="line">    <span class="comment"># 每个字段都是 Field 类的实例，告诉 Django 每个字段要处理的数据类型。</span></span><br><span class="line">    <span class="comment"># 字符字段被表示为 CharField</span></span><br><span class="line">    question_text = models.CharField(max_length=<span class="number">200</span>)</span><br><span class="line">    <span class="comment"># 日期时间字段被表示为 DateTimeField</span></span><br><span class="line">    pub_date = models.DateTimeField(<span class="string">'date published'</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.question_text</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Choice</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    <span class="comment"># 使用 ForeignKey 定义了一个关系。这将告诉 Django，每个 Choice 对象都关联到一个 Question 对象。</span></span><br><span class="line">    <span class="comment"># Django 支持所有常用的数据库关系：多对一、多对多和一对一。</span></span><br><span class="line">    question  = models.ForeignKey(Question, on_delete = models.CASCADE)</span><br><span class="line">    choice_text = models.CharField(max_length=<span class="number">200</span>)</span><br><span class="line">    votes = models.IntegerField(default=<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.choice_text</span><br></pre></td></tr></table></figure><h2 id="2-3-激活模型"><a href="#2-3-激活模型" class="headerlink" title="2.3. 激活模型"></a>2.3. 激活模型</h2><p>通过上述代码，djanao可以  </p><ul><li>为这个应用创建数据库 schema（生成 CREATE TABLE 语句）  </li><li>创建可以与 Question 和 Choice 对象进行交互的 Python 数据库 API  </li></ul><p><strong>但是首先得把 polls 应用安装到我们的项目里</strong>  </p><p>为了在我们的工程中包含这个应用，我们需要在配置类 INSTALLED_APPS 中添加设置。因为 PollsConfig 类写在文件 polls/apps.py 中，所以它的点式路径是 ‘polls.apps.PollsConfig’。在文件 mysite/settings.py 中 INSTALLED_APPS 子项添加点式路径后，它看起来像这样：  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    &apos;polls.apps.PollsConfig&apos;,</span><br><span class="line">    &apos;django.contrib.admin&apos;,</span><br><span class="line">    &apos;django.contrib.auth&apos;,</span><br><span class="line">    &apos;django.contrib.contenttypes&apos;,</span><br><span class="line">    &apos;django.contrib.sessions&apos;,</span><br><span class="line">    &apos;django.contrib.messages&apos;,</span><br><span class="line">    &apos;django.contrib.staticfiles&apos;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>然后为polls创建数据库  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations polls</span><br></pre></td></tr></table></figure><ul><li><p>通过运行 makemigrations 命令，Django 会检测你对模型文件的修改（在这种情况下，你已经取得了新的），并且把修改的部分储存为一次 迁移。</p></li><li><p>Django 有一个自动执行数据库迁移并同步管理你的数据库结构的命令 - 这个命令是 migrate，我们马上就会接触它 - 但是首先，让我们看看迁移命令会执行哪些 SQL 语句。sqlmigrate 命令接收一个迁移的名称，然后返回对应的 SQL：    </p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py sqlmigrate polls 0001</span><br></pre></td></tr></table></figure><p>输出：  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Create model Choice</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">"polls_choice"</span> (</span><br><span class="line">    <span class="string">"id"</span> <span class="built_in">serial</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    <span class="string">"choice_text"</span> <span class="built_in">varchar</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">"votes"</span> <span class="built_in">integer</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Create model Question</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">"polls_question"</span> (</span><br><span class="line">    <span class="string">"id"</span> <span class="built_in">serial</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    <span class="string">"question_text"</span> <span class="built_in">varchar</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">"pub_date"</span> <span class="built_in">timestamp</span> <span class="keyword">with</span> <span class="built_in">time</span> zone <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Add field question to choice</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">"polls_choice"</span> <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> <span class="string">"question_id"</span> <span class="built_in">integer</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">"polls_choice"</span> <span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> <span class="string">"question_id"</span> <span class="keyword">DROP</span> <span class="keyword">DEFAULT</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> <span class="string">"polls_choice_7aa0f6ee"</span> <span class="keyword">ON</span> <span class="string">"polls_choice"</span> (<span class="string">"question_id"</span>);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">"polls_choice"</span></span><br><span class="line">  <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> <span class="string">"polls_choice_question_id_246c99a640fbbd72_fk_polls_question_id"</span></span><br><span class="line">    <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (<span class="string">"question_id"</span>)</span><br><span class="line">    <span class="keyword">REFERENCES</span> <span class="string">"polls_question"</span> (<span class="string">"id"</span>)</span><br><span class="line">    DEFERRABLE <span class="keyword">INITIALLY</span> <span class="keyword">DEFERRED</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure><ul><li>数据库的表名是由应用名(polls)和模型名的小写形式( question 和 choice)连接而来</li><li>主键(IDs)会被自动创建</li><li>默认的，Django 会在外键字段名后追加字符串 “_id” 。</li><li>外键关系由 FOREIGN KEY 生成。你不用关心 DEFERRABLE 部分，它只是告诉 PostgreSQL，请在事务全都执行完之后再创建外键关系。</li><li>生成的 SQL 语句是为你所用的数据库定制的，所以那些和数据库有关的字段类型，比如 auto_increment (MySQL)、 serial (PostgreSQL)和 integer primary key autoincrement (SQLite)，Django 会帮你自动处理</li><li>这个 sqlmigrate 命令并没有真正在你的数据库中的执行迁移 - 它只是把命令输出到屏幕上，让你看看 Django 认为需要执行哪些 SQL 语句。</li></ul><p>现在，再次运行 migrate 命令，在数据库里创建新定义的模型的数据表：  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python manage.py migrate</span><br><span class="line"><span class="comment"># Operations to perform:</span></span><br><span class="line"><span class="comment">#   Apply all migrations: admin, auth, contenttypes, polls, sessions</span></span><br><span class="line"><span class="comment"># Running migrations:</span></span><br><span class="line"><span class="comment">#   Applying polls.0001_initial... OK</span></span><br></pre></td></tr></table></figure><ul><li>这个 migrate 命令选中所有还没有执行过的迁移（Django 通过在数据库中创建一个特殊的表 django_migrations 来跟踪执行过哪些迁移）并应用在数据库上 - 也就是将你对模型的更改同步到数据库结构上。  </li><li>迁移是非常强大的功能，它能让你在开发过程中持续的改变数据库结构而不需要重新删除和创建表 - 它专注于使数据库平滑升级而不会丢失数据。  </li><li>现在，你只需要记住，改变模型需要这三步：  <ul><li><ol><li>编辑 models.py 文件，改变模型。</li></ol></li><li><ol start="2"><li>运行 python manage.py makemigrations 为模型的改变生成迁移文件。</li></ol></li><li><ol start="3"><li>运行 python manage.py migrate 来应用数据库迁移。  </li></ol></li></ul></li></ul><h2 id="2-4-初试-API"><a href="#2-4-初试-API" class="headerlink" title="2.4. 初试 API"></a>2.4. 初试 API</h2><p>现在让我们进入交互式 Python 命令行，尝试一下 Django 为你创建的各种 API。通过以下命令打开 Python 命令行  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py shell</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> polls.models <span class="keyword">import</span> Choice, Question  <span class="comment"># Import the model classes we just wrote.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># No questions are in the system yet.</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Question.objects.all()</span><br><span class="line">&lt;QuerySet []&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a new Question.</span></span><br><span class="line"><span class="comment"># Support for time zones is enabled in the default settings file, so</span></span><br><span class="line"><span class="comment"># Django expects a datetime with tzinfo for pub_date. Use timezone.now()</span></span><br><span class="line"><span class="comment"># instead of datetime.datetime.now() and it will do the right thing.</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> django.utils <span class="keyword">import</span> timezone</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q = Question(question_text=<span class="string">"What's new?"</span>, pub_date=timezone.now())</span><br><span class="line"></span><br><span class="line"><span class="comment"># Save the object into the database. You have to call save() explicitly.</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.save()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Now it has an ID.</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.id</span><br><span class="line"><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Access model field values via Python attributes.</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.question_text</span><br><span class="line"><span class="string">"What's new?"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.pub_date</span><br><span class="line">datetime.datetime(<span class="number">2012</span>, <span class="number">2</span>, <span class="number">26</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">775217</span>, tzinfo=&lt;UTC&gt;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Change values by changing the attributes, then calling save().</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.question_text = <span class="string">"What's up?"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>q.save()</span><br><span class="line"></span><br><span class="line"><span class="comment"># objects.all() displays all the questions in the database.</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Question.objects.all()</span><br><span class="line">&lt;QuerySet [&lt;Question: Question object (<span class="number">1</span>)&gt;]&gt;</span><br></pre></td></tr></table></figure><h2 id="2-5-介绍Django的管理页面"><a href="#2-5-介绍Django的管理页面" class="headerlink" title="2.5. 介绍Django的管理页面"></a>2.5. 介绍Django的管理页面</h2><h3 id="创建一个管理员账号"><a href="#创建一个管理员账号" class="headerlink" title="创建一个管理员账号"></a>创建一个管理员账号</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py createsuperuser</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Username: admin</span><br><span class="line">Email address: admin@example.com</span><br><span class="line">Password: **********</span><br><span class="line">Password (again): *********</span><br><span class="line">Superuser created successfully.</span><br></pre></td></tr></table></figure><h3 id="启动开发服务器"><a href="#启动开发服务器" class="headerlink" title="启动开发服务器"></a>启动开发服务器</h3><p>Django 的管理界面默认就是启用的。让我们启动开发服务器，看看它到底是什么样的。  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver</span><br></pre></td></tr></table></figure><p>现在，打开浏览器，转到你本地域名的 “/admin/“ 目录， – 比如 “<a href="http://127.0.0.1:8000/admin/" target="_blank" rel="noopener">http://127.0.0.1:8000/admin/</a>“ 。你应该会看见管理员登录界面：  </p><p><img src="https://docs.djangoproject.com/zh-hans/2.1/_images/admin01.png" alt></p><h3 id="进入管理页面"><a href="#进入管理页面" class="headerlink" title="进入管理页面"></a>进入管理页面</h3><p>通过密码进入页面如下  </p><p><img src="https://docs.djangoproject.com/zh-hans/2.1/_images/admin02.png" alt>  </p><p>你将会看到几种可编辑的内容：组和用户。它们是由 django.contrib.auth 提供的，这是 Django 开发的认证框架  </p><h2 id="向管理页面加入投票应用"><a href="#向管理页面加入投票应用" class="headerlink" title="向管理页面加入投票应用"></a>向管理页面加入投票应用</h2><p>告诉管理页面，问题 Question 对象需要被管理。打开 polls/admin.py 文件，把它编辑成下面这样 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from django.contrib import admin</span><br><span class="line"></span><br><span class="line">from .models import Question</span><br><span class="line"></span><br><span class="line">admin.site.register(Question)</span><br></pre></td></tr></table></figure><h1 id="3-视图"><a href="#3-视图" class="headerlink" title="3. 视图"></a>3. 视图</h1><h2 id="3-1-什么是视图"><a href="#3-1-什么是视图" class="headerlink" title="3.1. 什么是视图"></a>3.1. 什么是视图</h2><p>视图的概念是「一类具有相同功能和模板的网页的集合」。比如，在一个博客应用中，你可能会创建如下几个视图  </p><ol><li>博客首页——展示最近的几项内容。</li><li>内容“详情”页——详细展示某项内容。</li><li>以年为单位的归档页——展示选中的年份里各个月份创建的内容</li><li>评论处理器——用于响应为一项内容添加评论的操作。  </li></ol><p>而在我们的投票应用中，我们需要下列几个视图  </p><ol><li>问题索引页——展示最近的几个投票问题</li><li>问题详情页——展示某个投票的问题和不带结果的选项列表。</li><li>问题结果页——展示某个投票的结果。</li><li>投票处理器——用于响应用户为某个问题的特定选项投票的操作。  </li></ol><p>在 Django 中，网页和其他内容都是从视图派生而来。每一个视图表现为一个简单的 Python 函数  </p><ul><li>一个 URL 模式定义了某种 URL 的基本格式——举个例子：<code>/newsarchive/&lt;year&gt;/&lt;month&gt;/</code>。  </li><li>为了将 URL 和视图关联起来，Django 使用了 ‘URLconfs’ 来配置。URLconf 将 URL 模式映射到视图。  </li></ul><h2 id="3-2-编写更多视图"><a href="#3-2-编写更多视图" class="headerlink" title="3.2. 编写更多视图"></a>3.2. 编写更多视图</h2><p>在让我们向 polls/views.py 里添加更多视图。这些视图有一些不同，因为他们接收参数：  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">detail</span><span class="params">(request, question_id)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">"You're looking at question %s."</span> % question_id)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">results</span><span class="params">(request, question_id)</span>:</span></span><br><span class="line">    response = <span class="string">"You're looking at the results of question %s."</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(response % question_id)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">vote</span><span class="params">(request, question_id)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">"You're voting on question %s."</span> % question_id)</span><br></pre></td></tr></table></figure><p>把这些新视图添加进 polls.urls 模块里，只要添加几个 url() 函数调用就行：  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    <span class="comment"># ex: /polls/</span></span><br><span class="line">    path(<span class="string">''</span>, views.index, name=<span class="string">'index'</span>),</span><br><span class="line">    <span class="comment"># ex: /polls/5/</span></span><br><span class="line">    path(<span class="string">'&lt;int:question_id&gt;/'</span>, views.detail, name=<span class="string">'detail'</span>),</span><br><span class="line">    <span class="comment"># ex: /polls/5/results/</span></span><br><span class="line">    path(<span class="string">'&lt;int:question_id&gt;/results/'</span>, views.results, name=<span class="string">'results'</span>),</span><br><span class="line">    <span class="comment"># ex: /polls/5/vote/</span></span><br><span class="line">    path(<span class="string">'&lt;int:question_id&gt;/vote/'</span>, views.vote, name=<span class="string">'vote'</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>然后看看你的浏览器，如果你转到 “/polls/34/“ ，Django 将会运行 detail() 方法并且展示你在 URL 里提供的问题 ID。再试试 “/polls/34/vote/“ 和 “/polls/34/vote/“ ——你将会看到暂时用于占位的结果和投票页。</p><p>当某人请求你网站的某一页面时——比如说， “/polls/34/“ ，Django 将会载入 mysite.urls 模块，因为这在配置项 ROOT_URLCONF 中设置了。然后 Django 寻找名为 urlpatterns 变量并且按序匹配正则表达式。在找到匹配项 ‘polls/‘，它切掉了匹配的文本（”polls/“），将剩余文本——“34/“，发送至 ‘polls.urls’ URLconf 做进一步处理。在这里剩余文本匹配了 ‘<a href="int:question_id" target="_blank" rel="noopener">int:question_id</a>/‘，使得我们 Django 以如下形式调用 detail():  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">detail(request=&lt;HttpRequest object&gt;, question_id=<span class="number">34</span>)</span><br></pre></td></tr></table></figure><h2 id="3-3-写一个真正的视图"><a href="#3-3-写一个真正的视图" class="headerlink" title="3.3. 写一个真正的视图"></a>3.3. 写一个真正的视图</h2><ul><li><p>每个视图必须的两个步骤  </p><ol><li>返回一个包含请求页面内容的HttpResponse对象  </li><li>抛出异常Http404  </li><li>其他你自己定义的操作  </li></ol></li><li><p>你的视图可以从数据库里读取记录，可以使用一个模板引擎（比如 Django 自带的，或者其他第三方的），可以生成一个 PDF 文件，可以输出一个 XML，创建一个 ZIP 文件，你可以做任何你想做的事，使用任何你想用的 Python 库。  </p></li></ul><p>首先，在你的 polls 目录里创建一个 templates 目录。Django 将会在这个目录里查找模板文件。</p><p>你项目的 TEMPLATES 配置项描述了 Django 如何载入和渲染模板。默认的设置文件设置了 DjangoTemplates 后端，并将 APP_DIRS 设置成了 True。这一选项将会让 DjangoTemplates 在每个 INSTALLED_APPS 文件夹中寻找 “templates” 子目录。这就是为什么尽管我们没有像在第二部分中那样修改 DIRS 设置，Django 也能正确找到 polls 的模板位置的原因。</p><p>在你刚刚创建的 templates 目录里，再创建一个目录 polls，然后在其中新建一个文件 index.html 。换句话说，你的模板文件的路径应该是 polls/templates/polls/index.html 。因为 Django 会寻找到对应的 app_directories ，所以你只需要使用 polls/index.html 就可以引用到这一模板了。  </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if latest_question_list %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    &#123;% for question in latest_question_list %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/polls/&#123;&#123; question.id &#125;&#125;/"</span>&gt;</span>&#123;&#123; question.question_text &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">&#123;% else %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>No polls are available.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>然后，让我们更新一下 polls/views.py 里的 index 视图来使用模板：  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Question</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></span><br><span class="line">    latest_question_list = Question.objects.order_by(<span class="string">'-pub_date'</span>)[:<span class="number">5</span>]</span><br><span class="line">    context = &#123;<span class="string">'latest_question_list'</span>: latest_question_list&#125;</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">'polls/index.html'</span>, context)</span><br></pre></td></tr></table></figure><p>用你的浏览器访问 “/polls/“ ，你将会看见一个无序列表  </p><h2 id="3-4-抛出404错误"><a href="#3-4-抛出404错误" class="headerlink" title="3.4. 抛出404错误"></a>3.4. 抛出404错误</h2><p>现在，我们来处理投票详情视图——它会显示指定投票的问题标题。下面是这个视图的代码：  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">detail</span><span class="params">(request, question_id)</span>:</span></span><br><span class="line">  <span class="comment"># 试用 get() 函数获取一个对象，如果不存在就抛出 Http404 </span></span><br><span class="line">    question = get_object_or_404(Question, pk=question_id)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">'polls/detail.html'</span>, &#123;<span class="string">'question'</span>: question&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Django </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android开发教程6-Shape和Selector结合用于自定义控件</title>
      <link href="/2019/03/02/Android%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B6-Shape%E5%92%8CSelector%E7%BB%93%E5%90%88%E7%94%A8%E4%BA%8E%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6/"/>
      <url>/2019/03/02/Android%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B6-Shape%E5%92%8CSelector%E7%BB%93%E5%90%88%E7%94%A8%E4%BA%8E%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Selector和hape的说明"><a href="#1-Selector和hape的说明" class="headerlink" title="1.Selector和hape的说明"></a>1.Selector和hape的说明</h1><ul><li>在Android开发中，使用shape可以很方便的帮我们画出想要的背景，相对于png图片来说，使用shape可以减少安装包的大小，而且能够更好的适配不同的手机。  </li><li>Selector（背景选择器）主要是用来改变一个按钮控件的背景  </li><li>一般使用如下格式自定义控件  </li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">selector</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Shape</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Shape</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">selector</span> &gt;</span></span><br></pre></td></tr></table></figure><h1 id="2-Shape的使用"><a href="#2-Shape的使用" class="headerlink" title="2. Shape的使用"></a>2. Shape的使用</h1><p>首先看官网的说明  </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">shape</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:shape</span>=<span class="string">[</span>"<span class="attr">rectangle</span>" | "<span class="attr">oval</span>" | "<span class="attr">line</span>" | "<span class="attr">ring</span>"]      //共有<span class="attr">4</span>种类型，矩形（默认）/椭圆形/直线形/环形</span></span><br><span class="line"><span class="tag">    // 以下<span class="attr">4</span>个属性只有当类型为环形时才有效</span></span><br><span class="line"><span class="tag">    <span class="attr">android:innerRadius</span>=<span class="string">"dimension"</span>     //内环半径</span></span><br><span class="line"><span class="tag">    <span class="attr">android:innerRadiusRatio</span>=<span class="string">"float"</span>    //内环半径相对于环的宽度的比例，比如环的宽度为<span class="attr">50</span>,比例为<span class="attr">2.5</span>,那么内环半径为<span class="attr">20</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:thickness</span>=<span class="string">"dimension"</span>   //环的厚度</span></span><br><span class="line"><span class="tag">    <span class="attr">android:thicknessRatio</span>=<span class="string">"float"</span>     //环的厚度相对于环的宽度的比例</span></span><br><span class="line"><span class="tag">    <span class="attr">android:useLevel</span>=<span class="string">"boolean"</span>&gt;</span>    //如果当做是LevelListDrawable使用时值为true，否则为false.</span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">corners</span>    //定义圆角</span></span><br><span class="line"><span class="tag">        <span class="attr">android:radius</span>=<span class="string">"dimension"</span>      //全部的圆角半径</span></span><br><span class="line"><span class="tag">        <span class="attr">android:topLeftRadius</span>=<span class="string">"dimension"</span>   //左上角的圆角半径</span></span><br><span class="line"><span class="tag">        <span class="attr">android:topRightRadius</span>=<span class="string">"dimension"</span>  //右上角的圆角半径</span></span><br><span class="line"><span class="tag">        <span class="attr">android:bottomLeftRadius</span>=<span class="string">"dimension"</span>    //左下角的圆角半径</span></span><br><span class="line"><span class="tag">        <span class="attr">android:bottomRightRadius</span>=<span class="string">"dimension"</span> /&gt;</span>    //右下角的圆角半径</span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">gradient</span>   //定义渐变效果</span></span><br><span class="line"><span class="tag">        <span class="attr">android:type</span>=<span class="string">[</span>"<span class="attr">linear</span>" | "<span class="attr">radial</span>" | "<span class="attr">sweep</span>"]    //共有<span class="attr">3</span>中渐变类型，线性渐变（默认）/放射渐变/扫描式渐变</span></span><br><span class="line"><span class="tag">        <span class="attr">android:angle</span>=<span class="string">"integer"</span>     //渐变角度，必须为<span class="attr">45</span>的倍数，<span class="attr">0</span>为从左到右，<span class="attr">90</span>为从上到下</span></span><br><span class="line"><span class="tag">        <span class="attr">android:centerX</span>=<span class="string">"float"</span>     //渐变中心<span class="attr">X</span>的相当位置，范围为<span class="attr">0</span>～<span class="attr">1</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:centerY</span>=<span class="string">"float"</span>     //渐变中心<span class="attr">Y</span>的相当位置，范围为<span class="attr">0</span>～<span class="attr">1</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:startColor</span>=<span class="string">"color"</span>      //渐变开始点的颜色</span></span><br><span class="line"><span class="tag">        <span class="attr">android:centerColor</span>=<span class="string">"color"</span>     //渐变中间点的颜色，在开始与结束点之间</span></span><br><span class="line"><span class="tag">        <span class="attr">android:endColor</span>=<span class="string">"color"</span>    //渐变结束点的颜色</span></span><br><span class="line"><span class="tag">        <span class="attr">android:gradientRadius</span>=<span class="string">"float"</span>  //渐变的半径，只有当渐变类型为<span class="attr">radial</span>时才能使用</span></span><br><span class="line"><span class="tag">        <span class="attr">android:useLevel</span>=<span class="string">[</span>"<span class="attr">true</span>" | "<span class="attr">false</span>"] /&gt;</span>  //使用LevelListDrawable时就要设置为true。设为false时才有渐变效果</span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">padding</span>    //内部边距</span></span><br><span class="line"><span class="tag">        <span class="attr">android:left</span>=<span class="string">"dimension"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:top</span>=<span class="string">"dimension"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:right</span>=<span class="string">"dimension"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:bottom</span>=<span class="string">"dimension"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">size</span>   //自定义的图形大小</span></span><br><span class="line"><span class="tag">        <span class="attr">android:width</span>=<span class="string">"dimension"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:height</span>=<span class="string">"dimension"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">solid</span>  //内部填充颜色</span></span><br><span class="line"><span class="tag">        <span class="attr">android:color</span>=<span class="string">"color"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">stroke</span>     //描边</span></span><br><span class="line"><span class="tag">        <span class="attr">android:width</span>=<span class="string">"dimension"</span>   //描边的宽度</span></span><br><span class="line"><span class="tag">        <span class="attr">android:color</span>=<span class="string">"color"</span>   //描边的颜色</span></span><br><span class="line"><span class="tag">        // 以下两个属性设置虚线</span></span><br><span class="line"><span class="tag">        <span class="attr">android:dashWidth</span>=<span class="string">"dimension"</span>   //虚线的宽度，值为<span class="attr">0</span>时是实线</span></span><br><span class="line"><span class="tag">        <span class="attr">android:dashGap</span>=<span class="string">"dimension"</span> /&gt;</span>      //虚线的间隔</span><br><span class="line"><span class="tag">&lt;/<span class="name">shape</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-1-直角与圆角矩形"><a href="#2-1-直角与圆角矩形" class="headerlink" title="2.1. 直角与圆角矩形"></a>2.1. 直角与圆角矩形</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">shape</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:shape</span>=<span class="string">"rectangle"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">corners</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:radius</span>=<span class="string">"10dp"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">solid</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:color</span>=<span class="string">"@color/holo_green_dark"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">stroke</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:width</span>=<span class="string">"2dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:color</span>=<span class="string">"@color/white"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">shape</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-2-圆形"><a href="#2-2-圆形" class="headerlink" title="2.2. 圆形"></a>2.2. 圆形</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">shape</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:shape</span>=<span class="string">"oval"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">gradient</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:type</span>=<span class="string">"linear"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:angle</span>=<span class="string">"45"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:startColor</span>=<span class="string">"@color/holo_green_dark"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:centerColor</span>=<span class="string">"@color/holo_blue_dark"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:endColor</span>=<span class="string">"@color/holo_blue_bright"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">shape</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="3-Selector和Shape的结合使用"><a href="#3-Selector和Shape的结合使用" class="headerlink" title="3. Selector和Shape的结合使用"></a>3. Selector和Shape的结合使用</h1><p>通过实现一个按钮，按下前和按下后的不同变化来演示这个功能  </p><ol><li>创建正常状态下的button样式button_default.xml，可用未点击  </li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">shape</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:shape</span>=<span class="string">"rectangle"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">gradient</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:angle</span>=<span class="string">"45"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:startColor</span>=<span class="string">"#6a938b"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:endColor</span>=<span class="string">"#051c3b"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">corners</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:radius</span>=<span class="string">"15dp"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">padding</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:bottom</span>=<span class="string">"7dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:left</span>=<span class="string">"7dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:right</span>=<span class="string">"7dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:top</span>=<span class="string">"7dp"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">stroke</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:width</span>=<span class="string">"2dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:color</span>=<span class="string">"#ffff"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">shape</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>创建点击状态下的样式buttom_pressed.xml  </li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">shape</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:shape</span>=<span class="string">"rectangle"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">gradient</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:angle</span>=<span class="string">"45"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:startColor</span>=<span class="string">"#9a5edf"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:endColor</span>=<span class="string">"#20549b"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">corners</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:radius</span>=<span class="string">"15dp"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">padding</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:bottom</span>=<span class="string">"7dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:left</span>=<span class="string">"7dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:right</span>=<span class="string">"7dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:top</span>=<span class="string">"7dp"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">stroke</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:width</span>=<span class="string">"2dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:color</span>=<span class="string">"#ffff"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">shape</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>创建不可用状态下的样式buttom_disabled.xml  </li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">shape</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:shape</span>=<span class="string">"rectangle"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">solid</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:color</span>=<span class="string">"#858687"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">corners</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:radius</span>=<span class="string">"15dp"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">padding</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:bottom</span>=<span class="string">"7dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:left</span>=<span class="string">"7dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:right</span>=<span class="string">"7dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:top</span>=<span class="string">"7dp"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">stroke</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:width</span>=<span class="string">"2dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:color</span>=<span class="string">"#ffff"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">shape</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>创建一个selector来关联这些shape：custeom_button.xml  </li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">selector</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:state_pressed</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:state_enabled</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:drawable</span>=<span class="string">"@drawable/button_default"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:state_pressed</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:drawable</span>=<span class="string">"@drawable/button_pressed"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:state_enabled</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:drawable</span>=<span class="string">"@drawable/button_disabled"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">selector</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="5"><li>在主button中引入这个selector    </li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/custom_choose"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_margin</span>=<span class="string">"10dp"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">"@drawable/custom_button"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Switch</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/if_enable"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:checked</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">"Enabled"</span>/&gt;</span></span><br></pre></td></tr></table></figure><ol start="6"><li>在主活动中写入逻辑关系  </li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Button custom_BT;</span><br><span class="line">    <span class="keyword">private</span> Switch if_checked;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_custom);</span><br><span class="line"></span><br><span class="line">        custom_BT = (Button)findViewById(R.id.custom_choose);</span><br><span class="line">        if_checked = (Switch)findViewById(R.id.if_enable);</span><br><span class="line"></span><br><span class="line">        custom_BT.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                Toast.makeText(CustomActivity.<span class="keyword">this</span>,<span class="string">"CLicked"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        if_checked.setOnCheckedChangeListener(<span class="keyword">new</span> CompoundButton.OnCheckedChangeListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCheckedChanged</span><span class="params">(CompoundButton buttonView, <span class="keyword">boolean</span> isChecked)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (isChecked)&#123;</span><br><span class="line">                    custom_BT.setEnabled(<span class="keyword">true</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    custom_BT.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="4-通过Style保存刚刚设计的样式"><a href="#4-通过Style保存刚刚设计的样式" class="headerlink" title="4. 通过Style保存刚刚设计的样式"></a>4. 通过Style保存刚刚设计的样式</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"CustomButton"</span> <span class="attr">parent</span>=<span class="string">"Widget.AppCompat.Button"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span> = <span class="string">"android:background"</span>&gt;</span>@drawable/custom_button<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span> = <span class="string">"android:textColor"</span>&gt;</span>#fff<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://www.cnblogs.com/images/cnblogs_com/haochen273/1389248/o_5.gif" alt></p>]]></content>
      
      
      <categories>
          
          <category> Android Development </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android开发教程5-数据存储</title>
      <link href="/2019/03/02/Android%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B5-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/"/>
      <url>/2019/03/02/Android%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B5-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="1-持久化技术"><a href="#1-持久化技术" class="headerlink" title="1. 持久化技术"></a>1. 持久化技术</h1><ul><li>将那些内存的瞬间数据保存到存储设备中，保证即使在手机或者电脑关机的状态下，数据不会丢失， Android有三种持久化方式  <ul><li>文件存储</li><li>SharedPreference储存</li><li>数据库储存  </li></ul></li></ul><h1 id="2-文件储存"><a href="#2-文件储存" class="headerlink" title="2. 文件储存"></a>2. 文件储存</h1><p>适用于存储一些简单的额文本数据或者二进制数据  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSaveActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    EditText editText;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_data_save);</span><br><span class="line"></span><br><span class="line">        editText = (EditText)findViewById(R.id.edit);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 当从主活动转到这里的时候，会加载上一步的文本</span></span><br><span class="line">        String inputText = load();</span><br><span class="line">        <span class="comment">// !TextUtils.isEmpty(inputText):当传入的字符串登录null或者空的时候，返回trye</span></span><br><span class="line">        <span class="keyword">if</span> (!TextUtils.isEmpty(inputText))&#123;</span><br><span class="line">            editText.setText(inputText);</span><br><span class="line">            editText.setSelection(inputText.length());</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>, <span class="string">"Restoring success"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">        String inputText = editText.getText().toString();</span><br><span class="line">        save(inputText);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将数据保存到文件中</span></span><br><span class="line">    <span class="comment">// Context类体用了一个openFileOutput()方法，用于数据储存到指定文件</span></span><br><span class="line">    <span class="comment">// 输入参数: 1: 文件名，所有文件都默认放在/data/data/&lt;package name&gt;/files目录下</span></span><br><span class="line">    <span class="comment">//          2: 文件操作模式，private和append</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(String inputText)</span></span>&#123;</span><br><span class="line">        FileOutputStream out = <span class="keyword">null</span>;</span><br><span class="line">        BufferedWriter writer = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            out = openFileOutput(<span class="string">"data"</span>, Context.MODE_PRIVATE);</span><br><span class="line">            writer = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(out));</span><br><span class="line">            writer.write(inputText);</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>, <span class="string">"Text has been saved"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (writer !=<span class="keyword">null</span>)&#123;</span><br><span class="line">                    writer.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从文件中读取数据</span></span><br><span class="line">    <span class="comment">// Context类提供一个openFileInput方法用于从文件读取数据，接收一个参数：文件名</span></span><br><span class="line">    <span class="comment">// 系统自动从/data/data/&lt;package name&gt;/files/目录下去加载这个文件，返回一个FileInputStream对象</span></span><br><span class="line">    <span class="comment">// 通过java流将数据读取出来</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">load</span><span class="params">()</span></span>&#123;</span><br><span class="line">        FileInputStream in = <span class="keyword">null</span>;</span><br><span class="line">        BufferedReader reader = <span class="keyword">null</span>;</span><br><span class="line">        StringBuilder content  =<span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            in = openFileInput(<span class="string">"data"</span>);</span><br><span class="line">            <span class="comment">// 通过BufferedReader进行一行行的读取</span></span><br><span class="line">            reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in));</span><br><span class="line">            String line = <span class="string">""</span>;</span><br><span class="line">            <span class="keyword">while</span> ((line = reader.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                content.append(line);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (reader!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    reader.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">               &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">return</span> content.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.cnblogs.com/images/cnblogs_com/haochen273/1389248/o_3.gif" alt></p><h1 id="3-SharedPreferences存储"><a href="#3-SharedPreferences存储" class="headerlink" title="3. SharedPreferences存储"></a>3. SharedPreferences存储</h1><ul><li>SharedPreference是通过键值对存储数据  </li></ul><h2 id="3-1-将数据存储到Sharepreferences中"><a href="#3-1-将数据存储到Sharepreferences中" class="headerlink" title="3.1. 将数据存储到Sharepreferences中"></a>3.1. 将数据存储到Sharepreferences中</h2><p>要想适用SharePreference来存储数据，首先需要获得SharePreference对象，Android提供了3中方式获取SharePreference对象  </p><ol><li>Context类中的<code>getSharedPreferences(filename, MODE)</code>方法 </li></ol><p>第一个参数是用于指定SharedPreferences的文件名称，保存在<code>/data/data/&lt;package name&gt;/shared_prefs/</code>目录下<br>第二个参数是默认操作模式，MODE_PRIVATE  </p><ol start="2"><li>Activity类中的getPreferences()方法</li></ol><p>这个方法和上面的很类似，不过它只接收一个操作模式参数</p><ol start="3"><li>PrefenceManager类中的getDefaultSharedPreferences()方法  </li></ol><p>这是一个静态方法接收context参数，并自动使用当前程序包名作为前缀来命名SharedPreferences文件  </p><p>得到了SharePreference对象后，我们就可向里面写入数据了，主要分为3步完成：  </p><p>(1). 调用SharePreference对象的edit()方法获取一个SharePreferences.Editor对象<br>(2). 向SharePreferences.Editor对象添加数据，putBoolean(),putString()<br>(3). 调用apply()方法将添加的数据提交，完成数据的存储操作</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSaveActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> EditText editText,account,pw;</span><br><span class="line">    <span class="keyword">private</span> Button login;</span><br><span class="line">    <span class="keyword">private</span> CheckBox rememberPW;</span><br><span class="line">    <span class="keyword">private</span> SharedPreferences pref;</span><br><span class="line">    <span class="keyword">private</span> SharedPreferences.Editor editor;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_data_save);</span><br><span class="line"></span><br><span class="line">        editText = (EditText)findViewById(R.id.edit);</span><br><span class="line">        account = (EditText)findViewById(R.id.account);</span><br><span class="line">        pw = (EditText)findViewById(R.id.pw);</span><br><span class="line">        login = (Button)findViewById(R.id.login);</span><br><span class="line">        rememberPW = (CheckBox)findViewById(R.id.remeber_pw);</span><br><span class="line">        pref = PreferenceManager.getDefaultSharedPreferences(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span> isRemember = pref.getBoolean(<span class="string">"remember_password"</span>,<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isRemember)&#123;</span><br><span class="line">            String accountText = pref.getString(<span class="string">"account"</span>,<span class="string">""</span>);</span><br><span class="line">            String passwordText = pref.getString(<span class="string">"password"</span>, <span class="string">""</span>);</span><br><span class="line">            account.setText(accountText);</span><br><span class="line">            pw.setText(passwordText);</span><br><span class="line">            rememberPW.setChecked(<span class="keyword">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        login.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                String accountText = account.getText().toString();</span><br><span class="line">                String passwordText = pw.getText().toString();</span><br><span class="line">                <span class="comment">// 如果账号是admin，且密码是123456，就任务登录成功</span></span><br><span class="line">                <span class="keyword">if</span> (accountText.equals(<span class="string">"admin"</span>) &amp;&amp; passwordText.equals(<span class="string">"123456"</span>))&#123;</span><br><span class="line">                    editor = pref.edit();</span><br><span class="line">                    <span class="keyword">if</span> (rememberPW.isChecked())&#123;</span><br><span class="line">                        editor.putBoolean(<span class="string">"remember_password"</span>, <span class="keyword">true</span>);</span><br><span class="line">                        editor.putString(<span class="string">"account"</span>, accountText);</span><br><span class="line">                        editor.putString(<span class="string">"password"</span>,passwordText);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        editor.clear();</span><br><span class="line">                    &#125;</span><br><span class="line">                    editor.apply();</span><br><span class="line">                    Toast.makeText(DataSaveActivity.<span class="keyword">this</span>, <span class="string">"You got it"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    Toast.makeText(DataSaveActivity.<span class="keyword">this</span>, <span class="string">"Wrong account or password"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 当从主活动转到这里的时候，会加载上一步的文本</span></span><br><span class="line">        String inputText = load();</span><br><span class="line">        <span class="comment">// !TextUtils.isEmpty(inputText):当传入的字符串登录null或者空的时候，返回trye</span></span><br><span class="line">        <span class="keyword">if</span> (!TextUtils.isEmpty(inputText))&#123;</span><br><span class="line">            editText.setText(inputText);</span><br><span class="line">            editText.setSelection(inputText.length());</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>, <span class="string">"Restoring success"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">        String inputText = editText.getText().toString();</span><br><span class="line">        save(inputText);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将数据保存到文件中</span></span><br><span class="line">    <span class="comment">// Context类体用了一个openFileOutput()方法，用于数据储存到指定文件</span></span><br><span class="line">    <span class="comment">// 输入参数: 1: 文件名，所有文件都默认放在/data/data/&lt;package name&gt;/files目录下</span></span><br><span class="line">    <span class="comment">//          2: 文件操作模式，private和append</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(String inputText)</span></span>&#123;</span><br><span class="line">        FileOutputStream out = <span class="keyword">null</span>;</span><br><span class="line">        BufferedWriter writer = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            out = openFileOutput(<span class="string">"data"</span>, Context.MODE_PRIVATE);</span><br><span class="line">            writer = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(out));</span><br><span class="line">            writer.write(inputText);</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>, <span class="string">"Text has been saved"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (writer !=<span class="keyword">null</span>)&#123;</span><br><span class="line">                    writer.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从文件中读取数据</span></span><br><span class="line">    <span class="comment">// Context类提供一个openFileInput方法用于从文件读取数据，接收一个参数：文件名</span></span><br><span class="line">    <span class="comment">// 系统自动从/data/data/&lt;package name&gt;/files/目录下去加载这个文件，返回一个FileInputStream对象</span></span><br><span class="line">    <span class="comment">// 通过java流将数据读取出来</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">load</span><span class="params">()</span></span>&#123;</span><br><span class="line">        FileInputStream in = <span class="keyword">null</span>;</span><br><span class="line">        BufferedReader reader = <span class="keyword">null</span>;</span><br><span class="line">        StringBuilder content  =<span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            in = openFileInput(<span class="string">"data"</span>);</span><br><span class="line">            <span class="comment">// 通过BufferedReader进行一行行的读取</span></span><br><span class="line">            reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in));</span><br><span class="line">            String line = <span class="string">""</span>;</span><br><span class="line">            <span class="keyword">while</span> ((line = reader.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                content.append(line);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (reader!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    reader.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">               &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">return</span> content.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.cnblogs.com/images/cnblogs_com/haochen273/1389248/o_4.gif" alt>  </p><h1 id="4-LitePal数据库存储"><a href="#4-LitePal数据库存储" class="headerlink" title="4. LitePal数据库存储"></a>4. LitePal数据库存储</h1><p>LitPal是一款开源的Android数据库框架，采用对象关系映射(ORM)模式，并将我们平时开发常用的一些数据库功能进行了一些封装  </p><h2 id="4-1-配置LitePal"><a href="#4-1-配置LitePal" class="headerlink" title="4.1. 配置LitePal"></a>4.1. 配置LitePal</h2><p>在app/build.gradle中添加implments  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation &apos;org.litepal.android:java:3.0.0&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后需要配置litepal.xml文件，右击app/src/main目录-&gt;New-&gt;Directory创建一个assets目录，然后在里面创建litepal.xml文件  </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">litepal</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dbname</span> <span class="attr">value</span> = <span class="string">"BookStore"</span>&gt;</span><span class="tag">&lt;/<span class="name">dbname</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span> <span class="attr">value</span> = <span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">list</span>&gt;</span><span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">litepal</span>&gt;</span></span><br></pre></td></tr></table></figure><p>然后在AndroidManifest.xml中配置一下<code>android:name=&quot;org.litepal.LitePalApplication&quot;</code>  </p><h2 id="4-2-创建和升级数据库"><a href="#4-2-创建和升级数据库" class="headerlink" title="4.2. 创建和升级数据库"></a>4.2. 创建和升级数据库</h2><p>首先配置adb  </p><p><code>C:\Users\HAO\AppData\Local\Android\Sdk\platform-tools</code>添加到系统变量中</p>]]></content>
      
      
      <categories>
          
          <category> Android Development </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android开发教程4-BroadcastReceiver的使用</title>
      <link href="/2019/03/02/Android%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B4-BroadcastReceiver%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/2019/03/02/Android%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B4-BroadcastReceiver%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="1-广播机制"><a href="#1-广播机制" class="headerlink" title="1. 广播机制"></a>1. 广播机制</h1><p>BroadcastReceiver，顾名思义就是“广播接收者”的意思，它是Android四大基本组件之一，这种组件本质上是一种全局的监听器，用于监听系统全局的广播消息。它可以接收来自系统和应用的的广播。 BroadcastReceiver用于接收程序（包括系统程序和一般应用）通过sendBroadcast()方法发出的Broadcast intents</p><ul><li>Android的每个应用程序都可以对自己感兴趣的广播进行注册，这样该程序就会只接收自己关系的广播内容  </li><li>广播内容来自系统或者其他应用程序  </li><li>发送广播:Intent  </li><li>接收广播: Broadcaset Receiver  </li><li>广播的分类  <ul><li>标准广播：异步执行，广播发出后，所有的接收器几乎同时接收到这个广播，没有先后顺序之分  </li><li>有序广播： 同步执行，广播发出后，同意时间只有一个广播接收器能够接受这个广播，当接收完毕后才会继续传递给下一个  </li></ul></li></ul><h1 id="2-程序启动BroadcastReceiver的步骤："><a href="#2-程序启动BroadcastReceiver的步骤：" class="headerlink" title="2.程序启动BroadcastReceiver的步骤："></a>2.程序启动BroadcastReceiver的步骤：</h1><ol><li>创建需要启动BroadcastReceiver的Intent。</li><li>调用Context的sendBroadcast()或sendOrderedBroadcast()方法来启动指定的BroadcastReceiver。其中sendBroadcast发送的是普通广播，sendOrderedBroadcast发送的是有序广播。  </li></ol><h1 id="3-创建BroadcastReceiver的步骤"><a href="#3-创建BroadcastReceiver的步骤" class="headerlink" title="3.创建BroadcastReceiver的步骤"></a>3.创建BroadcastReceiver的步骤</h1><h2 id="3-1-创建BroadcastReceiver的自雷"><a href="#3-1-创建BroadcastReceiver的自雷" class="headerlink" title="3.1. 创建BroadcastReceiver的自雷"></a>3.1. 创建BroadcastReceiver的自雷</h2><p>由于BroadcastReceiver本质上是一种监听器，所以创建BroadcastReceiver的方法也非常简单，只需要创建一个BroadcastReceiver的子类然后重写onReceive (Context context, Intentintent)方法即可。  </p><h2 id="3-2-注册BroadcastReceiver"><a href="#3-2-注册BroadcastReceiver" class="headerlink" title="3.2. 注册BroadcastReceiver"></a>3.2. 注册BroadcastReceiver</h2><p>一旦实现了BroadcastReceiver，接下就应该指定该BroadcastReceiver能匹配的Intent即注册BroadcastReceiver。注册BroadcastReceiver的方式有两种：  </p><ol><li><strong>静态注册：</strong> 这种方法是在配置AndroidManifest.xml配置文件中注册，通过这种方式注册的广播为常驻型广播，也就是说如果应用程序关闭了，有相应事件触发，程序还是会被系统自动调用运行  </li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在配置文件中注册BroadcastReceiver能够匹配的Intent --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">receiver</span> <span class="attr">android:name</span>=<span class="string">"com.example.test.MyBroadcastReceiver"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.MyBroadcastReceiver"</span>&gt;</span><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.DEFAULT"</span>&gt;</span><span class="tag">&lt;/<span class="name">category</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">receiver</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li><strong>动态注册:</strong> 种方法是通过代码在.Java文件中进行注册。通过这种方式注册的广播为非常驻型广播，即它会跟随Activity的生命周期，所以在Activity结束前我们需要调用unregisterReceiver(receiver)方法移除它。  </li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过代码的方式动态注册MyBroadcastReceiver</span></span><br><span class="line">MyBroadcastReceiver receiver=<span class="keyword">new</span> MyBroadcastReceiver();</span><br><span class="line">IntentFilter filter=<span class="keyword">new</span> IntentFilter();</span><br><span class="line">filter.addAction(<span class="string">"android.intent.action.MyBroadcastReceiver"</span>);</span><br><span class="line"><span class="comment">//注册receiver</span></span><br><span class="line">registerReceiver(receiver, filter);</span><br></pre></td></tr></table></figure><p>如果我们在Activity中注册了BroadcastReceiver，当这个Activity销毁的时候要主动撤销注册否则会出现异常。  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">         <span class="keyword">super</span>.onDestroy();</span><br><span class="line">         <span class="comment">//当Activity销毁的时候取消注册BroadcastReceiver</span></span><br><span class="line">         unregisterReceiver(receiver);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="4-BroadCastReceiver的生命周期"><a href="#4-BroadCastReceiver的生命周期" class="headerlink" title="4. BroadCastReceiver的生命周期"></a>4. BroadCastReceiver的生命周期</h1><p>BroadcastReceiver的生命周期，从对象调用它开始，到onReceiver方法执行完成之后结束。另外，每次广播被接收后会重新创建BroadcastReceiver对象，并在onReceiver方法中执行完就销毁，如果BroadcastReceiver的onReceiver方法中不能在10秒内执行完成，Android会出现ANR异常。所以不要在BroadcastReceiver的onReceiver方法中执行耗时的操作。</p><h1 id="5-实例"><a href="#5-实例" class="headerlink" title="5. 实例"></a>5. 实例</h1><p><strong><font color="red">最新Android不再兼容静态注册，尽量用动态注册</font></strong></p><p>先定义两个广播接收器  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBroadcastReceiver</span> <span class="keyword">extends</span> <span class="title">BroadcastReceiver</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceive</span><span class="params">(Context context, Intent intent)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//TODO</span></span><br><span class="line">        String msg = intent.getStringExtra(<span class="string">"msg"</span>);</span><br><span class="line"></span><br><span class="line">        Log.d(<span class="string">"TAG"</span>, <span class="string">"接收的消息时： "</span> + msg);</span><br><span class="line"></span><br><span class="line">        setResultData(<span class="string">"MyBroadcastReceiver接收到广播"</span>);</span><br><span class="line"></span><br><span class="line">        Toast.makeText(context, <span class="string">"时间： "</span> + <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-mm-dd hh.mm.ss"</span>).format(<span class="keyword">new</span> Date())</span><br><span class="line">                        + <span class="string">"\nMyBroadcastReceiver收到Action名为: "</span> + intent.getAction().toString()</span><br><span class="line">                        + <span class="string">"的广播\nComponent: "</span> + intent.getComponent()</span><br><span class="line">                        + <span class="string">"\nmsg: "</span> + msg,</span><br><span class="line">                        Toast.LENGTH_LONG).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecondBroadcastReceiver</span> <span class="keyword">extends</span> <span class="title">BroadcastReceiver</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceive</span><span class="params">(Context context, Intent intent)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String msg=intent.getExtras().get(<span class="string">"msg"</span>).toString();</span><br><span class="line">        String result=getResultData();</span><br><span class="line">        Toast.makeText(context,<span class="string">"时间："</span>+<span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd hh.mm.ss"</span>).format(<span class="keyword">new</span> Date())</span><br><span class="line">                        +<span class="string">"\nSecondBroadcastReceiver收到Action名为："</span>+intent.getAction().toString()</span><br><span class="line">                        +<span class="string">"的广播 \nComponent:"</span>+intent.getComponent()</span><br><span class="line">                        +<span class="string">"\nmsg:"</span>+msg+<span class="string">"\n上一个接受者传来的reult:"</span>+result,</span><br><span class="line">                Toast.LENGTH_LONG).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后再在activity中发送广播  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BroadcastDemoActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    Button general_BT, order_BT;</span><br><span class="line">    MyBroadcastReceiver receiver;</span><br><span class="line">    SecondBroadcastReceiver secondReceiver;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String ACTION = <span class="string">"com.android.broadcast.RECEIVER_ACTION"</span>;</span><br><span class="line">    <span class="keyword">private</span> IntentFilter intentFilter;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    String TAG = <span class="string">"DEBUG"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_broadcast_demo);</span><br><span class="line"></span><br><span class="line">        general_BT = (Button)findViewById(R.id.general_bc);</span><br><span class="line">        order_BT = (Button)findViewById(R.id.order_bc);</span><br><span class="line">        receiver=<span class="keyword">new</span> MyBroadcastReceiver();</span><br><span class="line">        secondReceiver = <span class="keyword">new</span> SecondBroadcastReceiver();</span><br><span class="line"></span><br><span class="line">        RegisterBroadcast(receiver,<span class="number">200</span>);</span><br><span class="line">        RegisterBroadcast(secondReceiver,<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        general_BT.setOnClickListener(<span class="keyword">new</span> Mylistener());</span><br><span class="line">        order_BT.setOnClickListener(<span class="keyword">new</span> Mylistener());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">RegisterBroadcast</span><span class="params">(BroadcastReceiver receiver, <span class="keyword">int</span> Value)</span></span>&#123;</span><br><span class="line">        intentFilter = <span class="keyword">new</span> IntentFilter();</span><br><span class="line">        intentFilter.addAction(ACTION);</span><br><span class="line">        intentFilter.setPriority(Value);</span><br><span class="line">        registerReceiver(receiver,intentFilter);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Mylistener</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> id = v.getId();</span><br><span class="line">            <span class="keyword">switch</span> (id)&#123;</span><br><span class="line">                <span class="keyword">case</span> R.id.general_bc:</span><br><span class="line">                    Intent intent = <span class="keyword">new</span> Intent(<span class="string">"com.android.broadcast.RECEIVER_ACTION"</span>);</span><br><span class="line">                    intent.putExtra(<span class="string">"msg"</span>,<span class="string">"我在发送广播！这智商一个普通的广播，"</span> + <span class="string">"你们无法通过abortBroadcast()方法停止广播的传播， "</span> +</span><br><span class="line">                                    <span class="string">"也无法往Broadcast中存入数据因为他是异步的"</span>);</span><br><span class="line">                    sendBroadcast(intent);</span><br><span class="line">                    Log.d(TAG, <span class="string">"发送成功啦！！！！"</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> R.id.order_bc:</span><br><span class="line">                    Intent intent2 =<span class="keyword">new</span> Intent();</span><br><span class="line">                    intent2.setAction(<span class="string">"com.android.broadcast.RECEIVER_ACTION"</span>);</span><br><span class="line">                    intent2.putExtra(<span class="string">"msg"</span>, <span class="string">"我在发送一个有序的广播，"</span>+</span><br><span class="line">                                    <span class="string">"你们可以通过abortBroadcast()的方法停止广播的传播，"</span>+</span><br><span class="line">                                    <span class="string">"也可以向Broadcast中存入数据"</span>);</span><br><span class="line">                    sendOrderedBroadcast(intent2, <span class="keyword">null</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onStop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onStop();</span><br><span class="line">        <span class="keyword">this</span>.unregisterReceiver(receiver);</span><br><span class="line">        <span class="keyword">this</span>.unregisterReceiver(secondReceiver);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果如下：</p><p><img src="https://www.cnblogs.com/images/cnblogs_com/haochen273/1389248/o_1.gif" alt></p>]]></content>
      
      
      <categories>
          
          <category> Android Development </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android开发教程3-RecycleView以及其Adapter的使用</title>
      <link href="/2019/03/02/Android%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B3-RecycleView%E4%BB%A5%E5%8F%8A%E5%85%B6Adapter%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/2019/03/02/Android%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B3-RecycleView%E4%BB%A5%E5%8F%8A%E5%85%B6Adapter%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="1-RecyclerView介绍"><a href="#1-RecyclerView介绍" class="headerlink" title="1. RecyclerView介绍"></a>1. RecyclerView介绍</h1><ul><li>ListView的运行效率低  </li><li>RecyclerView是增强版本的ListView  </li></ul><h1 id="2-RecyclerView的三部曲"><a href="#2-RecyclerView的三部曲" class="headerlink" title="2. RecyclerView的三部曲"></a>2. RecyclerView的三部曲</h1><h2 id="2-1-首先设置recyclerView的布局文件"><a href="#2-1-首先设置recyclerView的布局文件" class="headerlink" title="2.1. 首先设置recyclerView的布局文件"></a>2.1. 首先设置recyclerView的布局文件</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".RecycleDemoActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/layout01"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">"horizontal"</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/linearLayout_recycle"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">"线性布局"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/grid_recycle"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:gravity</span>=<span class="string">"center"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">"网格布局"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/staggeredLayout_recycle"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">"瀑布布局"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.v7.widget.RecyclerView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/my_recycler_view"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">android.support.v7.widget.RecyclerView</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-2-然后创建recyclerView的布局文件"><a href="#2-2-然后创建recyclerView的布局文件" class="headerlink" title="2.2. 然后创建recyclerView的布局文件"></a>2.2. 然后创建recyclerView的布局文件</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"100dp"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/text_view"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">"20dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"6666"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">"30dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">"center"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-3-自定义RecyclerAdapter"><a href="#2-3-自定义RecyclerAdapter" class="headerlink" title="2.3. 自定义RecyclerAdapter"></a>2.3. 自定义RecyclerAdapter</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 需要重写</span></span><br><span class="line"><span class="comment">// onCreateViewHolder(): 创建ViewHolder实例，并传入布局文件，返回这个实例</span></span><br><span class="line"><span class="comment">// onBindViewHolder()：对RecyclerView子项的数据赋值，会在每个子项被滚动到屏幕内的时候执行，</span></span><br><span class="line"><span class="comment">// 通过position参数得到当前项的Fruit实例，再讲数据设置到ViewHolder的TextView中</span></span><br><span class="line"><span class="comment">// getItemCount(): 告诉RecyclerView一共有多少子项，直接返回数据源的长度</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RecycleAdapter</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">Adapter</span>&lt;<span class="title">RecycleAdapter</span>.<span class="title">MyViewHolder</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; mList;</span><br><span class="line">    <span class="keyword">private</span> Context context;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// RecycleAdapter也有一个自己的构造函数</span></span><br><span class="line">    <span class="comment">// 把要展示的内容传入</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RecycleAdapter</span><span class="params">(List&lt;String&gt; list, Context context)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mList = list;</span><br><span class="line">        <span class="keyword">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mList.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义一个内部类MyViewHolder继承RecyclerView.ViewHolder</span></span><br><span class="line">    <span class="comment">// ViewHolder的构造函数要传入一个View参数，这个参数通常是RecyclerView子项的最外层布局，</span></span><br><span class="line">    <span class="comment">// 那么我们就可以通过findViewById()方法来获取布局中的TextView</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyViewHolder</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">ViewHolder</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> TextView mView;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">MyViewHolder</span><span class="params">(@NonNull View itemView)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(itemView);</span><br><span class="line">            mView = itemView.findViewById(R.id.text_view);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建ViewHolder</span></span><br><span class="line">    <span class="comment">//onCreateViewHolder方法创建一个viewHolder，viewholder可以理解为一条数据的展示布局，这里我们自定义类LinearViewHolder创建一个只有TextView的item</span></span><br><span class="line">    <span class="comment">//这里我们需要创建每条布局使用的layout：recycle_item</span></span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MyViewHolder <span class="title">onCreateViewHolder</span><span class="params">(@NonNull ViewGroup viewGroup, <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MyViewHolder(LayoutInflater.from(viewGroup.getContext()).inflate(R.layout.recycle_item, viewGroup, <span class="keyword">false</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//填充视图</span></span><br><span class="line">    <span class="comment">//onBindViewHolder方法为item的UI绑定展示数据</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBindViewHolder</span><span class="params">(@NonNull <span class="keyword">final</span> MyViewHolder holder, <span class="keyword">final</span> <span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">        holder.mView.setText(mList.get(position));</span><br><span class="line"></span><br><span class="line">        holder.itemView.setOnClickListener(<span class="keyword">new</span> View.OnClickListener()&#123;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                Toast.makeText(context, <span class="string">"点击子项"</span>+position, Toast.LENGTH_SHORT).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addData</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">        mList.add(position, <span class="string">"Insert One"</span>);</span><br><span class="line">        notifyItemInserted(position);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeData</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">        mList.remove(position);</span><br><span class="line">        notifyItemRemoved(position);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clearALL</span><span class="params">()</span></span>&#123;</span><br><span class="line">        mList.clear();</span><br><span class="line">        notifyDataSetChanged();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-4-在Activity中实现adapter"><a href="#2-4-在Activity中实现adapter" class="headerlink" title="2.4. 在Activity中实现adapter"></a>2.4. 在Activity中实现adapter</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RecycleDemoActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Button linearBT, gridBT, starBT;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> RecyclerView mRecyclerView;</span><br><span class="line">    <span class="keyword">private</span> RecycleAdapter mMyAdapter;</span><br><span class="line">    <span class="keyword">private</span> RecyclerView.LayoutManager mLayoutManager;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; list;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_recycle_demo);</span><br><span class="line"></span><br><span class="line">        linearBT = (Button)findViewById(R.id.linearLayout_recycle);</span><br><span class="line">        gridBT = (Button)findViewById(R.id.grid_recycle);</span><br><span class="line">        starBT = (Button)findViewById(R.id.staggeredLayout_recycle);</span><br><span class="line">        <span class="comment">// RecyclerView的三部曲 01: 获取RecyclerView对象</span></span><br><span class="line">        mRecyclerView = (RecyclerView)findViewById(R.id.my_recycler_view);</span><br><span class="line"></span><br><span class="line">        initData();</span><br><span class="line"></span><br><span class="line">        linearBT.setOnClickListener(<span class="keyword">new</span> ButtonClicked());</span><br><span class="line">        gridBT.setOnClickListener(<span class="keyword">new</span> ButtonClicked());</span><br><span class="line">        starBT.setOnClickListener(<span class="keyword">new</span> ButtonClicked());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//        // 添加水平分割线</span></span><br><span class="line"><span class="comment">//        mRecyclerView.addItemDecoration(new DividerItemDecoration(this,DividerItemDecoration.VERTICAL));</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">50</span>;i++)&#123;</span><br><span class="line">            list.add(<span class="string">"Item"</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ButtonClicked</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span> </span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">switch</span> (v.getId())&#123;</span><br><span class="line">                <span class="keyword">case</span> R.id.linearLayout_recycle:</span><br><span class="line">                    mLayoutManager = <span class="keyword">new</span> LinearLayoutManager(getApplicationContext());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> R.id.grid_recycle:</span><br><span class="line">                    mLayoutManager = <span class="keyword">new</span> GridLayoutManager(getApplicationContext(),<span class="number">4</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> R.id.staggeredLayout_recycle:</span><br><span class="line">                    <span class="comment">//如果传入 StaggeredGridLayoutManager.VERTICAL则该布局支持纵向滑动，那么前面的 4 则指的是 4列。</span></span><br><span class="line">                    <span class="comment">//如果传入 StaggeredGridLayoutManager.HORIZONTAL，则该布局支持横向滑动，那么前面的4 则指的是 4行</span></span><br><span class="line">                    mLayoutManager = <span class="keyword">new</span> StaggeredGridLayoutManager(<span class="number">4</span>,StaggeredGridLayoutManager.VERTICAL);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    mLayoutManager = <span class="keyword">new</span> LinearLayoutManager(getApplicationContext());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//RecyclerView的三部曲 02：设置布局管理器</span></span><br><span class="line">            mRecyclerView.setLayoutManager(mLayoutManager);</span><br><span class="line">            mRecyclerView.addItemDecoration(<span class="keyword">new</span> DividerItemDecoration(getApplicationContext(),DividerItemDecoration.VERTICAL));</span><br><span class="line">            <span class="comment">// RecyclerView的三部曲 03： 添加适配器，适配器需要重写</span></span><br><span class="line">            mMyAdapter = <span class="keyword">new</span> RecycleAdapter(list, getApplicationContext());</span><br><span class="line">            mRecyclerView.setAdapter(mMyAdapter);</span><br><span class="line">            <span class="comment">//设置Item增加、移除动画</span></span><br><span class="line">            mRecyclerView.setItemAnimator(<span class="keyword">new</span> DefaultItemAnimator());</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> </span>&#123;</span><br><span class="line">        getMenuInflater().inflate(R.menu.menu, menu);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onOptionsItemSelected</span><span class="params">(MenuItem item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (item.getItemId()) &#123;</span><br><span class="line">            <span class="keyword">case</span> R.id.add_item:</span><br><span class="line">                mMyAdapter.addData(<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> R.id.remove_item:</span><br><span class="line">                mMyAdapter.removeData(<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="3-实现效果"><a href="#3-实现效果" class="headerlink" title="3. 实现效果"></a>3. 实现效果</h1><p><img src="https://img2018.cnblogs.com/blog/1575244/201901/1575244-20190121202317436-384282335.gif" alt></p>]]></content>
      
      
      <categories>
          
          <category> Android Development </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android开发教程2-ListView以及Adapter的使用</title>
      <link href="/2019/03/02/Android%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B2-ListView%E4%BB%A5%E5%8F%8AAdapter%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/2019/03/02/Android%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B2-ListView%E4%BB%A5%E5%8F%8AAdapter%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ListView的基本用法"><a href="#1-ListView的基本用法" class="headerlink" title="1. ListView的基本用法"></a>1. ListView的基本用法</h1><p>允许用户通过手指上下滑动的方式将屏幕外的数据滚动到屏幕内，同时屏幕上原有的数据会滚出屏幕  </p><ul><li>布局文件中增加 ListView</li><li>定义一个实体类，用于设置需要保存的数据结构</li><li>源码中构造适配器 Adapter ，准备子项布局</li><li>通过id找到ListView的实例 ，准备数据结构</li><li>ListView设置适配器，派生ArrayAdapter  </li></ul><h2 id="1-1-增加ListView"><a href="#1-1-增加ListView" class="headerlink" title="1.1. 增加ListView"></a>1.1. 增加ListView</h2><p>首先在Activity里面添加ListView插件，在布局文件中写入如下代码  </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">android.support.constraint.ConstraintLayout</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">".ListViewActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ListView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/list_view"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.constraint.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="1-2-定义一个实体类，用于设置需要保存的数据结构"><a href="#1-2-定义一个实体类，用于设置需要保存的数据结构" class="headerlink" title="1.2. 定义一个实体类，用于设置需要保存的数据结构"></a>1.2. 定义一个实体类，用于设置需要保存的数据结构</h2><p>定义一个实体类，作为ListView适配器的适配类型，新建类Fruit  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fruit</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> imageId;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Fruit</span><span class="params">(String name, <span class="keyword">int</span> imageId)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.imageId = imageId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getImageId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> imageId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="1-3-准备子项布局"><a href="#1-3-准备子项布局" class="headerlink" title="1.3. 准备子项布局"></a>1.3. 准备子项布局</h2><p>子项布局就是你需要在listview中每一行显示的格式，新建一个布局文件，写入如下数据  </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/fruit_image"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/fruit_name"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">"center_vertical"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginLeft</span>=<span class="string">"10dp"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="1-4-自定义适配器，继承ArrayAdapter"><a href="#1-4-自定义适配器，继承ArrayAdapter" class="headerlink" title="1.4. 自定义适配器，继承ArrayAdapter"></a>1.4. 自定义适配器，继承ArrayAdapter</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FruitAdapter</span> <span class="keyword">extends</span> <span class="title">ArrayAdapter</span>&lt;<span class="title">Fruit</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> resourceId;</span><br><span class="line">    <span class="comment">// 将上下文， listview子项布局的id和数据传入</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FruitAdapter</span><span class="params">(Context context, <span class="keyword">int</span> textViewResourceId, List&lt;Fruit&gt; objects)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">super</span>(context, textViewResourceId, objects);</span><br><span class="line">        resourceId = textViewResourceId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 每个子项被滚动到屏幕内的时候会被调用</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">getView</span><span class="params">(<span class="keyword">int</span> position, View convertView,  ViewGroup parent)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Fruit fruit = getItem(position);  <span class="comment">// 获取当前的Fruit实例</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用已经缓存好的view</span></span><br><span class="line">        View view;</span><br><span class="line"></span><br><span class="line">        ViewHolder viewHolder;</span><br><span class="line">        <span class="keyword">if</span> (convertView == <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="comment">// inflate出子项布局，实例化其中的图片控件和文本控件</span></span><br><span class="line">            <span class="comment">// 加载传入的布局</span></span><br><span class="line">            <span class="comment">// false： 只让我们在父布局中声明的layout属性升序，但是部位这个view添加父布局</span></span><br><span class="line">            view = LayoutInflater.from(getContext()).inflate(resourceId, parent, <span class="keyword">false</span>);</span><br><span class="line">            viewHolder = <span class="keyword">new</span> ViewHolder();</span><br><span class="line">            viewHolder.fruitImage = (ImageView) view.findViewById(R.id.fruit_image);</span><br><span class="line">            viewHolder.fruitName = (TextView)view.findViewById(R.id.fruit_name);</span><br><span class="line">            <span class="comment">// 缓存图片控件和文本控件的实例</span></span><br><span class="line">            view.setTag(viewHolder);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            view = convertView;</span><br><span class="line">            <span class="comment">// 取出缓存</span></span><br><span class="line">            viewHolder = (ViewHolder)view.getTag();  <span class="comment">// 重新获取ViewHolder</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 直接使用缓存中的图片控件和文本控件的实例</span></span><br><span class="line">        <span class="comment">// 图片控件设置图片资源</span></span><br><span class="line">        viewHolder.fruitImage.setImageResource(fruit.getImageId());</span><br><span class="line">        viewHolder.fruitName.setText(fruit.getName());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> view;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ViewHolder</span></span>&#123;</span><br><span class="line">        <span class="comment">// 这个类是为了避免每次载入lostview都需要findviewid的苦难</span></span><br><span class="line">        ImageView fruitImage;</span><br><span class="line">        TextView fruitName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="1-5-活动中应用自定义适配器"><a href="#1-5-活动中应用自定义适配器" class="headerlink" title="1.5. 活动中应用自定义适配器"></a>1.5. 活动中应用自定义适配器</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListViewActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ListView lv01;</span><br><span class="line"></span><br><span class="line">    ArrayList&lt;Fruit&gt; fruitList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_list_view);</span><br><span class="line"></span><br><span class="line">        initFruits();</span><br><span class="line">        FruitAdapter adapter = <span class="keyword">new</span> FruitAdapter(ListViewActivity.<span class="keyword">this</span>, R.layout.fruit_items, fruitList);</span><br><span class="line"></span><br><span class="line">        lv01 = (ListView)findViewById(R.id.list_view);</span><br><span class="line">        lv01.setAdapter(adapter);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initFruits</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</span><br><span class="line">            Fruit apple = <span class="keyword">new</span> Fruit(<span class="string">"Apple"</span>, R.drawable.apple);</span><br><span class="line">            fruitList.add(apple);</span><br><span class="line">            Fruit banana = <span class="keyword">new</span> Fruit(<span class="string">"Banana"</span>, R.drawable.banana);</span><br><span class="line">            fruitList.add(banana);</span><br><span class="line">            Fruit orange = <span class="keyword">new</span> Fruit(<span class="string">"Orange"</span>, R.drawable.orange);</span><br><span class="line">            fruitList.add(orange);</span><br><span class="line">            Fruit watermelon = <span class="keyword">new</span> Fruit(<span class="string">"Watermelon"</span>, R.drawable.watermelon);</span><br><span class="line">            fruitList.add(watermelon);</span><br><span class="line">            Fruit pear = <span class="keyword">new</span> Fruit(<span class="string">"Pear"</span>, R.drawable.pear);</span><br><span class="line">            fruitList.add(pear);</span><br><span class="line">            Fruit grape = <span class="keyword">new</span> Fruit(<span class="string">"Grape"</span>, R.drawable.grape);</span><br><span class="line">            fruitList.add(grape);</span><br><span class="line">            Fruit pineapple = <span class="keyword">new</span> Fruit(<span class="string">"Pineapple"</span>, R.drawable.pineapple);</span><br><span class="line">            fruitList.add(pineapple);</span><br><span class="line">            Fruit strawberry = <span class="keyword">new</span> Fruit(<span class="string">"Strawberry"</span>, R.drawable.strawberry);</span><br><span class="line">            fruitList.add(strawberry);</span><br><span class="line">            Fruit cherry = <span class="keyword">new</span> Fruit(<span class="string">"Cherry"</span>, R.drawable.cheery);</span><br><span class="line">            fruitList.add(cherry);</span><br><span class="line">            Fruit mango = <span class="keyword">new</span> Fruit(<span class="string">"Mango"</span>, R.drawable.mango);</span><br><span class="line">            fruitList.add(mango);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Android Development </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android开发教程1-Activity详解</title>
      <link href="/2019/03/02/Android%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B1-Activity%E8%AF%A6%E8%A7%A3/"/>
      <url>/2019/03/02/Android%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B1-Activity%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Activity简介"><a href="#1-Activity简介" class="headerlink" title="1. Activity简介"></a>1. Activity简介</h1><ul><li>activity是一种可以保护用户界面的组件，用于和用户交互  </li><li>一个应用程序可以有0个或者多个活动</li><li>一个活动伴随着一个布局文件  </li></ul><h2 id="1-1-Activity的创建"><a href="#1-1-Activity的创建" class="headerlink" title="1.1.Activity的创建"></a>1.1.Activity的创建</h2><p>创建活动主要分为两步：  </p><ol><li>手动创建activity文件以及对应的布局文件,通过<code>setContentView(R.layout.XXX)</code>关联  </li><li>在AndroidMnifest中注册生效  </li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:</span> <span class="attr">name</span> = <span class="string">".FirstActivity"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">android:</span> <span class="attr">label</span> = <span class="string">"This is first Activity"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span> = <span class="string">"...MAIN"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"...LAUNCHER"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="1-2-Activity中使用Toast"><a href="#1-2-Activity中使用Toast" class="headerlink" title="1.2.Activity中使用Toast"></a>1.2.Activity中使用Toast</h2><p>Toast是Android系统提供的一种非常好的提醒方法，通过一些短小的信息通知用户相关信息,创建Toast需要三个参数。第一个参数是Toaset要求的上下文，第二个是Toast显示的文本内容，第三个参数是它显示的时长  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Toast.makeText(FirstActivity.this, &quot;You are Ok!!!&quot;, Toast.LENGTH_SHORT).show()</span><br></pre></td></tr></table></figure><h2 id="1-3-Activity中使用Menu"><a href="#1-3-Activity中使用Menu" class="headerlink" title="1.3.Activity中使用Menu"></a>1.3.Activity中使用Menu</h2><p>在Android中创建下拉菜单的几个步骤如下：  </p><ol><li>在res目录下新建menu文件夹，新建menu.xml文件  </li><li>在文件中添加如下代码来创建下拉菜单  </li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">  <span class="attr">android:id</span> = <span class="string">"@+id/add_item"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">andrid:title:</span>=<span class="string">"Add"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">  <span class="attr">android:id</span> = <span class="string">"@+id/remove_item"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">andrid:title:</span>=<span class="string">"Remove"</span>/&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>主活动中重写<code>onCreateOptionMenu()</code>方法（通过Ctrl+O）  </li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionMenu</span><span class="params">(Menu menu)</span></span>&#123;</span><br><span class="line">  <span class="comment">// 通过getMenuInfalter()方法得到MenuInfalter对象，调用inflate()方法来创建菜单  </span></span><br><span class="line">  <span class="comment">// 参数1： 指定那个资源文件来创建菜单</span></span><br><span class="line">  <span class="comment">// 参数2： 指定我们的额菜单项将添加到那个menu对象中</span></span><br><span class="line">  getMenuInflater().inflate(R.meanu.main,menu);</span><br><span class="line">  <span class="comment">// 允许创建的菜单显示出来</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>为menu绑定监听器,重写<code>onOptionsItemSelected()</code>方法  </li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onOptionsItemSelected</span><span class="params">(MenuItem item)</span></span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (item.getItemId())&#123;</span><br><span class="line">    <span class="keyword">case</span> R.id.add_item:</span><br><span class="line">      Toast.makeText(<span class="keyword">this</span>, <span class="string">"you clicked add"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> R.id.remove_item:</span><br><span class="line">      Toast.makeText(<span class="keyword">this</span>, <span class="string">"you clicked remove"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="1-4-使用Intent在活动之间穿梭"><a href="#1-4-使用Intent在活动之间穿梭" class="headerlink" title="1.4. 使用Intent在活动之间穿梭"></a>1.4. 使用Intent在活动之间穿梭</h2><p>Intent是Android程序中各组件之间进行交互的一种重要方式，它不仅可以指明当前组件想要执行的动作，还不可以在不同组件之间传递数据，Intent有两种形式<strong>显示Intent</strong>和<strong>隐示Intent</strong>,首先看显示Intent  </p><h3 id="显示Intent切换activity"><a href="#显示Intent切换activity" class="headerlink" title="显示Intent切换activity"></a>显示Intent切换activity</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Intent(Context packageContext, Class&lt;?&gt;cls)</span><br></pre></td></tr></table></figure><p>从一个Activity跳到另外一个Activity的代码是  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Intent intent = new Intent(FirstActivity.this, SecondActivtiy.class);</span><br><span class="line">startActivity(intent);</span><br></pre></td></tr></table></figure><h3 id="隐示Intent切换activity"><a href="#隐示Intent切换activity" class="headerlink" title="隐示Intent切换activity"></a>隐示Intent切换activity</h3><p>隐示Intent不明确指明需要启动哪个活动，而知指定一系列更为抽象的action和category信息，然后交给系统去分析这个intent并找到合适的活动去启动(可以响应这个隐示Intent的活动)</p><p>在secondactivity的声明文件中写  </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:</span> <span class="attr">name</span> = <span class="string">".SecondActivity"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span> = <span class="string">"...ACTION_START"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"...category.DEFAULT"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上面的代码中指明了当前活动可以响应<code>com.example.activitytest.ACTION_START</code>这个action，而<cateory>标签包含了一些附加信息，更加明确的指明了当前的活动能够响应的Intent中还可能带有的catogory，<strong>只有<action>和<category>中的内容同事匹配上Intent中指定的action和category时，才能够响应这个活动</category></action></strong>  </cateory></p><p>修改FirstActiivty的代码为如下：  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Intent intent = <span class="keyword">new</span> Intent(<span class="string">"com.example.activitytest.ACTION_START"</span>);</span><br><span class="line">intent.addCategory(<span class="string">"com.example.activitytest.DEFAULT"</span>)</span><br><span class="line">startActivity(intent)</span><br></pre></td></tr></table></figure><p>这个方法一样可以切换activity</p><h2 id="1-5-通过Intent向下一个活动传递数据"><a href="#1-5-通过Intent向下一个活动传递数据" class="headerlink" title="1.5. 通过Intent向下一个活动传递数据"></a>1.5. 通过Intent向下一个活动传递数据</h2><p><strong>传数据</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span></span>&#123;</span><br><span class="line">  String data = <span class="string">"hello from FirstActivity"</span>;</span><br><span class="line">  Intent intent = <span class="keyword">new</span> Intent(FirstActivity.<span class="keyword">this</span>, SecondActivity.class);</span><br><span class="line">  intent.putExtra(<span class="string">"extra_data"</span>, data);</span><br><span class="line">  startActivity(intent);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>取数据</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Intent intent = getIntent();</span><br><span class="line">String data = intent.getStringExtra(<span class="string">"extra_data"</span>);</span><br><span class="line">Log.d(<span class="string">"SecondActivity"</span>,data);</span><br></pre></td></tr></table></figure><h2 id="1-6-返回数据给上一个活动"><a href="#1-6-返回数据给上一个活动" class="headerlink" title="1.6. 返回数据给上一个活动"></a>1.6. 返回数据给上一个活动</h2><ul><li>通过调用<code>startActivtiyForResult()</code>方法也是用于启动活动，但是这个方法期望在活动销毁的时候能够返回一个结果给上一个活动。</li><li>接收两个参数，第一个参数是Intent，第二个参数是请求吗，用于在之后的回调中判断数据的来源</li></ul><p><strong>传入数据</strong>  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span></span>&#123;</span><br><span class="line">  String data = <span class="string">"hello from FirstActivity"</span>;</span><br><span class="line">  Intent intent = <span class="keyword">new</span> Intent(FirstActivity.<span class="keyword">this</span>, SecondActivity.class);</span><br><span class="line">  startActivtiyForResult(intent, <span class="number">1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>然后在第二个activity中添加返回数据的逻辑</strong>  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">intent.putExtra(<span class="string">"data_return"</span>, <span class="string">"hello first activity"</span>);</span><br><span class="line">setResult(RESULT_OK,intent);</span><br><span class="line">finish();  <span class="comment">// 销毁的时候回回调上一个活动的onActivityResult()方法，因此我们需要重写那个方法来获得数据</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在firstActivity的onActivityResult()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> (requestCode)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> (resultCode == RESULT_OK)&#123;</span><br><span class="line">          String returnedData = data.getStringExtra(<span class="string">"data_return"</span>);</span><br><span class="line">          Log.d(<span class="string">"FirstActviity"</span>, returnedData);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="2-活动的生命周期"><a href="#2-活动的生命周期" class="headerlink" title="2. 活动的生命周期"></a>2. 活动的生命周期</h1><p><img src="https://developer.android.com/guide/components/images/activity_lifecycle.png" alt></p><h2 id="2-1-活动的状态"><a href="#2-1-活动的状态" class="headerlink" title="2.1. 活动的状态"></a>2.1. 活动的状态</h2><ul><li>运行状态： 当活动处在返回栈的栈顶时  </li><li>暂停状态： 当活动不再栈顶时，但仍然可见(屏幕对话框模式)</li><li>停止状态： 当活动不在栈顶，且完全不可见  </li><li>销毁状态： 被内存回收</li></ul><h2 id="2-1-活动的生存周期"><a href="#2-1-活动的生存周期" class="headerlink" title="2.1. 活动的生存周期"></a>2.1. 活动的生存周期</h2><table><thead><tr><th>周期</th><th>状态</th><th>说明</th><th>建议操作</th></tr></thead><tbody><tr><td>onCreate()</td><td>Created</td><td>第一次创建时调用，且只执行一次</td><td>活动的初始化操作，加载布局，绑定事件</td></tr><tr><td>onStart()</td><td>Started</td><td>活动由不可见变为可见，完成得很快</td><td>app和用户交互，初始化组件</td></tr><tr><td>onResume()</td><td>运行状态</td><td>准备和用户交互时调用</td><td>当有异常时，进入暂停状态</td></tr><tr><td>onPause()</td><td>暂停状态</td><td>系统准备去启动或者恢复一个活动时调用</td><td>停止一些不想运行的操作(关闭camera),释放系统资源</td></tr><tr><td>onStop()</td><td>停止状态</td><td>活动完全不可见时调用</td><td>释放heavy任务，关闭CPU中的任务，保存到数据库</td></tr><tr><td>onDestroy()</td><td>销毁状态</td><td>活动销毁前调用</td><td></td></tr><tr><td>onRestart()</td><td></td><td>由停止状态变为运行状态</td></tr></tbody></table><h2 id="2-2-保存活动的运行状态"><a href="#2-2-保存活动的运行状态" class="headerlink" title="2.2. 保存活动的运行状态"></a>2.2. 保存活动的运行状态</h2><ul><li>通过<code>onSaveInstanceState()</code>方法保证在活动被回收之前一定会被调用，通过这个方法来解决活动被回收时临时数据得不到保存的问题  </li><li>此方法会携带一个Bundle类型的参数，这个参数提供了一系列犯法来保存数据，<code>putString(key,value),putInt(key,value)</code></li></ul><p><strong>保存数据</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onSaveInstanceState</span><span class="params">(Bundle outState)</span></span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onSaveInstanceState(outState);</span><br><span class="line">    String tempData = <span class="string">"Something you just typed"</span>;</span><br><span class="line">    outState.putString(<span class="string">"data_key"</span>, tempData)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>恢复数据</strong> ：在OnCreate()方法中取值就可以了  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span></span>&#123;</span><br><span class="line">  ....;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (savedInstanceState !=<span class="keyword">null</span>)&#123;</span><br><span class="line">    String tempData = savedInstanceState.getString(<span class="string">"data_key"</span>);</span><br><span class="line">    Log.d(TAG, tempData);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="3-关于Activity的一些其他技巧"><a href="#3-关于Activity的一些其他技巧" class="headerlink" title="3. 关于Activity的一些其他技巧"></a>3. 关于Activity的一些其他技巧</h1><h2 id="3-1-如何在任意activity中直接退出？"><a href="#3-1-如何在任意activity中直接退出？" class="headerlink" title="3.1. 如何在任意activity中直接退出？"></a>3.1. 如何在任意activity中直接退出？</h2><p>如果目前你手机界面还在第三个activity中，你会发现当前退出程序很麻烦，需连续按3此Back键才行，按Home键至少把程序挂起，并没有退出程序  </p><ul><li>设置一个专门的集合类对所有的活动管理就行了  </li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActivityyCollector</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Activity&gt; activities = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addActivity</span><span class="params">(Activity activity)</span></span>&#123;</span><br><span class="line">        activities.add(activity);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">removeActivity</span><span class="params">(Activity activity)</span></span>&#123;</span><br><span class="line">      activities.remove(activity);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">finishALL</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="keyword">for</span> (Activity activity : activities)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!activity.isFinishing())&#123;</span><br><span class="line">          activity.finish();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后在活动中可用直接通过这个类来动态管理活动  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span></span>&#123;</span><br><span class="line">      <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">      Log.d(<span class="string">"BaseActivity"</span>,getClass().getSimpleName());</span><br><span class="line">      ActivityyCollector.addActivity(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="keyword">super</span>.onDestroy();</span><br><span class="line">      ActivityyCollector.removeActivity(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Android Development </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2019/03/01/hello-world/"/>
      <url>/2019/03/01/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
